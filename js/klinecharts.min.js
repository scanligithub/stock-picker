/**
     * @license
     * KLineChart v10.0.0-alpha5
     * Copyright (c) 2019 lihu.
     * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
     */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).klinecharts={})}(this,(function(t){"use strict";var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},e(t,i)};function i(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var n,r,o,a,s,l,u,c,h,d,p=function(){return p=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},p.apply(this,arguments)};function g(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i}function v(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))}function f(t,e){var i,n,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function y(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return a}function _(t,e,i){if(i||2===arguments.length)for(var n,r=0,o=e.length;r<o;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))}function x(t,e){if(w(t)||w(e))for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=t[i],r=e[i];w(r)&&w(n)?x(n,r):E(e[i])&&(t[i]=b(e[i]))}}function b(t){if(!w(t))return t;var e=null;for(var i in e=C(t)?[]:{},t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];w(n)?e[i]=b(n):e[i]=n}return e}function C(t){return"[object Array]"===Object.prototype.toString.call(t)}function T(t){return"function"==typeof t}function w(t){return"object"==typeof t&&E(t)}function S(t){return"number"==typeof t&&Number.isFinite(t)}function E(t){return null!=t}function P(t){return"boolean"==typeof t}function I(t){return"string"==typeof t}function M(t){return"transparent"===t||"none"===t||/^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(t)||/^[hH][Ss][Ll][Aa]\(([\s]*(360｜3[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(t)}function k(t,e){var i=t.replace(/^#/,""),n=parseInt(i,16),r=n>>8&255,o=255&n;return"rgba(".concat(n>>16&255,", ").concat(r,", ").concat(o,", ").concat(null!=e?e:1,")")}"function"==typeof SuppressedError&&SuppressedError,t.LineType=void 0,(n=t.LineType||(t.LineType={})).Dashed="dashed",n.Solid="solid",function(t){t.Stroke="stroke",t.Fill="fill"}(r||(r={})),t.PolygonType=void 0,(o=t.PolygonType||(t.PolygonType={})).Stroke="stroke",o.Fill="fill",o.StrokeFill="stroke_fill",t.TooltipShowRule=void 0,(a=t.TooltipShowRule||(t.TooltipShowRule={})).Always="always",a.FollowCross="follow_cross",a.None="none",t.TooltipShowType=void 0,(s=t.TooltipShowType||(t.TooltipShowType={})).Standard="standard",s.Rect="rect",t.TooltipFeatureType=void 0,(l=t.TooltipFeatureType||(t.TooltipFeatureType={})).Path="path",l.IconFont="icon_font",t.TooltipFeaturePosition=void 0,(u=t.TooltipFeaturePosition||(t.TooltipFeaturePosition={})).Left="left",u.Middle="middle",u.Right="right",t.CandleTooltipRectPosition=void 0,(c=t.CandleTooltipRectPosition||(t.CandleTooltipRectPosition={})).Fixed="fixed",c.Pointer="pointer",t.CandleType=void 0,(h=t.CandleType||(t.CandleType={})).CandleSolid="candle_solid",h.CandleStroke="candle_stroke",h.CandleUpStroke="candle_up_stroke",h.CandleDownStroke="candle_down_stroke",h.Ohlc="ohlc",h.Area="area",function(t){t.CurrentOpen="current_open",t.PreviousClose="previous_close"}(d||(d={}));var D={RED:"#F92855",GREEN:"#2DC08E",WHITE:"#FFFFFF",GREY:"#76808F",BLUE:"#1677FF"};function A(){return{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:D.GREY,size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:6},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}}}function F(){function e(){return{show:!0,line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,2],size:1,color:D.GREY},text:{show:!0,style:t.PolygonType.Fill,color:D.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:D.GREY,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:D.GREY}}}return{show:!0,horizontal:e(),vertical:e()}}var R=/\\(\\)?/g,B=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g");function L(t,e,i){if(E(t)){var n=[];e.replace(B,(function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var r=t;return E(e[1])?r=e[2].replace(R,"$1"):E(e[0])&&(r=e[0].trim()),n.push(r),""}));for(var r=t,o=0,a=n.length;E(r)&&o<a;)r=null==r?void 0:r[n[o++]];return E(r)?r:null!=i?i:"--"}return null!=i?i:"--"}function O(t,e){var i={};return t.formatToParts(new Date(e)).forEach((function(t){var e=t.type,n=t.value;switch(e){case"year":i.YYYY=n;break;case"month":i.MM=n;break;case"day":i.DD=n;break;case"hour":i.HH="24"===n?"00":n;break;case"minute":i.mm=n;break;case"second":i.ss=n}})),i}function W(t,e,i){var n=O(t,e);return i.replace(/YYYY|MM|DD|HH|mm|ss/g,(function(t){return n[t]}))}function V(t,e){var i=+t;return S(i)?i.toFixed(null!=e?e:2):"".concat(t)}function N(t){var e=+t;if(S(e)){if(e>1e9)return"".concat(+(e/1e9).toFixed(3),"B");if(e>1e6)return"".concat(+(e/1e6).toFixed(3),"M");if(e>1e3)return"".concat(+(e/1e3).toFixed(3),"K")}return"".concat(t)}function z(t,e){var i="".concat(t);if(0===e.length)return i;if(i.includes(".")){var n=i.split(".");return"".concat(n[0].replace(/(\d)(?=(\d{3})+$)/g,(function(t){return"".concat(t).concat(e)})),".").concat(n[1])}return i.replace(/(\d)(?=(\d{3})+$)/g,(function(t){return"".concat(t).concat(e)}))}function Y(t,e){var i="".concat(t);if(new RegExp("\\.0{"+e+",}[1-9][0-9]*$").test(i)){var n=i.split("."),r=n.length-1,o=n[r],a=/0*/.exec(o);if(E(a)){var s=a[0].length;return n[r]=o.replace(/0*/,"0{".concat(s,"}")),n.join(".")}}return i}var H,X=null;function G(t){var e,i;return null!==(i=null===(e=t.ownerDocument.defaultView)||void 0===e?void 0:e.devicePixelRatio)&&void 0!==i?i:1}function U(t,e,i){return"".concat(null!=e?e:"normal"," ").concat(null!=t?t:12,"px ").concat(null!=i?i:"Helvetica Neue")}function Z(t,e,i,n){if(!E(X)){var r=document.createElement("canvas"),o=G(r);(X=r.getContext("2d")).scale(o,o)}return X.font=U(e,i,n),Math.round(X.measureText(t).width)}t.ActionType=void 0,(H=t.ActionType||(t.ActionType={})).OnZoom="onZoom",H.OnScroll="onScroll",H.OnVisibleRangeChange="onVisibleRangeChange",H.OnCandleTooltipFeatureClick="onCandleTooltipFeatureClick",H.OnCrosshairChange="onCrosshairChange",H.OnCandleBarClick="onCandleBarClick",H.OnPaneDrag="onPaneDrag";var q,j,Q,K=function(){function t(){this._callbacks=[]}return t.prototype.subscribe=function(t){this._callbacks.indexOf(t)<0&&this._callbacks.push(t)},t.prototype.unsubscribe=function(t){if(T(t)){var e=this._callbacks.indexOf(t);e>-1&&this._callbacks.splice(e,1)}else this._callbacks=[]},t.prototype.execute=function(t){this._callbacks.forEach((function(e){e(t)}))},t.prototype.isEmpty=function(){return 0===this._callbacks.length},t}();function J(t,e,i,n){var r,o=t.result,a=t.figures,s=t.styles,l=L(s,"circles",i.circles),u=l.length,c=L(s,"bars",i.bars),h=c.length,d=L(s,"lines",i.lines),g=d.length,v=0,f=0,y=0,m=0;a.forEach((function(a){var s;switch(a.type){case"circle":m=v;var _=l[v%u];r=p(p({},_),{color:_.noChangeColor}),v++;break;case"bar":m=f;var x=c[f%h];r=p(p({},x),{color:x.noChangeColor}),f++;break;case"line":m=y,r=d[y%g],y++}if(E(a.type)){var b=null===(s=a.styles)||void 0===s?void 0:s.call(a,{data:{prev:o[e-1],current:o[e],next:o[e+1]},indicator:t,defaultStyles:i});n(a,p(p({},r),b),m)}}))}t.IndicatorSeries=void 0,(q=t.IndicatorSeries||(t.IndicatorSeries={})).Normal="normal",q.Price="price",q.Volume="volume",function(t){t.Feature="feature"}(j||(j={})),function(t){t.Loading="loading",t.Error="error",t.Ready="ready"}(Q||(Q={}));var $,tt=function(){function e(e){this.precision=4,this.calcParams=[],this.shouldOhlc=!1,this.shouldFormatBigNumber=!1,this.visible=!0,this.zLevel=0,this.series=t.IndicatorSeries.Normal,this.figures=[],this.minValue=null,this.maxValue=null,this.styles=null,this.shouldUpdate=function(t,e){var i=JSON.stringify(t.calcParams)!==JSON.stringify(e.calcParams)||t.figures!==e.figures||t.calc!==e.calc;return{calc:i,draw:i||t.shortName!==e.shortName||t.series!==e.series||t.minValue!==e.minValue||t.maxValue!==e.maxValue||t.precision!==e.precision||t.shouldOhlc!==e.shouldOhlc||t.shouldFormatBigNumber!==e.shouldFormatBigNumber||t.visible!==e.visible||t.zLevel!==e.zLevel||t.extendData!==e.extendData||t.regenerateFigures!==e.regenerateFigures||t.createTooltipDataSource!==e.createTooltipDataSource||t.draw!==e.draw}},this.calc=function(){return[]},this.regenerateFigures=null,this.createTooltipDataSource=null,this.draw=null,this.onClick=null,this.onDataStateChange=null,this.result=[],this._lockSeriesPrecision=!1,this.override(e),this._lockSeriesPrecision=!1}return e.prototype.override=function(t){var e,i,n=this.result,r=g(this,["result"]);this._prevIndicator=p(p({},b(r)),{result:n});var o=t.id,a=t.name,s=t.shortName,l=t.precision,u=t.styles,c=t.figures,h=t.calcParams,d=g(t,["id","name","shortName","precision","styles","figures","calcParams"]);!I(this.id)&&I(o)&&(this.id=o),I(this.name)||(this.name=null!=a?a:""),this.shortName=null!==(e=null!=s?s:this.shortName)&&void 0!==e?e:this.name,S(l)&&(this.precision=l,this._lockSeriesPrecision=!0),E(u)&&(null!==(i=this.styles)&&void 0!==i||(this.styles={}),x(this.styles,u)),x(this,d),E(h)&&(this.calcParams=h,T(this.regenerateFigures)&&(this.figures=this.regenerateFigures(this.calcParams))),this.figures=null!=c?c:this.figures},e.prototype.setSeriesPrecision=function(t){this._lockSeriesPrecision||(this.precision=t)},e.prototype.shouldUpdateImp=function(){var t=this._prevIndicator.zLevel!==this.zLevel,e=this.shouldUpdate(this._prevIndicator,this);return P(e)?{calc:e,draw:e,sort:t}:p(p({},e),{sort:t})},e.prototype.calcImp=function(t){return v(this,void 0,void 0,(function(){var e;return f(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=i.sent(),this.result=e,[2,!0];case 2:return i.sent(),[2,!1];case 3:return[2]}}))}))},e.extend=function(t){return function(e){function n(){return e.call(this,t)||this}return i(n,e),n}(e)},e}();function et(t,e){var i,n=null!==(i=null==e?void 0:e.ignoreEvent)&&void 0!==i&&i;return P(n)?!n:!n.includes(t)}t.OverlayMode=void 0,($=t.OverlayMode||(t.OverlayMode={})).Normal="normal",$.WeakMagnet="weak_magnet",$.StrongMagnet="strong_magnet";var it,nt="overlay_figure_",rt=function(){function e(e){this.groupId="",this.totalStep=1,this.currentStep=1,this.lock=!1,this.visible=!0,this.zLevel=0,this.needDefaultPointFigure=!1,this.needDefaultXAxisFigure=!1,this.needDefaultYAxisFigure=!1,this.mode=t.OverlayMode.Normal,this.modeSensitivity=8,this.points=[],this.styles=null,this.createPointFigures=null,this.createXAxisFigures=null,this.createYAxisFigures=null,this.performEventPressedMove=null,this.performEventMoveForDrawing=null,this.onDrawStart=null,this.onDrawing=null,this.onDrawEnd=null,this.onClick=null,this.onDoubleClick=null,this.onRightClick=null,this.onPressedMoveStart=null,this.onPressedMoving=null,this.onPressedMoveEnd=null,this.onMouseEnter=null,this.onMouseLeave=null,this.onRemoved=null,this.onSelected=null,this.onDeselected=null,this._prevZLevel=0,this._prevPressedPoint=null,this._prevPressedPoints=[],this.override(e)}return e.prototype.override=function(t){var e,i;this._prevOverlay=b(this);var n=t.id,r=t.name;t.currentStep;var o=t.points,a=t.styles;if(x(this,g(t,["id","name","currentStep","points","styles"])),I(this.name)||(this.name=null!=r?r:""),!I(this.id)&&I(n)&&(this.id=n),E(a)&&(null!==(e=this.styles)&&void 0!==e||(this.styles={}),x(this.styles,a)),C(o)&&o.length>0){var s=0;if(this.points=_([],m(o),!1),o.length>=this.totalStep-1?(this.currentStep=-1,s=this.totalStep-1):(this.currentStep=o.length+1,s=o.length),T(this.performEventMoveForDrawing))for(var l=0;l<s;l++)this.performEventMoveForDrawing({currentStep:l+2,mode:this.mode,points:this.points,performPointIndex:l,performPoint:this.points[l]});-1===this.currentStep&&(null===(i=this.performEventPressedMove)||void 0===i||i.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}))}},e.prototype.getPrevZLevel=function(){return this._prevZLevel},e.prototype.setPrevZLevel=function(t){this._prevZLevel=t},e.prototype.shouldUpdate=function(){var t=this._prevOverlay.zLevel!==this.zLevel;return{sort:t,draw:t||JSON.stringify(this._prevOverlay)!==JSON.stringify(this.points)||this._prevOverlay.visible!==this.visible||this._prevOverlay.extendData!==this.extendData||this._prevOverlay.styles!==this.styles}},e.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=-1:this.currentStep++},e.prototype.forceComplete=function(){this.currentStep=-1},e.prototype.isDrawing=function(){return-1!==this.currentStep},e.prototype.isStart=function(){return 1===this.currentStep},e.prototype.eventMoveForDrawing=function(t){var e,i=this.currentStep-1,n={};S(t.timestamp)&&(n.timestamp=t.timestamp),S(t.dataIndex)&&(n.dataIndex=t.dataIndex),S(t.value)&&(n.value=t.value),this.points[i]=n,null===(e=this.performEventMoveForDrawing)||void 0===e||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:i,performPoint:n})},e.prototype.eventPressedPointMove=function(t,e){var i;this.points[e].timestamp=t.timestamp,S(t.value)&&(this.points[e].value=t.value),null===(i=this.performEventPressedMove)||void 0===i||i.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},e.prototype.startPressedMove=function(t){this._prevPressedPoint=p({},t),this._prevPressedPoints=b(this.points)},e.prototype.eventPressedOtherMove=function(t,e){if(null!==this._prevPressedPoint){var i=null;S(t.dataIndex)&&S(this._prevPressedPoint.dataIndex)&&(i=t.dataIndex-this._prevPressedPoint.dataIndex);var n=null;S(t.value)&&S(this._prevPressedPoint.value)&&(n=t.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map((function(t){var r;S(t.timestamp)&&(t.dataIndex=e.timestampToDataIndex(t.timestamp));var o=p({},t);return S(i)&&S(t.dataIndex)&&(o.dataIndex=t.dataIndex+i,o.timestamp=null!==(r=e.dataIndexToTimestamp(o.dataIndex))&&void 0!==r?r:void 0),S(n)&&S(t.value)&&(o.value=t.value+n),o}))}},e.extend=function(t){return function(e){function n(){return e.call(this,t)||this}return i(n,e),n}(e)},e}();function ot(t){var e={width:0,height:0,left:0,right:0,top:0,bottom:0};return E(t)&&x(e,t),e}t.FormatDateType=void 0,(it=t.FormatDateType||(t.FormatDateType={}))[it.Tooltip=0]="Tooltip",it[it.Crosshair=1]="Crosshair",it[it.XAxis=2]="XAxis";var at=-1;function st(t){return T(window.requestAnimationFrame)?window.requestAnimationFrame(t):window.setTimeout(t,20)}function lt(t){T(window.cancelAnimationFrame)?window.cancelAnimationFrame(t):window.clearTimeout(t)}function ut(t){if(T(window.requestIdleCallback))return window.requestIdleCallback(t);var e=performance.now();return window.setTimeout((function(){t({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(performance.now()-e))}})}),1)}var ct,ht=function(){function t(t){this._options={duration:500,iterationCount:1},this._currentIterationCount=0,this._running=!1,this._time=0,x(this._options,t)}return t.prototype._loop=function(){var t=this;this._running=!0;var e=function(){var i;if(t._running){var n=(new Date).getTime()-t._time;n<t._options.duration?(null===(i=t._doFrameCallback)||void 0===i||i.call(t,n),st(e)):(t.stop(),t._currentIterationCount++,t._currentIterationCount<t._options.iterationCount&&t.start())}};st(e)},t.prototype.doFrame=function(t){return this._doFrameCallback=t,this},t.prototype.setDuration=function(t){return this._options.duration=t,this},t.prototype.setIterationCount=function(t){return this._options.iterationCount=t,this},t.prototype.start=function(){this._running||(this._time=(new Date).getTime(),this._loop())},t.prototype.stop=function(){var t;this._running&&(null===(t=this._doFrameCallback)||void 0===t||t.call(this,this._options.duration)),this._running=!1},t}(),dt=1,pt=(new Date).getTime();function gt(t){var e=(new Date).getTime();return e===pt?++dt:dt=1,pt=e,"".concat(null!=t?t:"").concat(e,"_").concat(dt)}function vt(t,e){var i,n=document.createElement(t),r=null!=e?e:{};for(var o in r)n.style[o]=null!==(i=r[o])&&void 0!==i?i:"";return n}function ft(t,e,i){var n=0,r=0;for(r=t.length-1;n!==r;){var o=Math.floor((r+n)/2),a=r-n,s=t[o][e];if(i===t[n][e])return n;if(i===t[r][e])return r;if(i===s)return o;if(i>s?n=o:r=o,a<=2)break}return n}function yt(t,e){e=Math.max(0,null!=e?e:0);var i=Math.pow(10,e);return Math.round(t*i)/i}function mt(t,e,i){for(var n,r,o=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],a=t.length,s=0;s<a;){var l=t[s];o[0]=Math.max(null!==(n=l[e])&&void 0!==n?n:Number.MIN_SAFE_INTEGER,o[0]),o[1]=Math.min(null!==(r=l[i])&&void 0!==r?r:Number.MAX_SAFE_INTEGER,o[1]),++s}return o}function _t(t){return 0===t?0:Math.log10(t)}function xt(t){return Math.pow(10,t)}function bt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.join("_")}!function(t){t.Init="init",t.Forward="forward",t.Backward="backward",t.Update="update"}(ct||(ct={}));var Ct=function(){function t(t){this._requestIdleCallbackId=at,this._tasks=null!=t?t:[],this._operateTasks()}return t.prototype._operateTasks=function(t){var e,i=this;this._requestIdleCallbackId!==at&&(e=this._requestIdleCallbackId,T(window.cancelIdleCallback)?window.cancelIdleCallback(e):window.clearTimeout(e),this._requestIdleCallbackId=at),null==t||t(),this._requestIdleCallbackId=ut((function(t){i._runTasks(t)}))},t.prototype._runTasks=function(t){for(var e=this;t.timeRemaining()>0&&this._tasks.length>0;){var i=this._tasks.shift();null==i||i.handler()}this._tasks.length>0&&(this._requestIdleCallbackId=ut((function(t){e._runTasks(t)})))},t.prototype.addTask=function(t){var e=this;return this._operateTasks((function(){var i=e._tasks.findIndex((function(e){return e.id===t.id}));i>-1?e._tasks[i]=t:e._tasks.push(t)})),this},t.prototype.removeTask=function(t){var e=this;return this._operateTasks((function(){var i=e._tasks.findIndex((function(e){return e.id===t}));i>-1&&e._tasks.splice(i,1)})),this},t}(),Tt=31536e3,wt=2592e3,St=86400,Et=3600,Pt=60,It=1;function Mt(t,e,i,n,r,o){var a;void 0===n&&(n=0);for(var s=null,l=null!=o?o:null,u=0;u<e.length;u++){var c=e[u].timestamp,h=Pt,d=O(i,c);E(s)&&(h=d.YYYY!==s.YYYY?Tt:d.MM!==s.MM?wt:d.DD!==s.DD?St:d.HH!==s.HH?Et:d.mm!==s.mm?Pt:It),S(l)&&S(null==r?void 0:r.compare)&&(r.compare=Math.min(r.compare,c-l));var p=null!==(a=t.get(h))&&void 0!==a?a:[];p.push({dataIndex:u+n,weight:h,timestamp:c}),t.set(h,p),s=d,l=c}}function kt(t,e){var i=Math.max(Z("0000-00-00 00:00:00",e.size,e.weight,e.family),146);return Math.ceil(i/t)}function Dt(t,e,i){var n=kt(e,i),r=[];return Array.from(t.keys()).sort((function(t,e){return e-t})).forEach((function(e){var i=t.get(e),o=r;r=[];for(var a=o.length,s=0,l=i.length,u=1/0,c=-1/0,h=0;h<l;h++){for(var d=i[h],p=d.dataIndex;s<a;){var g=o[s],v=g.dataIndex;if(!(v<p)){u=v;break}s++,r.push(g),c=v,u=1/0}u-p>=n&&p-c>=n&&(r.push(d),c=p)}for(;s<a;s++)r.push(o[s])})),r}var At={name:"AVP",shortName:"AVP",series:t.IndicatorSeries.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(t){var e=0,i=0;return t.map((function(t){var n,r,o={},a=null!==(n=t.turnover)&&void 0!==n?n:0,s=null!==(r=t.volume)&&void 0!==r?r:0;return e+=a,0!==(i+=s)&&(o.avp=e/i),o}))}},Ft={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(e){var i,n,r=e.data,o=e.indicator,a=e.defaultStyles,s=r.prev,l=r.current,u=null!==(i=null==s?void 0:s.ao)&&void 0!==i?i:Number.MIN_SAFE_INTEGER,c=null!==(n=null==l?void 0:l.ao)&&void 0!==n?n:Number.MIN_SAFE_INTEGER,h="";return{color:h=c>u?L(o.styles,"bars[0].upColor",a.bars[0].upColor):L(o.styles,"bars[0].downColor",a.bars[0].downColor),style:c>u?t.PolygonType.Stroke:t.PolygonType.Fill,borderColor:h}}}],calc:function(t,e){var i=e.calcParams,n=Math.max(i[0],i[1]),r=0,o=0,a=0,s=0;return t.map((function(e,l){var u={},c=(e.low+e.high)/2;if(r+=c,o+=c,l>=i[0]-1){a=r/i[0];var h=t[l-(i[0]-1)];r-=(h.low+h.high)/2}if(l>=i[1]-1){s=o/i[1];h=t[l-(i[1]-1)];o-=(h.low+h.high)/2}return l>=n-1&&(u.ao=a-s),u}))}};var Rt={name:"BOLL",shortName:"BOLL",series:t.IndicatorSeries.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=i[0]-1,r=0;return t.map((function(e,o){var a=e.close,s={};if(r+=a,o>=n){s.mid=r/i[0];var l=function(t,e){var i=t.length,n=0;return t.forEach((function(t){var i=t.close-e;n+=i*i})),n=Math.abs(n),Math.sqrt(n/i)}(t.slice(o-n,o+1),s.mid);s.up=s.mid+i[1]*l,s.dn=s.mid-i[1]*l,r-=t[o-n].close}return s}))}},Bt={name:"BBI",shortName:"BBI",series:t.IndicatorSeries.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.max.apply(Math,_([],m(i),!1)),r=[],o=[];return t.map((function(e,a){var s={},l=e.close;if(i.forEach((function(e,i){var n;r[i]=(null!==(n=r[i])&&void 0!==n?n:0)+l,a>=e-1&&(o[i]=r[i]/e,r[i]-=t[a-(e-1)].close)})),a>=n-1){var u=0;o.forEach((function(t){u+=t})),s.bbi=u/4}return s}))}},Lt={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=i[0]-1,r=0,o=[];return t.map((function(e,a){var s={},l=(e.high+e.low+e.close)/3;if(r+=l,o.push(l),a>=n){var u=r/i[0],c=o.slice(a-n,a+1),h=0;c.forEach((function(t){h+=Math.abs(t-u)}));var d=h/i[0];s.cci=0!==d?(l-u)/d/.015:0;var p=(t[a-n].high+t[a-n].low+t[a-n].close)/3;r-=p}return s}))}},Ot={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.ceil(i[1]/2.5+1),r=Math.ceil(i[2]/2.5+1),o=Math.ceil(i[3]/2.5+1),a=Math.ceil(i[4]/2.5+1),s=0,l=[],u=0,c=[],h=0,d=[],p=0,g=[],v=[];return t.forEach((function(e,f){var y,m,_,x,b,C={},T=null!==(y=t[f-1])&&void 0!==y?y:e,w=(T.high+T.close+T.low+T.open)/4,S=Math.max(0,e.high-w),E=Math.max(0,w-e.low);f>=i[0]-1&&(C.cr=0!==E?S/E*100:0,s+=C.cr,u+=C.cr,h+=C.cr,p+=C.cr,f>=i[0]+i[1]-2&&(l.push(s/i[1]),f>=i[0]+i[1]+n-3&&(C.ma1=l[l.length-1-n]),s-=null!==(m=v[f-(i[1]-1)].cr)&&void 0!==m?m:0),f>=i[0]+i[2]-2&&(c.push(u/i[2]),f>=i[0]+i[2]+r-3&&(C.ma2=c[c.length-1-r]),u-=null!==(_=v[f-(i[2]-1)].cr)&&void 0!==_?_:0),f>=i[0]+i[3]-2&&(d.push(h/i[3]),f>=i[0]+i[3]+o-3&&(C.ma3=d[d.length-1-o]),h-=null!==(x=v[f-(i[3]-1)].cr)&&void 0!==x?x:0),f>=i[0]+i[4]-2&&(g.push(p/i[4]),f>=i[0]+i[4]+a-3&&(C.ma4=g[g.length-1-a]),p-=null!==(b=v[f-(i[4]-1)].cr)&&void 0!==b?b:0)),v.push(C)})),v}},Wt={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.max(i[0],i[1]),r=0,o=0,a=0,s=[];return t.forEach((function(e,l){var u,c={},h=e.close;r+=h,o+=h;var d=0,p=0;if(l>=i[0]-1&&(d=r/i[0],r-=t[l-(i[0]-1)].close),l>=i[1]-1&&(p=o/i[1],o-=t[l-(i[1]-1)].close),l>=n-1){var g=d-p;c.dma=g,a+=g,l>=n+i[2]-2&&(c.ama=a/i[2],a-=null!==(u=s[l-(i[2]-1)].dma)&&void 0!==u?u:0)}s.push(c)})),s}},Vt={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,r=0,o=0,a=0,s=0,l=0,u=0,c=0,h=[];return t.forEach((function(e,d){var p,g,v={},f=null!==(p=t[d-1])&&void 0!==p?p:e,y=f.close,m=e.high,_=e.low,x=m-_,b=Math.abs(m-y),C=Math.abs(y-_),T=m-f.high,w=f.low-_,S=Math.max(Math.max(x,b),C),E=T>0&&T>w?T:0,P=w>0&&w>T?w:0;if(n+=S,r+=E,o+=P,d>=i[0]-1){d>i[0]-1?(a=a-a/i[0]+S,s=s-s/i[0]+E,l=l-l/i[0]+P):(a=n,s=r,l=o);var I=0,M=0;0!==a&&(I=100*s/a,M=100*l/a),v.pdi=I,v.mdi=M;var k=0;M+I!==0&&(k=Math.abs(M-I)/(M+I)*100),u+=k,d>=2*i[0]-2&&(c=d>2*i[0]-2?(c*(i[0]-1)+k)/i[0]:u/i[0],v.adx=c,d>=2*i[0]+i[1]-3&&(v.adxr=((null!==(g=h[d-(i[1]-1)].adx)&&void 0!==g?g:0)+c)/2))}h.push(v)})),h}},Nt={name:"EMA",shortName:"EMA",series:t.IndicatorSeries.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,r=0,o=[];return t.map((function(t,e){var a={},s=t.close;return r+=s,i.forEach((function(t,i){e>=t-1&&(o[i]=e>t-1?(2*s+(t-1)*o[i])/(t+1):r/t,a[n[i].key]=o[i])})),a}))}},zt={name:"MA",shortName:"MA",series:t.IndicatorSeries.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA30: ",type:"line"},{key:"ma4",title:"MA60: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,r=[];return t.map((function(e,o){var a={},s=e.close;return i.forEach((function(e,i){var l;r[i]=(null!==(l=r[i])&&void 0!==l?l:0)+s,o>=e-1&&(a[n[i].key]=r[i]/e,r[i]-=t[o-(e-1)].close)})),a}))}},Yt={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(e){var i,n,r=e.data,o=e.indicator,a=e.defaultStyles,s=r.prev,l=r.current,u=null!==(i=null==s?void 0:s.macd)&&void 0!==i?i:Number.MIN_SAFE_INTEGER,c=null!==(n=null==l?void 0:l.macd)&&void 0!==n?n:Number.MIN_SAFE_INTEGER,h="";return h=c>0?L(o.styles,"bars[0].upColor",a.bars[0].upColor):c<0?L(o.styles,"bars[0].downColor",a.bars[0].downColor):L(o.styles,"bars[0].noChangeColor",a.bars[0].noChangeColor),{style:u<c?t.PolygonType.Stroke:t.PolygonType.Fill,color:h,borderColor:h}}}],calc:function(t,e){var i=e.calcParams,n=0,r=0,o=0,a=0,s=0,l=0,u=Math.max(i[0],i[1]);return t.map((function(t,e){var c={},h=t.close;return n+=h,e>=i[0]-1&&(r=e>i[0]-1?(2*h+(i[0]-1)*r)/(i[0]+1):n/i[0]),e>=i[1]-1&&(o=e>i[1]-1?(2*h+(i[1]-1)*o)/(i[1]+1):n/i[1]),e>=u-1&&(a=r-o,c.dif=a,s+=a,e>=u+i[2]-2&&(l=e>u+i[2]-2?(2*a+l*(i[2]-1))/(i[2]+1):s/i[2],c.macd=2*(a-l),c.dea=l)),c}))}},Ht={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){var i=e+1;return{key:"rsi".concat(i),title:"RSI".concat(i,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,r=[],o=[];return t.map((function(e,a){var s,l={},u=(null!==(s=t[a-1])&&void 0!==s?s:e).close,c=e.close-u;return i.forEach((function(e,i){var s,u,h;if(c>0?r[i]=(null!==(s=r[i])&&void 0!==s?s:0)+c:o[i]=(null!==(u=o[i])&&void 0!==u?u:0)+Math.abs(c),a>=e-1){0!==o[i]?l[n[i].key]=100-100/(1+r[i]/o[i]):l[n[i].key]=0;var d=t[a-(e-1)],p=null!==(h=t[a-e])&&void 0!==h?h:d,g=d.close-p.close;g>0?r[i]-=g:o[i]-=Math.abs(g)}})),l}))}},Xt={name:"SMA",shortName:"SMA",series:t.IndicatorSeries.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(t,e){var i=e.calcParams,n=0,r=0;return t.map((function(t,e){var o={},a=t.close;return n+=a,e>=i[0]-1&&(r=e>i[0]-1?(a*i[1]+r*(i[0]-i[1]+1))/(i[0]+1):n/i[0],o.sma=r),o}))}},Gt={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=[];return t.forEach((function(e,r){var o,a,s,l,u={},c=e.close;if(r>=i[0]-1){var h=mt(t.slice(r-(i[0]-1),r+1),"high","low"),d=h[0],p=h[1],g=d-p,v=(c-p)/(0===g?1:g)*100;u.k=((i[1]-1)*(null!==(a=null===(o=n[r-1])||void 0===o?void 0:o.k)&&void 0!==a?a:50)+v)/i[1],u.d=((i[2]-1)*(null!==(l=null===(s=n[r-1])||void 0===s?void 0:s.d)&&void 0!==l?l:50)+u.k)/i[2],u.j=3*u.k-2*u.d}n.push(u)})),n}},Ut={name:"SAR",shortName:"SAR",series:t.IndicatorSeries.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(t){var e,i,n,r=t.data,o=t.indicator,a=t.defaultStyles,s=r.current;return{color:(null!==(e=null==s?void 0:s.sar)&&void 0!==e?e:Number.MIN_SAFE_INTEGER)<((null!==(i=null==s?void 0:s.high)&&void 0!==i?i:0)+(null!==(n=null==s?void 0:s.low)&&void 0!==n?n:0))/2?L(o.styles,"circles[0].upColor",a.circles[0].upColor):L(o.styles,"circles[0].downColor",a.circles[0].downColor)}}}],calc:function(t,e){var i=e.calcParams,n=i[0]/100,r=i[1]/100,o=i[2]/100,a=n,s=-100,l=!1,u=0;return t.map((function(e,i){var c=u,h=e.high,d=e.low;if(l){(-100===s||s<h)&&(s=h,a=Math.min(a+r,o)),u=c+a*(s-c);var p=Math.min(t[Math.max(1,i)-1].low,d);u>e.low?(u=s,a=n,s=-100,l=!l):u>p&&(u=p)}else{(-100===s||s>d)&&(s=d,a=Math.min(a+r,o)),u=c+a*(s-c);var g=Math.max(t[Math.max(1,i)-1].high,h);u<e.high?(u=s,a=0,s=-100,l=!l):u<g&&(u=g)}return{high:h,low:d,sar:u}}))}};function Zt(){return{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t){var e=t.data,i=t.indicator,n=t.defaultStyles,r=e.current,o=L(i.styles,"bars[0].noChangeColor",n.bars[0].noChangeColor);return E(r)&&(r.close>r.open?o=L(i.styles,"bars[0].upColor",n.bars[0].upColor):r.close<r.open&&(o=L(i.styles,"bars[0].downColor",n.bars[0].downColor))),{color:o}}}}var qt={name:"VOL",shortName:"VOL",series:t.IndicatorSeries.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},Zt()],regenerateFigures:function(t){var e=t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}));return e.push(Zt()),e},calc:function(t,e){var i=e.calcParams,n=e.figures,r=[];return t.map((function(e,o){var a,s=null!==(a=e.volume)&&void 0!==a?a:0,l={volume:s,open:e.open,close:e.close};return i.forEach((function(e,i){var a,u;r[i]=(null!==(a=r[i])&&void 0!==a?a:0)+s,o>=e-1&&(l[n[i].key]=r[i]/e,r[i]-=null!==(u=t[o-(e-1)].volume)&&void 0!==u?u:0)})),l}))}},jt={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures;return t.map((function(e,r){var o={},a=e.close;return i.forEach((function(e,i){var s=e-1;if(r>=s){var l=mt(t.slice(r-s,r+1),"high","low"),u=l[0],c=u-l[1];o[n[i].key]=0===c?0:(a-u)/c*100}})),o}))}},Qt={},Kt=[At,Ft,{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,r=[];return t.map((function(e,o){var a={},s=e.close;return i.forEach((function(e,l){var u;if(r[l]=(null!==(u=r[l])&&void 0!==u?u:0)+s,o>=e-1){var c=r[l]/i[l];a[n[l].key]=(s-c)/c*100,r[l]-=t[o-(e-1)].close}})),a}))}},Rt,{name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,r=0,o=0,a=0;return t.map((function(e,s){var l,u,c={},h=e.high,d=e.low,p=e.open,g=(null!==(l=t[s-1])&&void 0!==l?l:e).close;if(o+=h-p,a+=p-d,n+=h-g,r+=g-d,s>=i[0]-1){c.ar=0!==a?o/a*100:0,c.br=0!==r?n/r*100:0;var v=t[s-(i[0]-1)],f=v.high,y=v.low,m=v.open,_=(null!==(u=t[s-i[0]])&&void 0!==u?u:t[s-(i[0]-1)]).close;n-=f-_,r-=_-y,o-=f-m,a-=m-y}return c}))}},Bt,Lt,Ot,Wt,Vt,{name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,r=[];return t.map((function(e,o){var a,s={};if(o>0){var l=t[o-1],u=e.high,c=e.low,h=null!==(a=e.volume)&&void 0!==a?a:0,d=(u+c)/2-(l.high+l.low)/2;if(0===h||u-c==0)s.emv=0;else{var p=h/1e8/(u-c);s.emv=d/p}n+=s.emv,r.push(s.emv),o>=i[0]&&(s.maEmv=n/i[0],n-=r[o-i[0]])}return s}))}},Nt,{name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,r=[];return t.forEach((function(e,o){var a,s={};if(o>=i[0]){var l=e.close,u=t[o-i[0]].close;s.mtm=l-u,n+=s.mtm,o>=i[0]+i[1]-1&&(s.maMtm=n/i[1],n-=null!==(a=r[o-(i[1]-1)].mtm)&&void 0!==a?a:0)}r.push(s)})),r}},zt,Yt,{name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,r=0,o=[];return t.forEach((function(e,a){var s,l,u,c,h=null!==(s=t[a-1])&&void 0!==s?s:e;e.close<h.close?r-=null!==(l=e.volume)&&void 0!==l?l:0:e.close>h.close&&(r+=null!==(u=e.volume)&&void 0!==u?u:0);var d={obv:r};n+=r,a>=i[0]-1&&(d.maObv=n/i[0],n-=null!==(c=o[a-(i[0]-1)].obv)&&void 0!==c?c:0),o.push(d)})),o}},{name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(t){var e=0;return t.map((function(i,n){var r,o,a={},s=i.close,l=null!==(r=i.volume)&&void 0!==r?r:1,u=(null!==(o=t[n-1])&&void 0!==o?o:i).close,c=0,h=u*l;return 0!==h&&(c=(s-u)/h),e+=c,a.pvt=e,a}))}},{name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,r=0,o=[],a=[];return t.forEach((function(e,s){var l,u,c={},h=(null!==(l=t[s-1])&&void 0!==l?l:e).close,d=e.close-h>0?1:0;o.push(d),n+=d,s>=i[0]-1&&(c.psy=n/i[0]*100,r+=c.psy,s>=i[0]+i[1]-2&&(c.maPsy=r/i[1],r-=null!==(u=a[s-(i[1]-1)].psy)&&void 0!==u?u:0),n-=o[s-(i[0]-1)]),a.push(c)})),a}},{name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=[],r=0;return t.forEach((function(e,o){var a,s,l={};if(o>=i[0]-1){var u=e.close,c=(null!==(a=t[o-i[0]])&&void 0!==a?a:t[o-(i[0]-1)]).close;l.roc=0!==c?(u-c)/c*100:0,r+=l.roc,o>=i[0]-1+i[1]-1&&(l.maRoc=r/i[1],r-=null!==(s=n[o-(i[1]-1)].roc)&&void 0!==s?s:0)}n.push(l)})),n}},Ht,Xt,Gt,Ut,{name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,r=0,o=0,a=0,s=0,l=0,u=0,c=[];return t.forEach((function(t,e){var h,d={},p=t.close;if(n+=p,e>=i[0]-1&&(r=e>i[0]-1?(2*p+(i[0]-1)*r)/(i[0]+1):n/i[0],s+=r,e>=2*i[0]-2&&(o=e>2*i[0]-2?(2*r+(i[0]-1)*o)/(i[0]+1):s/i[0],l+=o,e>=3*i[0]-3))){var g=0,v=0;e>3*i[0]-3?v=((g=(2*o+(i[0]-1)*a)/(i[0]+1))-a)/a*100:g=l/i[0],a=g,d.trix=v,u+=v,e>=3*i[0]+i[1]-4&&(d.maTrix=u/i[1],u-=null!==(h=c[e-(i[1]-1)].trix)&&void 0!==h?h:0)}c.push(d)})),c}},qt,{name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,r=0,o=0,a=0,s=[];return t.forEach((function(e,l){var u,c,h,d,p,g={},v=e.close,f=(null!==(u=t[l-1])&&void 0!==u?u:e).close,y=null!==(c=e.volume)&&void 0!==c?c:0;if(v>f?n+=y:v<f?r+=y:o+=y,l>=i[0]-1){var m=o/2;g.vr=r+m===0?0:(n+m)/(r+m)*100,a+=g.vr,l>=i[0]+i[1]-2&&(g.maVr=a/i[1],a-=null!==(h=s[l-(i[1]-1)].vr)&&void 0!==h?h:0);var _=t[l-(i[0]-1)],x=null!==(d=t[l-i[0]])&&void 0!==d?d:_,b=_.close,C=null!==(p=_.volume)&&void 0!==p?p:0;b>x.close?n-=C:b<x.close?r-=C:o-=C}s.push(g)})),s}},jt];function Jt(t){var e;return null!==(e=Qt[t])&&void 0!==e?e:null}Kt.forEach((function(t){Qt[t.name]=tt.extend(t)}));var $t={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e,i=t.chart,n=t.coordinates,r=t.bounding,o=t.overlay,a=t.yAxis,s=o.points;if(n.length>0){var l=0;if(null===(e=null==a?void 0:a.isInCandle())||void 0===e||e)l=i.getPrecision().price;else i.getIndicators({paneId:o.paneId}).forEach((function(t){l=Math.max(l,t.precision)}));var u=[],c=[],h=r.width;if(n.length>1&&S(s[0].value)&&S(s[1].value)){var d=n[0].y-n[1].y,p=s[0].value-s[1].value;[1,.786,.618,.5,.382,.236,0].forEach((function(t){var e,r=n[1].y+d*t,o=i.getDecimalFold().format(i.getThousandsSeparator().format(((null!==(e=s[1].value)&&void 0!==e?e:0)+p*t).toFixed(l)));u.push({coordinates:[{x:0,y:r},{x:h,y:r}]}),c.push({x:0,y:r,text:"".concat(o," (").concat((100*t).toFixed(1),"%)"),baseline:"bottom"})}))}return[{type:"line",attrs:u},{type:"text",isCheckEvent:!1,attrs:c}]}return[]}},te={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,n={x:0,y:e[0].y};return E(e[1])&&e[0].x<e[1].x&&(n.x=i.width),[{type:"line",attrs:{coordinates:[e[0],n]}}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].value=n.value)}},ee=function(){function t(){this._children=[],this._callbacks=new Map}return t.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},t.prototype.onEvent=function(t,e,i){var n=this._callbacks.get(t);return!(!E(n)||!this.checkEventOn(e))&&n(e,i)},t.prototype.checkEventOn=function(t){var e,i;try{for(var n=y(this._children),r=n.next();!r.done;r=n.next()){if(r.value.checkEventOn(t))return!0}}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.dispatchEvent=function(t,e,i){var n=this._children.length-1;if(n>-1)for(var r=n;r>-1;r--)if(this._children[r].dispatchEvent(t,e,i))return!0;return this.onEvent(t,e,i)},t.prototype.addChild=function(t){return this._children.push(t),this},t.prototype.clear=function(){this._children=[]},t}(),ie=function(t){function e(e){var i=t.call(this)||this;return i.attrs=e.attrs,i.styles=e.styles,i}return i(e,t),e.prototype.checkEventOn=function(t){return this.checkEventOnImp(t,this.attrs,this.styles)},e.prototype.setAttrs=function(t){return this.attrs=t,this},e.prototype.setStyles=function(t){return this.styles=t,this},e.prototype.draw=function(t){this.drawImp(t,this.attrs,this.styles)},e.extend=function(t){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i(n,e),n.prototype.checkEventOnImp=function(e,i,n){return t.checkEventOn(e,i,n)},n.prototype.drawImp=function(e,i,n){t.draw(e,i,n)},n}(e);return n},e}(ee);function ne(t,e){var i,n,r=[];r=r.concat(e);try{for(var o=y(r),a=o.next();!a.done;a=o.next()){var s=a.value.coordinates;if(s.length>1)for(var l=1;l<s.length;l++){var u=s[l-1],c=s[l];if(u.x===c.x){if(Math.abs(u.y-t.y)+Math.abs(c.y-t.y)-Math.abs(u.y-c.y)<4&&Math.abs(t.x-u.x)<2)return!0}else{var h=ae(u,c),d=re(h,t),p=Math.abs(d-t.y);if(Math.abs(u.x-t.x)+Math.abs(c.x-t.x)-Math.abs(u.x-c.x)<4&&p*p/(h[0]*h[0]+1)<4)return!0}}}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return!1}function re(t,e){return null!==t?e.x*t[0]+t[1]:e.y}function oe(t,e,i){return re(ae(t,e),i)}function ae(t,e){var i=t.x-e.x;if(0!==i){var n=(t.y-e.y)/i;return[n,t.y-n*t.x]}return null}function se(t,e,i){var n=e.length,r=S(i)?i>0&&i<1?i:0:i?.5:0;if(r>0&&n>2){for(var o=e[0].x,a=e[0].y,s=1;s<n-1;s++){var l=e[s-1],u=e[s],c=e[s+1],h=u.x-l.x,d=u.y-l.y,p=c.x-u.x,g=c.y-u.y,v=c.x-l.x,f=c.y-l.y,y=Math.sqrt(h*h+d*d),m=Math.sqrt(p*p+g*g),_=m/(m+y),x=u.x+v*r*_,b=u.y+f*r*_;x=Math.min(x,Math.max(c.x,u.x)),b=Math.min(b,Math.max(c.y,u.y)),x=Math.max(x,Math.min(c.x,u.x)),b=Math.max(b,Math.min(c.y,u.y)),v=x-u.x,f=b-u.y;var C=u.x-v*y/m,T=u.y-f*y/m;C=Math.min(C,Math.max(l.x,u.x)),T=Math.min(T,Math.max(l.y,u.y)),C=Math.max(C,Math.min(l.x,u.x)),T=Math.max(T,Math.min(l.y,u.y)),v=u.x-C,f=u.y-T,x=u.x+v*m/y,b=u.y+f*m/y,t.bezierCurveTo(o,a,C,T,u.x,u.y),o=x,a=b}var w=e[n-1];t.bezierCurveTo(o,a,w.x,w.y,w.x,w.y)}else for(s=1;s<n;s++)t.lineTo(e[s].x,e[s].y)}var le={name:"line",checkEventOn:ne,draw:function(e,i,n){!function(e,i,n){var r=[];r=r.concat(i);var o=n.style,a=void 0===o?t.LineType.Solid:o,s=n.smooth,l=void 0!==s&&s,u=n.size,c=void 0===u?1:u,h=n.color,d=void 0===h?"currentColor":h,p=n.dashedValue,g=void 0===p?[2,2]:p;e.lineWidth=c,e.strokeStyle=d,a===t.LineType.Dashed?e.setLineDash(g):e.setLineDash([]);var v=c%2==1?.5:0;r.forEach((function(t){var i=t.coordinates;i.length>1&&(2!==i.length||i[0].x!==i[1].x&&i[0].y!==i[1].y?(e.save(),c%2==1&&e.translate(.5,.5),e.beginPath(),e.moveTo(i[0].x,i[0].y),se(e,i,l),e.stroke(),e.closePath(),e.restore()):(e.beginPath(),i[0].x===i[1].x?(e.moveTo(i[0].x+v,i[0].y),e.lineTo(i[1].x+v,i[1].y)):(e.moveTo(i[0].x,i[0].y+v),e.lineTo(i[1].x,i[1].y+v)),e.stroke(),e.closePath()))}))}(e,i,n)}};function ue(t,e,i){var n=null!=i?i:0,r=[];if(t.length>1)if(t[0].x===t[1].x){var o=e.height;if(r.push({coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:o}]}),t.length>2){r.push({coordinates:[{x:t[2].x,y:0},{x:t[2].x,y:o}]});for(var a=t[0].x-t[2].x,s=0;s<n;s++){var l=a*(s+1);r.push({coordinates:[{x:t[0].x+l,y:0},{x:t[0].x+l,y:o}]})}}}else{var u=e.width,c=ae(t[0],t[1]),h=c[0],d=c[1];if(r.push({coordinates:[{x:0,y:0*h+d},{x:u,y:u*h+d}]}),t.length>2){var p=t[2].y-h*t[2].x;r.push({coordinates:[{x:0,y:0*h+p},{x:u,y:u*h+p}]});for(a=d-p,s=0;s<n;s++){var g=d+a*(s+1);r.push({coordinates:[{x:0,y:0*h+g},{x:u,y:u*h+g}]})}}}return r}var ce={name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:ue(t.coordinates,t.bounding)}]}},he={name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:ue(t.coordinates,t.bounding,1)}]}},de={name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e,i=t.chart,n=t.coordinates,r=t.bounding,o=t.overlay,a=t.yAxis,s=0;null===(e=null==a?void 0:a.isInCandle())||void 0===e||e?s=i.getPrecision().price:i.getIndicators({paneId:o.paneId}).forEach((function(t){s=Math.max(s,t.precision)}));var l=o.points[0].value,u=void 0===l?0:l;return[{type:"line",attrs:{coordinates:[n[0],{x:r.width,y:n[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:n[0].x,y:n[0].y,text:i.getDecimalFold().format(i.getThousandsSeparator().format(u.toFixed(s))),baseline:"bottom"}}]}};function pe(t,e){if(t.length>1){var i={x:0,y:0};return i=t[0].x===t[1].x&&t[0].y!==t[1].y?t[0].y<t[1].y?{x:t[0].x,y:e.height}:{x:t[0].x,y:0}:t[0].x>t[1].x?{x:0,y:oe(t[0],t[1],{x:0,y:t[0].y})}:{x:e.width,y:oe(t[0],t[1],{x:e.width,y:t[0].y})},{coordinates:[t[0],i]}}return[]}var ge={name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:pe(t.coordinates,t.bounding)}]}},ve={name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return 2===e.length?e[0].x===e[1].x?[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:oe(e[0],e[1],{x:0,y:e[0].y})},{x:i.width,y:oe(e[0],e[1],{x:i.width,y:e[0].y})}]}}]:[]}},fe={name:"simpleAnnotation",totalStep:2,styles:{line:{style:t.LineType.Dashed}},createPointFigures:function(t){var e,i=t.overlay,n=t.coordinates,r="";E(i.extendData)&&(r=T(i.extendData)?i.extendData(i):null!==(e=i.extendData)&&void 0!==e?e:"");var o=n[0].x,a=n[0].y-6,s=a-50,l=s-5;return[{type:"line",attrs:{coordinates:[{x:o,y:a},{x:o,y:s}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:o,y:s},{x:o-4,y:l},{x:o+4,y:l}]},ignoreEvent:!0},{type:"text",attrs:{x:o,y:l,text:r,align:"center",baseline:"bottom"},ignoreEvent:!0}]}},ye={name:"simpleTag",totalStep:2,styles:{line:{style:t.LineType.Dashed}},createPointFigures:function(t){var e=t.bounding,i=t.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:i[0].y},{x:e.width,y:i[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(t){var e,i,n=t.chart,r=t.overlay,o=t.coordinates,a=t.bounding,s=t.yAxis,l="left",u=0;null!==(e=null==s?void 0:s.isFromZero())&&void 0!==e&&e?(l="left",u=0):(l="right",u=a.width);var c="";return E(r.extendData)&&(c=T(r.extendData)?r.extendData(r):null!==(i=r.extendData)&&void 0!==i?i:""),!E(c)&&S(r.points[0].value)&&(c=V(r.points[0].value,n.getPrecision().price)),{type:"text",attrs:{x:u,y:o[0].y,text:c,align:l,baseline:"middle"}}}},me={};function _e(t){var e;return null!==(e=me[t])&&void 0!==e?e:null}[$t,te,{name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=[];return 2===e.length&&i.push({coordinates:e}),[{type:"line",attrs:i}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].value=n.value)}},{name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return[{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:i.width,y:e[0].y}]}}]}},ce,he,de,ge,{name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]}},ve,{name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;if(2===e.length){var n={x:e[0].x,y:0};return e[0].y<e[1].y&&(n.y=i.height),[{type:"line",attrs:{coordinates:[e[0],n]}}]}return[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].timestamp=n.timestamp,i[0].dataIndex=n.dataIndex)}},{name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].timestamp=n.timestamp,i[0].dataIndex=n.dataIndex)}},{name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]}},fe,ye].forEach((function(t){me[t.name]=rt.extend(t)}));var xe={light:{grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},dark:{grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}}};function be(t){var e;return null!==(e=xe[t])&&void 0!==e?e:null}var Ce="candle_pane",Te="indicator_pane_",we="x_axis_pane",Se=1,Ee=50,Pe=9e5,Ie=function(){function e(e,i){var n,r,o,a,s,l=this;this._styles={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:t.LineType.Dashed,dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:t.LineType.Dashed,dashedValue:[2,2]}},candle:(s={show:!0,color:D.GREY,textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},{type:t.CandleType.CandleSolid,bar:{compareRule:d.CurrentOpen,upColor:D.GREEN,downColor:D.RED,noChangeColor:D.GREY,upBorderColor:D.GREEN,downBorderColor:D.RED,noChangeBorderColor:D.GREY,upWickColor:D.GREEN,downWickColor:D.RED,noChangeWickColor:D.GREY},area:{lineSize:2,lineColor:D.BLUE,smooth:!1,value:"close",backgroundColor:[{offset:0,color:k(D.BLUE,.01)},{offset:1,color:k(D.BLUE,.2)}],point:{show:!0,color:D.BLUE,radius:4,rippleColor:k(D.BLUE,.3),rippleRadius:8,animation:!0,animationDuration:1e3}},priceMark:{show:!0,high:p({},s),low:p({},s),last:{show:!0,compareRule:d.CurrentOpen,upColor:D.GREEN,downColor:D.RED,noChangeColor:D.GREY,line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:t.PolygonType.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:t.LineType.Solid,borderSize:0,borderDashedValue:[2,2],color:D.WHITE,family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:t.TooltipShowRule.Always,showType:t.TooltipShowType.Standard,custom:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}],defaultValue:"n/a",rect:{position:t.CandleTooltipRectPosition.Fixed,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,offsetLeft:4,offsetTop:4,offsetRight:4,offsetBottom:4,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:D.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},features:[]}}),indicator:(o=k(D.GREEN,.7),a=k(D.RED,.7),{ohlc:{compareRule:d.CurrentOpen,upColor:o,downColor:a,noChangeColor:D.GREY},bars:[{style:t.PolygonType.Fill,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:o,downColor:a,noChangeColor:D.GREY}],lines:["#FF9600","#935EBD",D.BLUE,"#E11D74","#01C5C4"].map((function(e){return{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:e}})),circles:[{style:t.PolygonType.Fill,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:o,downColor:a,noChangeColor:D.GREY}],lastValueMark:{show:!1,text:{show:!1,style:t.PolygonType.Fill,color:D.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderColor:"transparent",borderSize:0,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:t.TooltipShowRule.Always,showType:t.TooltipShowType.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:D.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},features:[]}}),xAxis:A(),yAxis:A(),separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:k(D.BLUE,.08)},crosshair:F(),overlay:(n=k(D.BLUE,.35),r=k(D.BLUE,.25),{point:{color:D.BLUE,borderColor:n,borderSize:1,radius:5,activeColor:D.BLUE,activeBorderColor:n,activeBorderSize:3,activeRadius:5},line:{style:t.LineType.Solid,smooth:!1,color:D.BLUE,size:1,dashedValue:[2,2]},rect:{style:t.PolygonType.Fill,color:r,borderColor:D.BLUE,borderSize:1,borderRadius:0,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},polygon:{style:t.PolygonType.Fill,color:D.BLUE,borderColor:D.BLUE,borderSize:1,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},circle:{style:t.PolygonType.Fill,color:r,borderColor:D.BLUE,borderSize:1,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},arc:{style:t.LineType.Solid,color:D.BLUE,size:1,dashedValue:[2,2]},text:{style:t.PolygonType.Fill,color:D.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:D.BLUE,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:D.BLUE}})},this._customApi={formatDate:function(t,e){return W(l._dateTimeFormat,t,e)},formatBigNumber:N},this._locale="en-US",this._thousandsSeparator={sign:",",format:function(t){return z(t,l._thousandsSeparator.sign)}},this._decimalFold={threshold:3,format:function(t){return Y(t,l._decimalFold.threshold)}},this._precision={price:2,volume:0},this._dataList=[],this._loadMoreDataCallback=null,this._loading=!0,this._loadDataMore={forward:!1,backward:!1},this._zoomEnabled=!0,this._scrollEnabled=!0,this._totalBarSpace=0,this._barSpace=10,this._offsetRightDistance=80,this._startLastBarRightSideDiffBarCount=0,this._scrollLimitRole=0,this._minVisibleBarCount={left:2,right:2},this._maxOffsetDistance={left:50,right:50},this._visibleRange={from:0,to:0,realFrom:0,realTo:0},this._timeWeightTickMap=new Map,this._timeWeightTickList=[],this._minTimeSpan={compare:Number.MAX_SAFE_INTEGER,calc:Pe},this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}],this._crosshair={},this._activeTooltipFeatureInfo=null,this._actions=new Map,this._indicators=new Map,this._taskScheduler=new Ct,this._overlays=new Map,this._progressOverlayInfo=null,this._pressedOverlayInfo={paneId:"",overlay:null,figureType:0,figureIndex:-1,figure:null},this._hoverOverlayInfo={paneId:"",overlay:null,figureType:0,figureIndex:-1,figure:null},this._clickOverlayInfo={paneId:"",overlay:null,figureType:0,figureIndex:-1,figure:null},this._chart=e,this._calcOptimalBarSpace(),this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace;var u=null!=i?i:{},c=u.styles,h=u.locale,g=u.timezone,v=u.customApi,f=u.thousandsSeparator,y=u.decimalFold;E(c)&&this.setStyles(c),I(h)&&this.setLocale(h),this.setTimezone(null!=g?g:""),E(v)&&this.setCustomApi(v),E(f)&&this.setThousandsSeparator(f),E(y)&&this.setDecimalFold(y)}return e.prototype.setStyles=function(t){var e,i,n=null;n=I(t)?be(t):t,x(this._styles,n),C(null===(i=null===(e=null==n?void 0:n.candle)||void 0===e?void 0:e.tooltip)||void 0===i?void 0:i.custom)&&(this._styles.candle.tooltip.custom=n.candle.tooltip.custom)},e.prototype.getStyles=function(){return this._styles},e.prototype.setCustomApi=function(t){x(this._customApi,t)},e.prototype.getCustomApi=function(){return this._customApi},e.prototype.setLocale=function(t){this._locale=t},e.prototype.getLocale=function(){return this._locale},e.prototype.setTimezone=function(t){if(!E(this._dateTimeFormat)||this.getTimezone()!==t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};t.length>0&&(e.timeZone=t);var i=null;try{i=new Intl.DateTimeFormat("en",e)}catch(t){}null!==i&&(this._classifyTimeWeightTicks(this._dataList),this._dateTimeFormat=i)}},e.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},e.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},e.prototype.setThousandsSeparator=function(t){x(this._thousandsSeparator,t)},e.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},e.prototype.setDecimalFold=function(t){x(this._decimalFold,t)},e.prototype.getDecimalFold=function(){return this._decimalFold},e.prototype.getPrecision=function(){return this._precision},e.prototype.setPrecision=function(t){x(this._precision,t),this._synchronizeIndicatorSeriesPrecision()},e.prototype.getDataList=function(){return this._dataList},e.prototype.getVisibleRangeDataList=function(){return this._visibleRangeDataList},e.prototype.getVisibleRangeHighLowPrice=function(){return this._visibleRangeHighLowPrice},e.prototype.addData=function(t,e,i){var n,r,o,a,s=this,l=!1,u=!1,c=0;if(C(t)){switch(c=t.length,e){case ct.Init:this.clearData(),this._dataList=t,this._loadDataMore.backward=null!==(n=null==i?void 0:i.backward)&&void 0!==n&&n,this._loadDataMore.forward=null!==(r=null==i?void 0:i.forward)&&void 0!==r&&r,this._classifyTimeWeightTicks(this._dataList),this.setOffsetRightDistance(this._offsetRightDistance),u=!0;break;case ct.Backward:this._classifyTimeWeightTicks(t,!0),this._dataList=this._dataList.concat(t),this._loadDataMore.backward=null!==(o=null==i?void 0:i.backward)&&void 0!==o&&o,u=c>0;break;case ct.Forward:this._dataList=t.concat(this._dataList),this._classifyTimeWeightTicks(this._dataList),this._loadDataMore.forward=null!==(a=null==i?void 0:i.forward)&&void 0!==a&&a,u=c>0}this._loading=!1,l=!0}else{var h=this._dataList.length,d=t.timestamp,p=L(this._dataList[h-1],"timestamp",0);if(d>p){this._classifyTimeWeightTicks([t],!0),this._dataList.push(t);var g=this.getLastBarRightSideDiffBarCount();g<0&&this.setLastBarRightSideDiffBarCount(--g),c=1,l=!0,u=!0}else d===p&&(this._dataList[h-1]=t,l=!0,u=!0)}l&&(u&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this.getIndicatorsByFilter({}).forEach((function(t){s._addIndicatorCalcTask(t,e)})),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0})))},e.prototype.setLoadMoreDataCallback=function(t){this._loadMoreDataCallback=t},e.prototype._calcOptimalBarSpace=function(){var t=1-.2*Math.atan(Math.max(4,this._barSpace)-4)/(.5*Math.PI),e=Math.min(Math.floor(this._barSpace*t),Math.floor(this._barSpace));e%2==0&&e+2>=this._barSpace&&--e,this._gapBarSpace=Math.max(1,e)},e.prototype._classifyTimeWeightTicks=function(t,e){var i=0,n=null;null!=e&&e?(i=this._dataList.length,n=this._dataList[i-1].timestamp):(this._timeWeightTickMap.clear(),this._minTimeSpan={compare:Number.MAX_SAFE_INTEGER,calc:Pe}),Mt(this._timeWeightTickMap,t,this._dateTimeFormat,i,this._minTimeSpan,n),this._minTimeSpan.compare!==Number.MAX_SAFE_INTEGER&&(this._minTimeSpan.calc=this._minTimeSpan.compare),this._timeWeightTickList=Dt(this._timeWeightTickMap,this._barSpace,this._styles.xAxis.tickText)},e.prototype.getTimeWeightTickList=function(){return this._timeWeightTickList},e.prototype._adjustVisibleRange=function(){var e,i,n,r,o=this,a=this._dataList.length,s=this._totalBarSpace/this._barSpace,l=0,u=0;1===this._scrollLimitRole?(l=(this._totalBarSpace-this._maxOffsetDistance.right)/this._barSpace,u=(this._totalBarSpace-this._maxOffsetDistance.left)/this._barSpace):(l=this._minVisibleBarCount.left,u=this._minVisibleBarCount.right),l=Math.max(0,l),u=Math.max(0,u);var c=s-Math.min(l,a);this._lastBarRightSideDiffBarCount>c&&(this._lastBarRightSideDiffBarCount=c);var h=-a+Math.min(u,a);this._lastBarRightSideDiffBarCount<h&&(this._lastBarRightSideDiffBarCount=h);var d=Math.round(this._lastBarRightSideDiffBarCount+a+.5),p=d;d>a&&(d=a);var g=Math.round(d-s)-1;g<0&&(g=0);var v=this._lastBarRightSideDiffBarCount>0?Math.round(a+this._lastBarRightSideDiffBarCount-s)-1:g;this._visibleRange={from:g,to:d,realFrom:v,realTo:p},this.executeAction(t.ActionType.OnVisibleRangeChange,this._visibleRange),this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}];for(var f=v;f<p;f++){var y=this._dataList[f],m=this.dataIndexToCoordinate(f);this._visibleRangeDataList.push({dataIndex:f,x:m,data:{prev:null!==(e=this._dataList[f-1])&&void 0!==e?e:y,current:y,next:null!==(i=this._dataList[f-1])&&void 0!==i?i:y}}),E(y)&&(this._visibleRangeHighLowPrice[0].price<y.high&&(this._visibleRangeHighLowPrice[0].price=y.high,this._visibleRangeHighLowPrice[0].x=m),this._visibleRangeHighLowPrice[1].price>y.low&&(this._visibleRangeHighLowPrice[1].price=y.low,this._visibleRangeHighLowPrice[1].x=m))}if(!this._loading&&E(this._loadMoreDataCallback)){var _=null;0===g?this._loadDataMore.forward&&(this._loading=!0,_={type:ct.Forward,data:null!==(n=this._dataList[0])&&void 0!==n?n:null,callback:function(t,e){o.addData(t,ct.Forward,{forward:null!=e&&e,backward:null!=e&&e})}}):d===a&&this._loadDataMore.backward&&(this._loading=!0,_={type:ct.Backward,data:null!==(r=this._dataList[a-1])&&void 0!==r?r:null,callback:function(t,e){o.addData(t,ct.Backward,{forward:null!=e&&e,backward:null!=e&&e})}}),E(_)&&this._loadMoreDataCallback(_)}},e.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:Math.floor(this._gapBarSpace/2)}},e.prototype.setBarSpace=function(t,e){t<Se||t>Ee||this._barSpace===t||(this._barSpace=t,this._timeWeightTickList=Dt(this._timeWeightTickMap,this._barSpace,this._styles.xAxis.tickText),this._calcOptimalBarSpace(),null==e||e(),this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0}))},e.prototype.setTotalBarSpace=function(t){this._totalBarSpace!==t&&(this._totalBarSpace=t,this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}))},e.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance=1===this._scrollLimitRole?Math.min(this._maxOffsetDistance.right,t):t,this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace,null!=e&&e&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0})),this},e.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},e.prototype.getOffsetRightDistance=function(){return Math.max(0,this._lastBarRightSideDiffBarCount*this._barSpace)},e.prototype.getLastBarRightSideDiffBarCount=function(){return this._lastBarRightSideDiffBarCount},e.prototype.setLastBarRightSideDiffBarCount=function(t){this._lastBarRightSideDiffBarCount=t},e.prototype.setMaxOffsetLeftDistance=function(t){this._scrollLimitRole=1,this._maxOffsetDistance.left=t},e.prototype.setMaxOffsetRightDistance=function(t){this._scrollLimitRole=1,this._maxOffsetDistance.right=t},e.prototype.setLeftMinVisibleBarCount=function(t){this._scrollLimitRole=0,this._minVisibleBarCount.left=t},e.prototype.setRightMinVisibleBarCount=function(t){this._scrollLimitRole=0,this._minVisibleBarCount.right=t},e.prototype.getVisibleRange=function(){return this._visibleRange},e.prototype.startScroll=function(){this._startLastBarRightSideDiffBarCount=this._lastBarRightSideDiffBarCount},e.prototype.scroll=function(e){if(this._scrollEnabled){var i=e/this._barSpace,n=this._lastBarRightSideDiffBarCount*this._barSpace;this._lastBarRightSideDiffBarCount=this._startLastBarRightSideDiffBarCount-i,this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0});var r=Math.round(n-this._lastBarRightSideDiffBarCount*this._barSpace);0!==r&&this.executeAction(t.ActionType.OnScroll,{distance:r})}},e.prototype.getDataByDataIndex=function(t){var e;return null!==(e=this._dataList[t])&&void 0!==e?e:null},e.prototype.coordinateToFloatIndex=function(t){var e=this._dataList.length,i=(this._totalBarSpace-t)/this._barSpace,n=e+this._lastBarRightSideDiffBarCount-i;return Math.round(1e6*n)/1e6},e.prototype.dataIndexToTimestamp=function(t){var e=this._dataList.length;if(0===e)return null;var i=this.getDataByDataIndex(t);if(E(i))return i.timestamp;var n=e-1;return t>n?this._dataList[n].timestamp+this._minTimeSpan.calc*(t-n):t<0?this._dataList[0].timestamp-this._minTimeSpan.calc*Math.abs(t):null},e.prototype.timestampToDataIndex=function(t){var e=this._dataList.length;if(0===e)return 0;var i=e-1,n=this._dataList[i].timestamp;if(t>n)return i+Math.floor((t-n)/this._minTimeSpan.calc);var r=this._dataList[0].timestamp;return t<r?Math.floor((t-r)/this._minTimeSpan.calc):ft(this._dataList,"timestamp",t)},e.prototype.dataIndexToCoordinate=function(t){var e=this._dataList.length+this._lastBarRightSideDiffBarCount-t;return Math.floor(this._totalBarSpace-(e-.5)*this._barSpace+.5)},e.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},e.prototype.zoom=function(e,i){var n,r=this;if(this._zoomEnabled){var o=null!=i?i:null;S(null==o?void 0:o.x)||(o={x:null!==(n=this._crosshair.x)&&void 0!==n?n:this._totalBarSpace/2});var a=o.x,s=this.coordinateToFloatIndex(a),l=this._barSpace,u=this._barSpace+e*(this._barSpace/10);this.setBarSpace(u,(function(){r._lastBarRightSideDiffBarCount+=s-r.coordinateToFloatIndex(a)}));var c=this._barSpace/l;1!==c&&this.executeAction(t.ActionType.OnZoom,{scale:c})}},e.prototype.setZoomEnabled=function(t){this._zoomEnabled=t},e.prototype.isZoomEnabled=function(){return this._zoomEnabled},e.prototype.setScrollEnabled=function(t){this._scrollEnabled=t},e.prototype.isScrollEnabled=function(){return this._scrollEnabled},e.prototype.setCrosshair=function(t,e){var i,n=null!=e?e:{},r=n.notInvalidate,o=n.notExecuteAction,a=n.forceInvalidate,s=null!=t?t:{},l=0,u=0;u=S(s.x)?(l=this.coordinateToDataIndex(s.x))<0?0:l>this._dataList.length-1?this._dataList.length-1:l:l=this._dataList.length-1;var c=this._dataList[u],h=this.dataIndexToCoordinate(l),d=this._crosshair.x,g=this._crosshair.y,v=this._crosshair.paneId;this._crosshair=p(p({},s),{realX:h,kLineData:c,realDataIndex:l,dataIndex:u,timestamp:null!==(i=this.dataIndexToTimestamp(l))&&void 0!==i?i:void 0}),(d!==s.x||g!==s.y||v!==s.paneId||null!=a&&a)&&(!E(c)||null!=o&&o||this._chart.crosshairChange(this._crosshair),null!=r&&r||this._chart.updatePane(1))},e.prototype.getCrosshair=function(){return this._crosshair},e.prototype.setActiveTooltipFeatureInfo=function(t){this._activeTooltipFeatureInfo=null!=t?t:null},e.prototype.getActiveTooltipFeatureInfo=function(){return this._activeTooltipFeatureInfo},e.prototype.executeAction=function(t,e){var i;null===(i=this._actions.get(t))||void 0===i||i.execute(e)},e.prototype.subscribeAction=function(t,e){var i;this._actions.has(t)||this._actions.set(t,new K),null===(i=this._actions.get(t))||void 0===i||i.subscribe(e)},e.prototype.unsubscribeAction=function(t,e){var i=this._actions.get(t);E(i)&&(i.unsubscribe(e),i.isEmpty()&&this._actions.delete(t))},e.prototype.hasAction=function(t){var e=this._actions.get(t);return E(e)&&!e.isEmpty()},e.prototype._sortIndicators=function(t){var e;I(t)?null===(e=this._indicators.get(t))||void 0===e||e.sort((function(t,e){return t.zLevel-e.zLevel})):this._indicators.forEach((function(t){t.sort((function(t,e){return t.zLevel-e.zLevel}))}))},e.prototype._addIndicatorCalcTask=function(t,e){var i=this;this._taskScheduler.addTask({id:bt(t.id),handler:function(){var n;null===(n=t.onDataStateChange)||void 0===n||n.call(t,{state:Q.Loading,type:e,indicator:t}),t.calcImp(i._dataList).then((function(n){var r;n&&(i._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0}),null===(r=t.onDataStateChange)||void 0===r||r.call(t,{state:Q.Ready,type:e,indicator:t}))})).catch((function(){var i;null===(i=t.onDataStateChange)||void 0===i||i.call(t,{state:Q.Error,type:e,indicator:t})}))}})},e.prototype.addIndicator=function(t,e,i){var n=t.name;if(this.getIndicatorsByFilter(t).length>0)return!1;var r=this.getIndicatorsByPaneId(e),o=new(Jt(n));return this._synchronizeIndicatorSeriesPrecision(o),o.paneId=e,o.override(t),i||(this.removeIndicator({paneId:e}),r=[]),r.push(o),this._indicators.set(e,r),this._sortIndicators(e),this._addIndicatorCalcTask(o,ct.Init),!0},e.prototype.getIndicatorsByPaneId=function(t){var e;return null!==(e=this._indicators.get(t))&&void 0!==e?e:[]},e.prototype.getIndicatorsByFilter=function(t){var e=t.paneId,i=t.name,n=t.id,r=function(t){return E(n)?t.id===n:!E(i)||t.name===i},o=[];return E(e)?o=o.concat(this.getIndicatorsByPaneId(e).filter(r)):this._indicators.forEach((function(t){o=o.concat(t.filter(r))})),o},e.prototype.removeIndicator=function(t){var e=this,i=!1;return this.getIndicatorsByFilter(t).forEach((function(t){var n=e.getIndicatorsByPaneId(t.paneId),r=n.findIndex((function(e){return e.id===t.id}));r>-1&&(e._taskScheduler.removeTask(bt(t.id)),n.splice(r,1),i=!0),0===n.length&&e._indicators.delete(t.paneId)})),i},e.prototype.hasIndicators=function(t){return this._indicators.has(t)},e.prototype._synchronizeIndicatorSeriesPrecision=function(e){var i=this._precision,n=i.price,r=i.volume,o=function(e){switch(e.series){case t.IndicatorSeries.Price:e.setSeriesPrecision(n);break;case t.IndicatorSeries.Volume:e.setSeriesPrecision(r)}};E(e)?o(e):this._indicators.forEach((function(t){t.forEach((function(t){o(t)}))}))},e.prototype.overrideIndicator=function(t){var e=this,i=!1,n=!1;return this.getIndicatorsByFilter(t).forEach((function(r){r.override(t);var o=r.shouldUpdateImp(),a=o.calc,s=o.draw;o.sort&&(n=!0),a?e._addIndicatorCalcTask(r,ct.Update):s&&(i=!0)})),n&&this._sortIndicators(),!!i&&(this._chart.layout({update:!0}),!0)},e.prototype.getOverlaysByFilter=function(t){var e,i=t.id,n=t.groupId,r=t.paneId,o=t.name,a=function(t){return E(i)?t.id===i:E(n)?t.groupId===n&&(!E(o)||t.name===o):!E(o)||t.name===o},s=[];E(r)?s=s.concat(this.getOverlaysByPaneId(r).filter(a)):this._overlays.forEach((function(t){s=s.concat(t.filter(a))}));var l=null===(e=this._progressOverlayInfo)||void 0===e?void 0:e.overlay;return E(l)&&a(l)&&s.push(l),s},e.prototype.getOverlaysByPaneId=function(t){var e;if(!I(t)){var i=[];return this._overlays.forEach((function(t){i=i.concat(t)})),i}return null!==(e=this._overlays.get(t))&&void 0!==e?e:[]},e.prototype._sortOverlays=function(t){var e;I(t)?null===(e=this._overlays.get(t))||void 0===e||e.sort((function(t,e){return t.zLevel-e.zLevel})):this._overlays.forEach((function(t){t.sort((function(t,e){return t.zLevel-e.zLevel}))}))},e.prototype.addOverlays=function(t,e){var i=this,n=[],r=t.map((function(t,r){var o,a,s,l,u,c,h,d;if(E(t.id)){var p=null;try{for(var g=y(i._overlays),v=g.next();!v.done;v=g.next()){if(E(x=m(v.value,2)[1].find((function(e){return e.id===t.id})))){p=x;break}}}catch(t){o={error:t}}finally{try{v&&!v.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}if(E(p))return t.id}var f=_e(t.name);if(E(f)){var _=null!==(s=t.id)&&void 0!==s?s:gt("overlay_"),x=new f,b=null!==(l=t.paneId)&&void 0!==l?l:Ce;t.id=_,null!==(u=t.groupId)&&void 0!==u||(t.groupId=_);var C=i.getOverlaysByPaneId(b).length;return null!==(c=t.zLevel)&&void 0!==c||(t.zLevel=C),x.override(t),n.includes(b)||n.push(b),x.isDrawing()?i._progressOverlayInfo={paneId:b,overlay:x,appointPaneFlag:e[r]}:(i._overlays.has(b)||i._overlays.set(b,[]),null===(h=i._overlays.get(b))||void 0===h||h.push(x)),x.isStart()&&(null===(d=x.onDrawStart)||void 0===d||d.call(x,{overlay:x,chart:i._chart})),_}return null}));return n.length>0&&(this._sortOverlays(),n.forEach((function(t){i._chart.updatePane(1,t)})),this._chart.updatePane(1,we)),r},e.prototype.getProgressOverlayInfo=function(){return this._progressOverlayInfo},e.prototype.progressOverlayComplete=function(){var t;if(null!==this._progressOverlayInfo){var e=this._progressOverlayInfo,i=e.overlay,n=e.paneId;i.isDrawing()||(this._overlays.has(n)||this._overlays.set(n,[]),null===(t=this._overlays.get(n))||void 0===t||t.push(i),this._sortOverlays(n),this._progressOverlayInfo=null)}},e.prototype.updateProgressOverlayInfo=function(t,e){null!==this._progressOverlayInfo&&(P(e)&&e&&(this._progressOverlayInfo.appointPaneFlag=e),this._progressOverlayInfo.paneId=t,this._progressOverlayInfo.overlay.override({paneId:t}))},e.prototype.overrideOverlay=function(t){var e=this,i=!1,n=[];return this.getOverlaysByFilter(t).forEach((function(e){e.override(t);var r=e.shouldUpdate(),o=r.sort,a=r.draw;o&&(i=!0),(o||a)&&(n.includes(e.paneId)||n.push(e.paneId))})),i&&this._sortOverlays(),n.length>0&&(n.forEach((function(t){e._chart.updatePane(1,t)})),this._chart.updatePane(1,we),!0)},e.prototype.removeOverlay=function(t){var e=this,i=[];return this.getOverlaysByFilter(t).forEach((function(t){var n,r=t.paneId,o=e.getOverlaysByPaneId(t.paneId);if(null===(n=t.onRemoved)||void 0===n||n.call(t,{overlay:t,chart:e._chart}),i.includes(r)||i.push(r),t.isDrawing())e._progressOverlayInfo=null;else{var a=o.findIndex((function(e){return e.id===t.id}));a>-1&&o.splice(a,1)}0===o.length&&e._overlays.delete(r)})),i.length>0&&(i.forEach((function(t){e._chart.updatePane(1,t)})),this._chart.updatePane(1,we),!0)},e.prototype.setPressedOverlayInfo=function(t){this._pressedOverlayInfo=t},e.prototype.getPressedOverlayInfo=function(){return this._pressedOverlayInfo},e.prototype.setHoverOverlayInfo=function(t,e){var i,n=this._hoverOverlayInfo,r=n.overlay,o=n.figureType,a=n.figureIndex,s=n.figure,l=t.overlay;if(((null==r?void 0:r.id)!==(null==l?void 0:l.id)||o!==t.figureType||a!==t.figureIndex)&&(this._hoverOverlayInfo=t,(null==r?void 0:r.id)!==(null==l?void 0:l.id))){var u=!1,c=!1;null!==r&&(r.override({zLevel:r.getPrevZLevel()}),c=!0,T(r.onMouseLeave)&&et("onMouseLeave",s)&&(r.onMouseLeave(p({chart:this._chart,overlay:r,figure:null!=s?s:void 0},e)),u=!0)),null!==l&&(l.setPrevZLevel(l.zLevel),l.override({zLevel:Number.MAX_SAFE_INTEGER}),c=!0,T(l.onMouseEnter)&&et("onMouseEnter",t.figure)&&(l.onMouseEnter(p({chart:this._chart,overlay:l,figure:null!==(i=t.figure)&&void 0!==i?i:void 0},e)),u=!0)),c&&this._sortOverlays(),u||this._chart.updatePane(1)}},e.prototype.getHoverOverlayInfo=function(){return this._hoverOverlayInfo},e.prototype.setClickOverlayInfo=function(t,e){var i,n,r,o,a,s,l=this._clickOverlayInfo,u=l.paneId,c=l.overlay,h=l.figureType,d=l.figure,g=l.figureIndex,v=t.overlay;null!==(i=null==v?void 0:v.isDrawing())&&void 0!==i&&i||!et("onClick",t.figure)||null===(n=null==v?void 0:v.onClick)||void 0===n||n.call(v,p({chart:this._chart,overlay:v,figure:null!==(r=t.figure)&&void 0!==r?r:void 0},e)),(null==c?void 0:c.id)===(null==v?void 0:v.id)&&h===t.figureType&&g===t.figureIndex||(this._clickOverlayInfo=t,(null==c?void 0:c.id)!==(null==v?void 0:v.id)&&(et("onDeselected",d)&&(null===(o=null==c?void 0:c.onDeselected)||void 0===o||o.call(c,p({chart:this._chart,overlay:c,figure:null!=d?d:void 0},e))),et("onSelected",t.figure)&&(null===(a=null==v?void 0:v.onSelected)||void 0===a||a.call(v,p({chart:this._chart,overlay:v,figure:null!==(s=t.figure)&&void 0!==s?s:void 0},e))),this._chart.updatePane(1,t.paneId),u!==t.paneId&&this._chart.updatePane(1,u),this._chart.updatePane(1,we)))},e.prototype.getClickOverlayInfo=function(){return this._clickOverlayInfo},e.prototype.isOverlayEmpty=function(){return 0===this._overlays.size&&null===this._progressOverlayInfo},e.prototype.isOverlayDrawing=function(){var t,e;return null!==(e=null===(t=this._progressOverlayInfo)||void 0===t?void 0:t.overlay.isDrawing())&&void 0!==e&&e},e.prototype.clearData=function(){this._loadDataMore.backward=!1,this._loadDataMore.forward=!1,this._loading=!0,this._dataList=[],this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}],this._visibleRange={from:0,to:0,realFrom:0,realTo:0},this._timeWeightTickMap.clear(),this._timeWeightTickList=[],this._crosshair={},this._activeTooltipFeatureInfo=null},e.prototype.getChart=function(){return this._chart},e}(),Me="main",ke="xAxis",De="yAxis",Ae="separator";var Fe=function(){function t(t,e){var i=this;this._supportedDevicePixelContentBox=!1,this._width=0,this._height=0,this._pixelWidth=0,this._pixelHeight=0,this._nextPixelWidth=0,this._nextPixelHeight=0,this._requestAnimationId=at,this._mediaQueryListener=function(){var t=G(i._element);i._nextPixelWidth=Math.round(i._element.clientWidth*t),i._nextPixelHeight=Math.round(i._element.clientHeight*t),i._resetPixelRatio()},this._listener=e,this._element=vt("canvas",t),this._ctx=this._element.getContext("2d"),function(){return v(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){var e=new ResizeObserver((function(i){t(i.every((function(t){return"devicePixelContentBoxSize"in t}))),e.disconnect()}));e.observe(document.body,{box:"device-pixel-content-box"})})).catch((function(){return!1}))];case 1:return[2,t.sent()]}}))}))}().then((function(t){i._supportedDevicePixelContentBox=t,t?(i._resizeObserver=new ResizeObserver((function(t){var e=t.find((function(t){return t.target===i._element})),n=null==e?void 0:e.devicePixelContentBoxSize[0];E(n)&&(i._nextPixelWidth=n.inlineSize,i._nextPixelHeight=n.blockSize,i._pixelWidth===i._nextPixelWidth&&i._pixelHeight===i._nextPixelHeight||i._resetPixelRatio())})),i._resizeObserver.observe(i._element,{box:"device-pixel-content-box"})):(i._mediaQueryList=window.matchMedia("(resolution: ".concat(G(i._element),"dppx)")),i._mediaQueryList.addListener(i._mediaQueryListener))})).catch((function(t){return!1}))}return t.prototype._resetPixelRatio=function(){var t=this;this._executeListener((function(){var e=t._element.clientWidth,i=t._element.clientHeight;t._width=e,t._height=i,t._pixelWidth=t._nextPixelWidth,t._pixelHeight=t._nextPixelHeight,t._element.width=t._nextPixelWidth,t._element.height=t._nextPixelHeight;var n=t._nextPixelWidth/e,r=t._nextPixelHeight/i;t._ctx.scale(n,r)}))},t.prototype._executeListener=function(t){var e=this;this._requestAnimationId===at&&(this._requestAnimationId=st((function(){e._ctx.clearRect(0,0,e._width,e._height),null==t||t(),e._listener(),e._requestAnimationId=at})))},t.prototype.update=function(t,e){if(this._width!==t||this._height!==e){if(this._element.style.width="".concat(t,"px"),this._element.style.height="".concat(e,"px"),!this._supportedDevicePixelContentBox){var i=G(this._element);this._nextPixelWidth=Math.round(t*i),this._nextPixelHeight=Math.round(e*i),this._resetPixelRatio()}}else this._executeListener()},t.prototype.getElement=function(){return this._element},t.prototype.getContext=function(){return this._ctx},t.prototype.destroy=function(){E(this._resizeObserver)&&this._resizeObserver.unobserve(this._element),E(this._mediaQueryList)&&this._mediaQueryList.removeListener(this._mediaQueryListener)},t}(),Re=function(t){function e(e,i){var n=t.call(this)||this;return n._bounding=ot(),n._pane=i,n._rootContainer=e,n._container=n.createContainer(),e.appendChild(n._container),n}return i(e,t),e.prototype.setBounding=function(t){return x(this._bounding,t),this},e.prototype.getContainer=function(){return this._container},e.prototype.getBounding=function(){return this._bounding},e.prototype.getPane=function(){return this._pane},e.prototype.update=function(t){this.updateImp(this._container,this._bounding,null!=t?t:3)},e.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},e}(ee),Be=function(t){function e(e,i){var n=t.call(this,e,i)||this;n._mainCanvas=new Fe({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},(function(){n.updateMain(n._mainCanvas.getContext())})),n._overlayCanvas=new Fe({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},(function(){n.updateOverlay(n._overlayCanvas.getContext())}));var r=n.getContainer();return r.appendChild(n._mainCanvas.getElement()),r.appendChild(n._overlayCanvas.getElement()),n}return i(e,t),e.prototype.createContainer=function(){return vt("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})},e.prototype.updateImp=function(t,e,i){var n=e.width,r=e.height,o=e.left;t.style.left="".concat(o,"px");var a=i,s=t.clientWidth,l=t.clientHeight;switch(n===s&&r===l||(t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px"),a=3),a){case 0:this._mainCanvas.update(n,r);break;case 1:this._overlayCanvas.update(n,r);break;case 3:case 4:this._mainCanvas.update(n,r),this._overlayCanvas.update(n,r)}},e.prototype.destroy=function(){this._mainCanvas.destroy(),this._overlayCanvas.destroy()},e.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,n=e.height,r=vt("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),o=r.getContext("2d"),a=G(r);return r.width=i*a,r.height=n*a,o.scale(a,a),o.drawImage(this._mainCanvas.getElement(),0,0,i,n),t&&o.drawImage(this._overlayCanvas.getElement(),0,0,i,n),r},e}(Re);function Le(t,e){var i,n,r=[];r=r.concat(e);try{for(var o=y(r),a=o.next();!a.done;a=o.next()){var s=a.value,l=s.x,u=s.y,c=s.r,h=t.x-l,d=t.y-u;if(!(h*h+d*d>c*c))return!0}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return!1}var Oe={name:"circle",checkEventOn:Le,draw:function(e,i,n){!function(e,i,n){var r=[];r=r.concat(i);var o=n.style,a=void 0===o?t.PolygonType.Fill:o,s=n.color,l=void 0===s?"currentColor":s,u=n.borderSize,c=void 0===u?1:u,h=n.borderColor,d=void 0===h?"currentColor":h,p=n.borderStyle,g=void 0===p?t.LineType.Solid:p,v=n.borderDashedValue,f=void 0===v?[2,2]:v,y=!(a!==t.PolygonType.Fill&&n.style!==t.PolygonType.StrokeFill||I(l)&&M(l));y&&(e.fillStyle=l,r.forEach((function(t){var i=t.x,n=t.y,r=t.r;e.beginPath(),e.arc(i,n,r,0,2*Math.PI),e.closePath(),e.fill()}))),(a===t.PolygonType.Stroke||n.style===t.PolygonType.StrokeFill)&&c>0&&!M(d)&&(e.strokeStyle=d,e.lineWidth=c,g===t.LineType.Dashed?e.setLineDash(f):e.setLineDash([]),r.forEach((function(t){var i=t.x,n=t.y,r=t.r;(!y||r>c)&&(e.beginPath(),e.arc(i,n,r,0,2*Math.PI),e.closePath(),e.stroke())})))}(e,i,n)}};function We(t,e){var i,n,r=[];r=r.concat(e);try{for(var o=y(r),a=o.next();!a.done;a=o.next()){for(var s=a.value,l=!1,u=s.coordinates,c=0,h=u.length-1;c<u.length;h=c++)u[c].y>t.y!=u[h].y>t.y&&t.x<(u[h].x-u[c].x)*(t.y-u[c].y)/(u[h].y-u[c].y)+u[c].x&&(l=!l);if(l)return!0}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return!1}var Ve={name:"polygon",checkEventOn:We,draw:function(e,i,n){!function(e,i,n){var r=[];r=r.concat(i);var o=n.style,a=void 0===o?t.PolygonType.Fill:o,s=n.color,l=void 0===s?"currentColor":s,u=n.borderSize,c=void 0===u?1:u,h=n.borderColor,d=void 0===h?"currentColor":h,p=n.borderStyle,g=void 0===p?t.LineType.Solid:p,v=n.borderDashedValue,f=void 0===v?[2,2]:v;a!==t.PolygonType.Fill&&n.style!==t.PolygonType.StrokeFill||I(l)&&M(l)||(e.fillStyle=l,r.forEach((function(t){var i=t.coordinates;e.beginPath(),e.moveTo(i[0].x,i[0].y);for(var n=1;n<i.length;n++)e.lineTo(i[n].x,i[n].y);e.closePath(),e.fill()}))),(a===t.PolygonType.Stroke||n.style===t.PolygonType.StrokeFill)&&c>0&&!M(d)&&(e.strokeStyle=d,e.lineWidth=c,g===t.LineType.Dashed?e.setLineDash(f):e.setLineDash([]),r.forEach((function(t){var i=t.coordinates;e.beginPath(),e.moveTo(i[0].x,i[0].y);for(var n=1;n<i.length;n++)e.lineTo(i[n].x,i[n].y);e.closePath(),e.stroke()})))}(e,i,n)}};function Ne(t,e){var i,n,r=[];r=r.concat(e);try{for(var o=y(r),a=o.next();!a.done;a=o.next()){var s=a.value,l=s.x,u=s.width;u<4&&(l-=2,u=4);var c=s.y,h=s.height;if(h<4&&(c-=2,h=4),t.x>=l&&t.x<=l+u&&t.y>=c&&t.y<=c+h)return!0}}catch(t){i={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return!1}function ze(e,i,n){var r,o=[];o=o.concat(i);var a=n.style,s=void 0===a?t.PolygonType.Fill:a,l=n.color,u=void 0===l?"transparent":l,c=n.borderSize,h=void 0===c?1:c,d=n.borderColor,p=void 0===d?"transparent":d,g=n.borderStyle,v=void 0===g?t.LineType.Solid:g,f=n.borderRadius,y=void 0===f?0:f,m=n.borderDashedValue,_=void 0===m?[2,2]:m,x=null!==(r=e.roundRect)&&void 0!==r?r:e.rect,b=!(s!==t.PolygonType.Fill&&n.style!==t.PolygonType.StrokeFill||I(u)&&M(u));if(b&&(e.fillStyle=u,o.forEach((function(t){var i=t.x,n=t.y,r=t.width,o=t.height;e.beginPath(),x.call(e,i,n,r,o,y),e.closePath(),e.fill()}))),(s===t.PolygonType.Stroke||n.style===t.PolygonType.StrokeFill)&&h>0&&!M(p)){e.strokeStyle=p,e.fillStyle=p,e.lineWidth=h,v===t.LineType.Dashed?e.setLineDash(_):e.setLineDash([]);var C=h%2==1?.5:0,T=Math.round(2*C);o.forEach((function(t){var i=t.x,n=t.y,r=t.width,o=t.height;r>2*h&&o>2*h?(e.beginPath(),x.call(e,i+C,n+C,r-T,o-T,y),e.closePath(),e.stroke()):b||e.fillRect(i,n,r,o)}))}}var Ye={name:"rect",checkEventOn:Ne,draw:function(t,e,i){ze(t,e,i)}};function He(t,e){var i=e.size,n=void 0===i?12:i,r=e.paddingLeft,o=void 0===r?0:r,a=e.paddingTop,s=void 0===a?0:a,l=e.paddingRight,u=void 0===l?0:l,c=e.paddingBottom,h=void 0===c?0:c,d=e.weight,p=void 0===d?"normal":d,g=e.family,v=t.x,f=t.y,y=t.text,m=t.align,_=void 0===m?"left":m,x=t.baseline,b=void 0===x?"top":x,C=t.width,T=t.height,w=null!=C?C:o+Z(y,n,p,g)+u,S=null!=T?T:s+n+h,E=0;switch(_){case"left":case"start":E=v;break;case"right":case"end":E=v-w;break;default:E=v-w/2}var P=0;switch(b){case"top":case"hanging":P=f;break;case"bottom":case"ideographic":case"alphabetic":P=f-S;break;default:P=f-S/2}return{x:E,y:P,width:w,height:S}}function Xe(t,e,i){var n,r,o=[];o=o.concat(e);try{for(var a=y(o),s=a.next();!s.done;s=a.next()){var l=He(s.value,i),u=l.x,c=l.y,h=l.width,d=l.height;if(t.x>=u&&t.x<=u+h&&t.y>=c&&t.y<=c+d)return!0}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!1}var Ge={name:"text",checkEventOn:Xe,draw:function(t,e,i){!function(t,e,i){var n=[];n=n.concat(e);var r=i.color,o=void 0===r?"currentColor":r,a=i.size,s=void 0===a?12:a,l=i.family,u=i.weight,c=i.paddingLeft,h=void 0===c?0:c,d=i.paddingTop,g=void 0===d?0:d,v=i.paddingRight,f=void 0===v?0:v,y=n.map((function(t){return He(t,i)}));ze(t,y,p(p({},i),{color:i.backgroundColor})),t.textAlign="left",t.textBaseline="top",t.font=U(s,u,l),t.fillStyle=o,n.forEach((function(e,i){var n=y[i];t.fillText(e.text,n.x+h,n.y+g,n.width-h-f)}))}(t,e,i)}};function Ue(t,e){var i,n,r,o,a,s,l=[];l=l.concat(e);try{for(var u=y(l),c=u.next();!c.done;c=u.next()){var h=c.value;if(Math.abs((o=h,a=void 0,s=void 0,a=(r=t).x-o.x,s=r.y-o.y,Math.sqrt(a*a+s*s)-h.r))<2){var d=h.r,p=h.startAngle,g=h.endAngle,v=d*Math.cos(p)+h.x,f=d*Math.sin(p)+h.y,m=d*Math.cos(g)+h.x,_=d*Math.sin(g)+h.y;if(t.x<=Math.max(v,m)+2&&t.x>=Math.min(v,m)-2&&t.y<=Math.max(f,_)+2&&t.y>=Math.min(f,_)-2)return!0}}}catch(t){i={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(i)throw i.error}}return!1}var Ze={name:"arc",checkEventOn:Ue,draw:function(e,i,n){!function(e,i,n){var r=[];r=r.concat(i);var o=n.style,a=void 0===o?t.LineType.Solid:o,s=n.size,l=void 0===s?1:s,u=n.color,c=void 0===u?"currentColor":u,h=n.dashedValue,d=void 0===h?[2,2]:h;e.lineWidth=l,e.strokeStyle=c,a===t.LineType.Dashed?e.setLineDash(d):e.setLineDash([]),r.forEach((function(t){var i=t.x,n=t.y,r=t.r,o=t.startAngle,a=t.endAngle;e.beginPath(),e.arc(i,n,r,o,a),e.stroke(),e.closePath()}))}(e,i,n)}};function qe(t,e,i,n,r,o,a){var s=m(n,7),l=s[0],u=s[1],c=s[2],h=s[3],d=s[4],p=s[5],g=s[6],v=function(t,e,i,n,r,o,a,s,l){for(var u=function(t,e,i,n,r,o,a,s,l){var u=r*Math.PI/180,c=(t-s)/2,h=(e-l)/2,d=Math.cos(u)*c+Math.sin(u)*h,p=-Math.sin(u)*c+Math.cos(u)*h,g=Math.pow(d,2)/Math.pow(i,2)+Math.pow(p,2)/Math.pow(n,2);g>1&&(i*=Math.sqrt(g),n*=Math.sqrt(g));var v=o===a?-1:1,f=Math.pow(i,2)*Math.pow(n,2)-Math.pow(i,2)*Math.pow(p,2)-Math.pow(n,2)*Math.pow(d,2),y=Math.pow(i,2)*Math.pow(p,2)+Math.pow(n,2)*Math.pow(d,2),m=v*Math.sqrt(Math.abs(f/y))*(i*p/n),_=v*Math.sqrt(Math.abs(f/y))*(-n*d/i),x=Math.cos(u)*m-Math.sin(u)*_+(t+s)/2,b=Math.sin(u)*m+Math.cos(u)*_+(e+l)/2,C=Math.atan2((p-_)/n,(d-m)/i),T=Math.atan2((-p-_)/n,(-d-m)/i)-C;T<0&&1===a?T+=2*Math.PI:T>0&&0===a&&(T-=2*Math.PI);return{cx:x,cy:b,startAngle:C,deltaAngle:T}}(t,e,i,n,r,o,a,s,l),c=u.cx,h=u.cy,d=u.startAngle,p=u.deltaAngle,g=[],v=Math.ceil(Math.abs(p)/(Math.PI/2)),f=0;f<v;f++){var y=je(c,h,i,n,r,d+f*p/v,d+(f+1)*p/v);g.push(y)}return g}(e,i,l,u,c,h,d,a?e+p:p+r,a?i+g:g+o);v.forEach((function(e){t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}))}function je(t,e,i,n,r,o,a){var s=Math.sin(a-o)*(Math.sqrt(4+3*Math.pow(Math.tan((a-o)/2),2))-1)/3,l=Math.cos(r),u=Math.sin(r),c=t+i*Math.cos(o)*l-n*Math.sin(o)*u,h=e+i*Math.cos(o)*u+n*Math.sin(o)*l,d=t+i*Math.cos(a)*l-n*Math.sin(a)*u,p=e+i*Math.cos(a)*u+n*Math.sin(a)*l;return[c+s*(-i*Math.sin(o)*l-n*Math.cos(o)*u),h+s*(-i*Math.sin(o)*u+n*Math.cos(o)*l),d-s*(-i*Math.sin(a)*l-n*Math.cos(a)*u),p-s*(-i*Math.sin(a)*u+n*Math.cos(a)*l),d,p]}var Qe={name:"path",checkEventOn:Ne,draw:function(t,e,i){!function(t,e,i){var n=[];n=n.concat(e);var o=i.lineWidth,a=void 0===o?1:o,s=i.color,l=void 0===s?"currentColor":s;t.lineWidth=a,t.strokeStyle=l,t.setLineDash([]),n.forEach((function(e){var n=e.x,o=e.y,a=e.path.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/gi);if(E(a)){var s=n,l=o;t.beginPath(),a.forEach((function(e){var i=0,n=0,r=0,o=0,a=e[0],u=e.slice(1).trim().split(/[\s,]+/).map(Number);switch(a){case"M":i=u[0]+s,n=u[1]+l,t.moveTo(i,n),r=i,o=n;break;case"m":i+=u[0],n+=u[1],t.moveTo(i,n),r=i,o=n;break;case"L":i=u[0]+s,n=u[1]+l,t.lineTo(i,n);break;case"l":i+=u[0],n+=u[1],t.lineTo(i,n);break;case"H":i=u[0]+s,t.lineTo(i,n);break;case"h":i+=u[0],t.lineTo(i,n);break;case"V":n=u[0]+l,t.lineTo(i,n);break;case"v":n+=u[0],t.lineTo(i,n);break;case"C":t.bezierCurveTo(u[0]+s,u[1]+l,u[2]+s,u[3]+l,u[4]+s,u[5]+l),i=u[4]+s,n=u[5]+l;break;case"c":t.bezierCurveTo(i+u[0],n+u[1],i+u[2],n+u[3],i+u[4],n+u[5]),i+=u[4],n+=u[5];break;case"S":t.bezierCurveTo(i,n,u[0]+s,u[1]+l,u[2]+s,u[3]+l),i=u[2]+s,n=u[3]+l;break;case"s":t.bezierCurveTo(i,n,i+u[0],n+u[1],i+u[2],n+u[3]),i+=u[2],n+=u[3];break;case"Q":t.quadraticCurveTo(u[0]+s,u[1]+l,u[2]+s,u[3]+l),i=u[2]+s,n=u[3]+l;break;case"q":t.quadraticCurveTo(i+u[0],n+u[1],i+u[2],n+u[3]),i+=u[2],n+=u[3];break;case"T":t.quadraticCurveTo(i,n,u[0]+s,u[1]+l),i=u[0]+s,n=u[1]+l;break;case"t":t.quadraticCurveTo(i,n,i+u[0],n+u[1]),i+=u[0],n+=u[1];break;case"A":qe(t,i,n,u,s,l,!1),i=u[5]+s,n=u[6]+l;break;case"a":qe(t,i,n,u,s,l,!0),i+=u[5],n+=u[6];break;case"Z":case"z":t.closePath(),i=r,n=o}})),i.style===r.Fill?t.fill():t.stroke()}}))}(t,e,i)}},Ke={};[Oe,le,Ve,Ye,Ge,Ze,Qe].forEach((function(t){Ke[t.name]=ie.extend(t)}));var Je,$e=function(t){function e(e){var i=t.call(this)||this;return i._widget=e,i}return i(e,t),e.prototype.getWidget=function(){return this._widget},e.prototype.createFigure=function(t,e){var i,n,r=(i=t.name,null!==(n=Ke[i])&&void 0!==n?n:null);if(null!==r){var o=new r(t);if(E(e)){for(var a in e)e.hasOwnProperty(a)&&o.registerEvent(a,e[a]);this.addChild(o)}return o}return null},e.prototype.draw=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.clear(),this.drawImp(t,e)},e}(ee),ti=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i,n=this.getWidget(),r=this.getWidget().getPane(),o=r.getChart(),a=n.getBounding(),s=o.getStyles().grid;if(s.show){t.save(),t.globalCompositeOperation="destination-over";var l=s.horizontal;if(l.show){var u=r.getAxisComponent().getTicks().map((function(t){return{coordinates:[{x:0,y:t.coord},{x:a.width,y:t.coord}]}}));null===(e=this.createFigure({name:"line",attrs:u,styles:l}))||void 0===e||e.draw(t)}var c=s.vertical;if(c.show){u=o.getXAxisPane().getAxisComponent().getTicks().map((function(t){return{coordinates:[{x:t.coord,y:0},{x:t.coord,y:a.height}]}}));null===(i=this.createFigure({name:"line",attrs:u,styles:c}))||void 0===i||i.draw(t)}t.restore()}},e}($e),ei=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.eachChildren=function(t){for(var e=this.getWidget().getPane().getChart().getChartStore(),i=e.getVisibleRangeDataList(),n=e.getBarSpace(),r=i.length,o=0;o<r;)t(i[o],n,o),++o},e}($e),ii=function(e){function n(){var i=e.apply(this,_([],m(arguments),!1))||this;return i._boundCandleBarClickEvent=function(e){return function(){return i.getWidget().getPane().getChart().getChartStore().executeAction(t.ActionType.OnCandleBarClick,e),!1}},i}return i(n,e),n.prototype.drawImp=function(e){var i=this,n=this.getWidget().getPane(),r=n.getId()===Ce,o=n.getChart().getChartStore(),a=this.getCandleBarOptions();if(null!==a){var s=a.type,l=a.styles,u=0,c=0;if(a.type===t.CandleType.Ohlc){var h=o.getBarSpace().gapBar;(u=Math.min(Math.max(Math.round(.2*h),1),8))>2&&u%2==1&&u--,c=Math.floor(c/2)}var p=n.getAxisComponent();this.eachChildren((function(n,o){var a,h=n.x,g=n.data,v=g.current,f=g.prev;if(E(v)){var y=v.open,m=v.high,_=v.low,x=v.close,b=l.compareRule===d.CurrentOpen?y:null!==(a=null==f?void 0:f.close)&&void 0!==a?a:x,C=[];x>b?(C[0]=l.upColor,C[1]=l.upBorderColor,C[2]=l.upWickColor):x<b?(C[0]=l.downColor,C[1]=l.downBorderColor,C[2]=l.downWickColor):(C[0]=l.noChangeColor,C[1]=l.noChangeBorderColor,C[2]=l.noChangeWickColor);var T=p.convertToPixel(y),w=p.convertToPixel(x),S=[T,w,p.convertToPixel(m),p.convertToPixel(_)];S.sort((function(t,e){return t-e}));var P=o.gapBar%2==0?1:0,I=[];switch(s){case t.CandleType.CandleSolid:I=i._createSolidBar(h,S,o,C,P);break;case t.CandleType.CandleStroke:I=i._createStrokeBar(h,S,o,C,P);break;case t.CandleType.CandleUpStroke:I=x>y?i._createStrokeBar(h,S,o,C,P):i._createSolidBar(h,S,o,C,P);break;case t.CandleType.CandleDownStroke:I=y>x?i._createStrokeBar(h,S,o,C,P):i._createSolidBar(h,S,o,C,P);break;case t.CandleType.Ohlc:I=[{name:"rect",attrs:[{x:h-c,y:S[0],width:u,height:S[3]-S[0]},{x:h-o.halfGapBar,y:T+u>S[3]?S[3]-u:T,width:o.halfGapBar,height:u},{x:h+c,y:w+u>S[3]?S[3]-u:w,width:o.halfGapBar-c,height:u}],styles:{color:C[0]}}]}I.forEach((function(t){var o,a=null;r&&(a={mouseClickEvent:i._boundCandleBarClickEvent(n)}),null===(o=i.createFigure(t,null!=a?a:void 0))||void 0===o||o.draw(e)}))}}))}},n.prototype.getCandleBarOptions=function(){var t=this.getWidget().getPane().getChart().getStyles().candle;return{type:t.type,styles:t.bar}},n.prototype._createSolidBar=function(e,i,n,r,o){return[{name:"rect",attrs:{x:e,y:i[0],width:1,height:i[3]-i[0]},styles:{color:r[2]}},{name:"rect",attrs:{x:e-n.halfGapBar,y:i[1],width:n.gapBar+o,height:Math.max(1,i[2]-i[1])},styles:{style:t.PolygonType.StrokeFill,color:r[0],borderColor:r[1]}}]},n.prototype._createStrokeBar=function(e,i,n,r,o){return[{name:"rect",attrs:[{x:e,y:i[0],width:1,height:i[1]-i[0]},{x:e,y:i[2],width:1,height:i[3]-i[2]}],styles:{color:r[2]}},{name:"rect",attrs:{x:e-n.halfGapBar,y:i[1],width:n.gapBar+o,height:Math.max(1,i[2]-i[1])},styles:{style:t.PolygonType.Stroke,borderColor:r[1]}}]},n}(ei),ni=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i(n,e),n.prototype.getCandleBarOptions=function(){var e,i,n=this.getWidget().getPane();if(!n.getAxisComponent().isInCandle()){var r=n.getChart().getChartStore(),o=r.getIndicatorsByPaneId(n.getId());try{for(var a=y(o),s=a.next();!s.done;s=a.next()){var l=s.value;if(l.shouldOhlc&&l.visible){var u=l.styles,c=r.getStyles().indicator,h=L(u,"ohlc.compareRule",c.ohlc.compareRule),d=L(u,"ohlc.upColor",c.ohlc.upColor),p=L(u,"ohlc.downColor",c.ohlc.downColor),g=L(u,"ohlc.noChangeColor",c.ohlc.noChangeColor);return{type:t.CandleType.Ohlc,styles:{compareRule:h,upColor:d,downColor:p,noChangeColor:g,upBorderColor:d,downBorderColor:p,noChangeBorderColor:g,upWickColor:d,downWickColor:p,noChangeWickColor:g}}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}}return null},n.prototype.drawImp=function(t){var i=this;e.prototype.drawImp.call(this,t);var n=this.getWidget(),r=n.getPane(),o=r.getChart(),a=n.getBounding(),s=o.getXAxisPane().getAxisComponent(),l=r.getAxisComponent(),u=o.getChartStore(),c=u.getIndicatorsByPaneId(r.getId()),h=u.getStyles().indicator;t.save(),c.forEach((function(e){if(e.visible){e.zLevel<0?t.globalCompositeOperation="destination-over":t.globalCompositeOperation="source-over";var n=!1;if(null!==e.draw&&(t.save(),n=e.draw({ctx:t,chart:o,indicator:e,bounding:a,xAxis:s,yAxis:l}),t.restore()),!n){var r=e.result,u=[];i.eachChildren((function(n,o){var c,d,p,g=o.halfGapBar,v=n.dataIndex,f=n.x,y=s.convertToPixel(v-1),m=s.convertToPixel(v+1),_=null!==(c=r[v-1])&&void 0!==c?c:null,x=null!==(d=r[v])&&void 0!==d?d:null,b=null!==(p=r[v+1])&&void 0!==p?p:null,C={x:y},T={x:f},w={x:m};e.figures.forEach((function(t){var e=t.key,i=null==_?void 0:_[e];S(i)&&(C[e]=l.convertToPixel(i));var n=null==x?void 0:x[e];S(n)&&(T[e]=l.convertToPixel(n));var r=null==b?void 0:b[e];S(r)&&(w[e]=l.convertToPixel(r))})),J(e,v,h,(function(e,n,r){var c,h,d;if(E(null==x?void 0:x[e.key])){var p=T[e.key],v=null===(c=e.attrs)||void 0===c?void 0:c.call(e,{data:{prev:_,current:x,next:b},coordinate:{prev:C,current:T,next:w},bounding:a,barSpace:o,xAxis:s,yAxis:l});if(!E(v))switch(e.type){case"circle":v={x:f,y:p,r:Math.max(1,g)};break;case"rect":case"bar":var y=null!==(h=e.baseValue)&&void 0!==h?h:l.getRange().from,m=l.convertToPixel(y),P=Math.abs(m-p);y!==(null==x?void 0:x[e.key])&&(P=Math.max(1,P));v={x:f-g,y:p>m?m:p,width:Math.max(1,2*g),height:P};break;case"line":E(u[r])||(u[r]=[]),S(T[e.key])&&S(w[e.key])&&u[r].push({coordinates:[{x:T.x,y:T[e.key]},{x:w.x,y:w[e.key]}],styles:n})}var I=e.type;E(v)&&"line"!==I&&(null===(d=i.createFigure({name:"bar"===I?"rect":I,attrs:v,styles:n}))||void 0===d||d.draw(t))}}))})),u.forEach((function(e){var n,r,o,a;if(e.length>1){for(var s=[{coordinates:[e[0].coordinates[0],e[0].coordinates[1]],styles:e[0].styles}],l=1;l<e.length;l++){var u=s[s.length-1],c=e[l],h=u.coordinates[u.coordinates.length-1];h.x===c.coordinates[0].x&&h.y===c.coordinates[0].y&&u.styles.style===c.styles.style&&u.styles.color===c.styles.color&&u.styles.size===c.styles.size&&u.styles.smooth===c.styles.smooth&&(null===(n=u.styles.dashedValue)||void 0===n?void 0:n[0])===(null===(r=c.styles.dashedValue)||void 0===r?void 0:r[0])&&(null===(o=u.styles.dashedValue)||void 0===o?void 0:o[1])===(null===(a=c.styles.dashedValue)||void 0===a?void 0:a[1])?u.coordinates.push(c.coordinates[1]):s.push({coordinates:[c.coordinates[0],c.coordinates[1]],styles:c.styles})}s.forEach((function(e){var n,r=e.coordinates,o=e.styles;null===(n=i.createFigure({name:"line",attrs:{coordinates:r},styles:o}))||void 0===n||n.draw(t)}))}}))}}})),t.restore()},n}(ii),ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane(),n=e.getBounding(),r=e.getPane().getChart().getChartStore(),o=r.getCrosshair(),a=r.getStyles().crosshair;if(I(o.paneId)&&a.show){if(o.paneId===i.getId()){var s=o.y;this._drawLine(t,[{x:0,y:s},{x:n.width,y:s}],a.horizontal)}var l=o.realX;this._drawLine(t,[{x:l,y:0},{x:l,y:n.height}],a.vertical)}},e.prototype._drawLine=function(t,e,i){var n;if(i.show){var r=i.line;r.show&&(null===(n=this.createFigure({name:"line",attrs:{coordinates:e},styles:r}))||void 0===n||n.draw(t))}},e}($e),oi=function(e){function n(){var i=e.apply(this,_([],m(arguments),!1))||this;return i._boundFeatureClickEvent=function(e){return function(){var n,r=i.getWidget().getPane(),o=e.indicator,a=g(e,["indicator"]);return E(o)?null===(n=o.onClick)||void 0===n||n.call(o,p({target:j.Feature,chart:r.getChart(),indicator:o},a)):r.getChart().getChartStore().executeAction(t.ActionType.OnCandleTooltipFeatureClick,e),!0}},i._boundFeatureMouseMoveEvent=function(t){return function(){return i.getWidget().getPane().getChart().getChartStore().setActiveTooltipFeatureInfo(t),!0}},i}return i(n,e),n.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane().getChart().getChartStore();if(E(i.getCrosshair().kLineData)){var n=e.getBounding(),r=i.getStyles().indicator.tooltip,o=r.offsetLeft,a=r.offsetTop,s=r.offsetRight;this.drawIndicatorTooltip(t,o,a,n.width-s)}},n.prototype.drawIndicatorTooltip=function(t,e,i,n){var r=this,o=this.getWidget().getPane(),a=o.getChart().getChartStore(),s=a.getStyles().indicator.tooltip;if(this.isDrawTooltip(a.getCrosshair(),s)){var l=a.getIndicatorsByPaneId(o.getId()),u=s.text;l.forEach((function(o){var a=0,l={x:e,y:i},c=r.getIndicatorTooltipData(o),h=c.name,d=c.calcParamsText,p=c.legends,g=c.features,v=h.length>0,f=p.length>0;if(v||f){var y=m(r.classifyTooltipFeatures(g),3),_=y[0],x=y[1],b=y[2];if(a=r.drawStandardTooltipFeatures(t,_,l,o,e,a,n),v){var C=h;d.length>0&&(C="".concat(C).concat(d)),a=r.drawStandardTooltipLegends(t,[{title:{text:"",color:u.color},value:{text:C,color:u.color}}],l,e,a,n,u)}a=r.drawStandardTooltipFeatures(t,x,l,o,e,a,n),f&&(a=r.drawStandardTooltipLegends(t,p,l,e,a,n,s.text)),a=r.drawStandardTooltipFeatures(t,b,l,o,e,a,n),i=l.y+a}}))}return i},n.prototype.drawStandardTooltipFeatures=function(e,i,n,r,o,a,s){var l=this;if(i.length>0){var u=0,c=0;i.forEach((function(i){var n=i.marginLeft,r=void 0===n?0:n,o=i.marginTop,a=void 0===o?0:o,s=i.marginRight,l=void 0===s?0:s,h=i.marginBottom,d=void 0===h?0:h,p=i.paddingLeft,g=void 0===p?0:p,v=i.paddingTop,f=void 0===v?0:v,y=i.paddingRight,m=void 0===y?0:y,_=i.paddingBottom,x=void 0===_?0:_,b=i.size,C=void 0===b?0:b,T=i.type,w=i.iconFont,S=0;T===t.TooltipFeatureType.IconFont?(e.font=U(C,"normal",w.family),S=e.measureText(w.content).width):S=C,u+=r+g+S+m+l,c=Math.max(c,a+f+C+x+d)})),n.x+u>s?(n.x=o,n.y+=a,a=c):a=Math.max(a,c);var h=this.getWidget().getPane(),d=h.getId(),p=h.getChart().getChartStore().getActiveTooltipFeatureInfo();i.forEach((function(i){var o,a,s,u,c=i.marginLeft,h=void 0===c?0:c,g=i.marginTop,v=void 0===g?0:g,f=i.marginRight,y=void 0===f?0:f,m=i.paddingLeft,_=void 0===m?0:m,x=i.paddingTop,b=void 0===x?0:x,C=i.paddingRight,T=void 0===C?0:C,w=i.paddingBottom,S=void 0===w?0:w,E=i.backgroundColor,P=i.activeBackgroundColor,I=i.borderRadius,M=i.size,k=void 0===M?0:M,D=i.color,A=i.activeColor,F=i.type,R=i.iconFont,B=i.path,L=(null==p?void 0:p.paneId)===d&&(null===(o=p.indicator)||void 0===o?void 0:o.id)===(null==r?void 0:r.id)&&p.feature.id===i.id,O=0,W={mouseClickEvent:l._boundFeatureClickEvent({paneId:d,indicator:r,feature:i}),mouseMoveEvent:l._boundFeatureMouseMoveEvent({paneId:d,indicator:r,feature:i})},V=L&&null!=A?A:D,N=L&&null!=P?P:E;F===t.TooltipFeatureType.IconFont?(null===(a=l.createFigure({name:"text",attrs:{text:R.content,x:n.x+h,y:n.y+v},styles:{paddingLeft:_,paddingTop:b,paddingRight:T,paddingBottom:S,borderRadius:I,size:k,family:R.family,color:V,backgroundColor:N}},W))||void 0===a||a.draw(e),O=e.measureText(R.content).width):(null===(s=l.createFigure({name:"rect",attrs:{x:n.x+h,y:n.y+v,width:k,height:k},styles:{paddingLeft:_,paddingTop:b,paddingRight:T,paddingBottom:S,color:N}},W))||void 0===s||s.draw(e),null===(u=l.createFigure({name:"path",attrs:{path:B.path,x:n.x+h+_,y:n.y+v+b,width:k,height:k},styles:{style:B.style,lineWidth:B.lineWidth,color:V}}))||void 0===u||u.draw(e),O=k),n.x+=h+_+O+T+y}))}return a},n.prototype.drawStandardTooltipLegends=function(t,e,i,n,r,o,a){var s=this;if(e.length>0){var l=a.marginLeft,u=a.marginTop,c=a.marginRight,h=a.marginBottom,d=a.size,p=a.family,g=a.weight;t.font=U(d,g,p),e.forEach((function(e){var a,v,f=e.title,y=e.value,m=t.measureText(f.text).width,_=m+t.measureText(y.text).width,x=u+d+h;i.x+l+_+c>o?(i.x=n,i.y+=r,r=x):r=Math.max(r,x),f.text.length>0&&(null===(a=s.createFigure({name:"text",attrs:{x:i.x+l,y:i.y+u,text:f.text},styles:{color:f.color,size:d,family:p,weight:g}}))||void 0===a||a.draw(t)),null===(v=s.createFigure({name:"text",attrs:{x:i.x+l+m,y:i.y+u,text:y.text},styles:{color:y.color,size:d,family:p,weight:g}}))||void 0===v||v.draw(t),i.x+=l+_+c}))}return r},n.prototype.isDrawTooltip=function(e,i){var n=i.showRule;return n===t.TooltipShowRule.Always||n===t.TooltipShowRule.FollowCross&&I(e.paneId)},n.prototype.getIndicatorTooltipData=function(t){var e,i,n=this.getWidget().getPane().getChart().getChartStore(),r=n.getStyles().indicator,o=r.tooltip,a=o.showName?t.shortName:"",s="";if(o.showParams){var l=t.calcParams;l.length>0&&(s="(".concat(l.join(","),")"))}var u={name:a,calcParamsText:s,legends:[],features:o.features},c=n.getCrosshair().dataIndex,h=t.result,d=n.getCustomApi(),p=n.getDecimalFold(),g=n.getThousandsSeparator(),v=[];if(t.visible){var f=null!==(i=null!==(e=h[c])&&void 0!==e?e:h[c-1])&&void 0!==i?i:{};J(t,c,r,(function(e,i){if(I(e.title)){var n=i.color,r=f[e.key];S(r)&&(r=V(r,t.precision),t.shouldFormatBigNumber&&(r=d.formatBigNumber(r)),r=p.format(g.format(r))),v.push({title:{text:e.title,color:n},value:{text:null!=r?r:o.defaultValue,color:n}})}})),u.legends=v}if(T(t.createTooltipDataSource)){var y=this.getWidget(),m=y.getPane(),_=m.getChart(),x=t.createTooltipDataSource({chart:_,indicator:t,crosshair:n.getCrosshair(),bounding:y.getBounding(),xAxis:m.getChart().getXAxisPane().getAxisComponent(),yAxis:m.getAxisComponent()}),b=x.name,C=x.calcParamsText,P=x.legends,M=x.features;if(I(b)&&o.showName&&(u.name=b),I(C)&&o.showParams&&(u.calcParamsText=C),E(M)&&(u.features=M),E(P)&&t.visible){var k=[],D=r.tooltip.text.color;P.forEach((function(t){var e={text:"",color:D};w(t.title)?e=t.title:e.text=t.title;var i={text:"",color:D};w(t.value)?i=t.value:i.text=t.value,S(Number(i.text))&&(i.text=p.format(g.format(i.text))),k.push({title:e,value:i})})),u.legends=k}}return u},n.prototype.classifyTooltipFeatures=function(e){var i=[],n=[],r=[];return e.forEach((function(e){switch(e.position){case t.TooltipFeaturePosition.Left:i.push(e);break;case t.TooltipFeaturePosition.Middle:n.push(e);break;case t.TooltipFeaturePosition.Right:r.push(e)}})),[i,n,r]},n}($e),ai=function(e){function n(t){var i=e.call(this,t)||this;return i._initEvent(),i}return i(n,e),n.prototype._initEvent=function(){var t=this,e=this.getWidget().getPane(),i=e.getId(),n=e.getChart(),r=n.getChartStore();this.registerEvent("mouseMoveEvent",(function(e){var o,a=r.getProgressOverlayInfo();if(null!==a){var s=a.overlay,l=a.paneId;s.isStart()&&(r.updateProgressOverlayInfo(i),l=i);var u=s.points.length-1;return s.isDrawing()&&l===i&&(s.eventMoveForDrawing(t._coordinateToPoint(s,e)),null===(o=s.onDrawing)||void 0===o||o.call(s,p({chart:n,overlay:s},e))),t._figureMouseMoveEvent(s,1,u,{key:"".concat(nt,"point_").concat(u),type:"circle",attrs:{}})(e)}return r.setHoverOverlayInfo({paneId:i,overlay:null,figureType:0,figureIndex:-1,figure:null},e),!1})).registerEvent("mouseClickEvent",(function(e){var o,a,s=r.getProgressOverlayInfo();if(null!==s){var l=s.overlay,u=s.paneId;l.isStart()&&(r.updateProgressOverlayInfo(i,!0),u=i);var c=l.points.length-1;return l.isDrawing()&&u===i&&(l.eventMoveForDrawing(t._coordinateToPoint(l,e)),null===(o=l.onDrawing)||void 0===o||o.call(l,p({chart:n,overlay:l},e)),l.nextStep(),l.isDrawing()||(r.progressOverlayComplete(),null===(a=l.onDrawEnd)||void 0===a||a.call(l,p({chart:n,overlay:l},e)))),t._figureMouseClickEvent(l,1,c,{key:"".concat(nt,"point_").concat(c),type:"circle",attrs:{}})(e)}return r.setClickOverlayInfo({paneId:i,overlay:null,figureType:0,figureIndex:-1,figure:null},e),!1})).registerEvent("mouseDoubleClickEvent",(function(e){var o,a=r.getProgressOverlayInfo();if(null!==a){var s=a.overlay,l=a.paneId;s.isDrawing()&&l===i&&(s.forceComplete(),s.isDrawing()||(r.progressOverlayComplete(),null===(o=s.onDrawEnd)||void 0===o||o.call(s,p({chart:n,overlay:s},e))));var u=s.points.length-1;return t._figureMouseClickEvent(s,1,u,{key:"".concat(nt,"point_").concat(u),type:"circle",attrs:{}})(e)}return!1})).registerEvent("mouseRightClickEvent",(function(e){var i=r.getProgressOverlayInfo();if(null!==i){var n=i.overlay;if(n.isDrawing()){var o=n.points.length-1;return t._figureMouseRightClickEvent(n,1,o,{key:"".concat(nt,"point_").concat(o),type:"circle",attrs:{}})(e)}}return!1})).registerEvent("mouseUpEvent",(function(t){var e,o=r.getPressedOverlayInfo(),a=o.overlay,s=o.figure;return null!==a&&et("onPressedMoveEnd",s)&&(null===(e=a.onPressedMoveEnd)||void 0===e||e.call(a,p({chart:n,overlay:a,figure:null!=s?s:void 0},t))),r.setPressedOverlayInfo({paneId:i,overlay:null,figureType:0,figureIndex:-1,figure:null}),!1})).registerEvent("pressedMouseMoveEvent",(function(e){var i,o,a=r.getPressedOverlayInfo(),s=a.overlay,l=a.figureType,u=a.figureIndex,c=a.figure;if(null!==s&&et("onPressedMoving",c)){if(!(s.lock||null!==(o=null===(i=s.onPressedMoving)||void 0===i?void 0:i.call(s,p({chart:n,overlay:s,figure:null!=c?c:void 0},e)))&&void 0!==o&&o)){var h=t._coordinateToPoint(s,e);1===l?s.eventPressedPointMove(h,u):s.eventPressedOtherMove(h,t.getWidget().getPane().getChart().getChartStore())}return!0}return!1}))},n.prototype._createFigureEvents=function(t,e,i,n){return t.isDrawing()?null:{mouseMoveEvent:this._figureMouseMoveEvent(t,e,i,n),mouseDownEvent:this._figureMouseDownEvent(t,e,i,n),mouseClickEvent:this._figureMouseClickEvent(t,e,i,n),mouseRightClickEvent:this._figureMouseRightClickEvent(t,e,i,n),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(t,e,i,n)}},n.prototype._figureMouseMoveEvent=function(t,e,i,n){var r=this;return function(o){var a=r.getWidget().getPane();return a.getChart().getChartStore().setHoverOverlayInfo({paneId:a.getId(),overlay:t,figureType:e,figure:n,figureIndex:i},o),et("onMouseEnter",n)&&!t.isDrawing()}},n.prototype._figureMouseDownEvent=function(t,e,i,n){var r=this;return function(o){var a,s=r.getWidget().getPane(),l=s.getId();return t.startPressedMove(r._coordinateToPoint(t,o)),!!et("onPressedMoveStart",n)&&(null===(a=t.onPressedMoveStart)||void 0===a||a.call(t,p({chart:s.getChart(),overlay:t,figure:n},o)),s.getChart().getChartStore().setPressedOverlayInfo({paneId:l,overlay:t,figureType:e,figureIndex:i,figure:n}),!t.isDrawing())}},n.prototype._figureMouseClickEvent=function(t,e,i,n){var r=this;return function(o){var a=r.getWidget().getPane(),s=a.getId();return a.getChart().getChartStore().setClickOverlayInfo({paneId:s,overlay:t,figureType:e,figureIndex:i,figure:n},o),et("onClick",n)&&!t.isDrawing()}},n.prototype._figureMouseDoubleClickEvent=function(t,e,i,n){var r=this;return function(e){var i;return!!et("onDoubleClick",n)&&(null===(i=t.onDoubleClick)||void 0===i||i.call(t,p(p({},e),{chart:r.getWidget().getPane().getChart(),figure:n,overlay:t})),!t.isDrawing())}},n.prototype._figureMouseRightClickEvent=function(t,e,i,n){var r=this;return function(e){var i,o;return!!et("onRightClick",n)&&(null!==(o=null===(i=t.onRightClick)||void 0===i?void 0:i.call(t,p({chart:r.getWidget().getPane().getChart(),overlay:t,figure:n},e)))&&void 0!==o&&o||r.getWidget().getPane().getChart().getChartStore().removeOverlay(t),!t.isDrawing())}},n.prototype._coordinateToPoint=function(e,i){var n,r={},o=this.getWidget().getPane(),a=o.getChart(),s=o.getId(),l=a.getChartStore();if(this.coordinateToPointTimestampDataIndexFlag()){var u=a.getXAxisPane().getAxisComponent().convertFromPixel(i.x),c=null!==(n=l.dataIndexToTimestamp(u))&&void 0!==n?n:void 0;r.timestamp=c,r.dataIndex=u}if(this.coordinateToPointValueFlag()){var h=o.getAxisComponent(),d=h.convertFromPixel(i.y);if(e.mode!==t.OverlayMode.Normal&&s===Ce&&S(r.dataIndex)){var p=l.getDataByDataIndex(r.dataIndex);if(null!==p){var g=e.modeSensitivity;if(d>p.high)if(e.mode===t.OverlayMode.WeakMagnet){var v=h.convertToPixel(p.high);d<h.convertFromPixel(v-g)&&(d=p.high)}else d=p.high;else if(d<p.low)if(e.mode===t.OverlayMode.WeakMagnet){var f=h.convertToPixel(p.low);d>h.convertFromPixel(f-g)&&(d=p.low)}else d=p.low;else{var y=Math.max(p.open,p.close),m=Math.min(p.open,p.close);d=d>y?d-y<p.high-d?y:p.high:d<m?d-p.low<m-d?p.low:m:y-d<d-m?y:m}}}r.value=d}return r},n.prototype.coordinateToPointValueFlag=function(){return!0},n.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},n.prototype.dispatchEvent=function(t,i,n){return this.getWidget().getPane().getChart().getChartStore().isOverlayDrawing()?this.onEvent(t,i,n):e.prototype.dispatchEvent.call(this,t,i,n)},n.prototype.checkEventOn=function(){return!0},n.prototype.drawImp=function(t){var e=this;this.getCompleteOverlays().forEach((function(i){i.visible&&e._drawOverlay(t,i)}));var i=this.getProgressOverlay();E(i)&&i.visible&&this._drawOverlay(t,i)},n.prototype._drawOverlay=function(t,e){var i=e.points,n=this.getWidget().getPane(),r=n.getChart(),o=r.getChartStore(),a=n.getAxisComponent(),s=r.getXAxisPane().getAxisComponent(),l=i.map((function(t){var e,i=null;S(t.timestamp)&&(i=o.timestampToDataIndex(t.timestamp));var n={x:0,y:0};return S(i)&&(n.x=s.convertToPixel(i)),S(t.value)&&(n.y=null!==(e=null==a?void 0:a.convertToPixel(t.value))&&void 0!==e?e:0),n}));if(l.length>0){var u=[].concat(this.getFigures(e,l));this.drawFigures(t,e,u)}this.drawDefaultFigures(t,e,l)},n.prototype.drawFigures=function(t,e,i){var n=this,r=this.getWidget().getPane().getChart().getStyles().overlay;i.forEach((function(i,o){var a=i.type,s=i.styles,l=i.attrs;[].concat(l).forEach((function(l){var u,c,h=n._createFigureEvents(e,2,o,i),d=p(p(p({},r[a]),null===(u=e.styles)||void 0===u?void 0:u[a]),s);null===(c=n.createFigure({name:a,attrs:l,styles:d},null!=h?h:void 0))||void 0===c||c.draw(t)}))}))},n.prototype.getCompleteOverlays=function(){var t=this.getWidget().getPane();return t.getChart().getChartStore().getOverlaysByPaneId(t.getId())},n.prototype.getProgressOverlay=function(){var t=this.getWidget().getPane(),e=t.getChart().getChartStore().getProgressOverlayInfo();return E(e)&&e.paneId===t.getId()?e.overlay:null},n.prototype.getFigures=function(t,e){var i,n,r=this.getWidget(),o=r.getPane(),a=o.getChart(),s=o.getAxisComponent(),l=a.getXAxisPane().getAxisComponent(),u=r.getBounding();return null!==(n=null===(i=t.createPointFigures)||void 0===i?void 0:i.call(t,{chart:a,overlay:t,coordinates:e,bounding:u,xAxis:l,yAxis:s}))&&void 0!==n?n:[]},n.prototype.drawDefaultFigures=function(t,e,i){var n,r,o=this;if(e.needDefaultPointFigure){var a=this.getWidget().getPane().getChart().getChartStore(),s=a.getHoverOverlayInfo(),l=a.getClickOverlayInfo();if((null===(n=s.overlay)||void 0===n?void 0:n.id)===e.id&&0!==s.figureType||(null===(r=l.overlay)||void 0===r?void 0:r.id)===e.id&&0!==l.figureType){var u=a.getStyles().overlay,c=e.styles,h=p(p({},u.point),null==c?void 0:c.point);i.forEach((function(i,n){var r,a,l,u,c,d=i.x,p=i.y,g=h.radius,v=h.color,f=h.borderColor,y=h.borderSize;(null===(r=s.overlay)||void 0===r?void 0:r.id)===e.id&&1===s.figureType&&(null===(a=s.figure)||void 0===a?void 0:a.key)==="".concat(nt,"point_").concat(n)&&(g=h.activeRadius,v=h.activeColor,f=h.activeBorderColor,y=h.activeBorderSize),null===(u=o.createFigure({name:"circle",attrs:{x:d,y:p,r:g+y},styles:{color:f}},null!==(l=o._createFigureEvents(e,1,n,{key:"".concat(nt,"point_").concat(n),type:"circle",attrs:{x:d,y:p,r:g+y},styles:{color:f}}))&&void 0!==l?l:void 0))||void 0===u||u.draw(t),null===(c=o.createFigure({name:"circle",attrs:{x:d,y:p,r:g},styles:{color:v}}))||void 0===c||c.draw(t)}))}}},n}($e),si=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._gridView=new ti(n),n._indicatorView=new ni(n),n._crosshairLineView=new ri(n),n._tooltipView=n.createTooltipView(),n._overlayView=new ai(n),n.addChild(n._tooltipView),n.addChild(n._overlayView),n.getContainer().style.cursor="crosshair",n}return i(e,t),e.prototype.getName=function(){return Me},e.prototype.updateMain=function(t){"minimize"!==this.getPane().getOptions().state&&(this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t))},e.prototype.createTooltipView=function(){return new oi(this)},e.prototype.updateMainContent=function(t){},e.prototype.updateOverlay=function(t){"minimize"!==this.getPane().getOptions().state&&(this._overlayView.draw(t),this._crosshairLineView.draw(t)),this._tooltipView.draw(t)},e}(Be),li=function(t){function e(){var e=t.apply(this,_([],m(arguments),!1))||this;return e._ripplePoint=e.createFigure({name:"circle",attrs:{x:0,y:0,r:0},styles:{style:"fill"}}),e._animationFrameTime=0,e._animation=new ht({iterationCount:1/0}).doFrame((function(t){e._animationFrameTime=t;var i=e.getWidget().getPane();i.getChart().updatePane(0,i.getId())})),e}return i(e,t),e.prototype.drawImp=function(t){var e,i,n,r=this.getWidget(),o=r.getPane(),a=o.getChart(),s=a.getDataList().length-1,l=r.getBounding(),u=o.getAxisComponent(),c=a.getStyles().candle.area,h=[],d=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,g=null;if(this.eachChildren((function(t){var e=t.x,i=t.data.current,n=null==i?void 0:i[c.value];if(S(n)){var r=u.convertToPixel(n);p===Number.MIN_SAFE_INTEGER&&(p=e),h.push({x:e,y:r}),d=Math.min(d,r),t.dataIndex===s&&(g={x:e,y:r})}})),h.length>0){null===(e=this.createFigure({name:"line",attrs:{coordinates:h},styles:{color:c.lineColor,size:c.lineSize,smooth:c.smooth}}))||void 0===e||e.draw(t);var v=c.backgroundColor,f="";if(C(v)){var y=t.createLinearGradient(0,l.height,0,d);try{v.forEach((function(t){var e=t.offset,i=t.color;y.addColorStop(e,i)}))}catch(t){}f=y}else f=v;t.fillStyle=f,t.beginPath(),t.moveTo(p,l.height),t.lineTo(h[0].x,h[0].y),se(t,h,c.smooth),t.lineTo(h[h.length-1].x,l.height),t.closePath(),t.fill()}var m=c.point;if(m.show&&E(g)){null===(i=this.createFigure({name:"circle",attrs:{x:g.x,y:g.y,r:m.radius},styles:{style:"fill",color:m.color}}))||void 0===i||i.draw(t);var _=m.rippleRadius;m.animation&&(_=m.radius+this._animationFrameTime/m.animationDuration*(m.rippleRadius-m.radius),this._animation.setDuration(m.animationDuration).start()),null===(n=this._ripplePoint)||void 0===n||n.setAttrs({x:g.x,y:g.y,r:_}).setStyles({style:"fill",color:m.rippleColor}).draw(t)}else this.stopAnimation()},e.prototype.stopAnimation=function(){this._animation.stop()},e}(ei),ui=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e=this.getWidget().getPane(),i=e.getChart().getChartStore(),n=i.getStyles().candle.priceMark,r=n.high,o=n.low;if(n.show&&(r.show||o.show)){var a=i.getVisibleRangeHighLowPrice(),s=i.getPrecision(),l=e.getAxisComponent(),u=a[0],c=u.price,h=u.x,d=a[1],p=d.price,g=d.x,v=l.convertToPixel(c),f=l.convertToPixel(p),y=i.getDecimalFold(),m=i.getThousandsSeparator();r.show&&c!==Number.MIN_SAFE_INTEGER&&this._drawMark(t,y.format(m.format(V(c,s.price))),{x:h,y:v},v<f?[-2,-5]:[2,5],r),o.show&&p!==Number.MAX_SAFE_INTEGER&&this._drawMark(t,y.format(m.format(V(p,s.price))),{x:g,y:f},v<f?[2,5]:[-2,-5],o)}},e.prototype._drawMark=function(t,e,i,n,r){var o,a,s,l=i.x,u=i.y+n[0];null===(o=this.createFigure({name:"line",attrs:{coordinates:[{x:l-2,y:u+n[0]},{x:l,y:u},{x:l+2,y:u+n[0]}]},styles:{color:r.color}}))||void 0===o||o.draw(t);var c=0,h=0,d="left";l>this.getWidget().getBounding().width/2?(h=(c=l-5)-r.textOffset,d="right"):(d="left",h=(c=l+5)+r.textOffset);var p=u+n[1];null===(a=this.createFigure({name:"line",attrs:{coordinates:[{x:l,y:u},{x:l,y:p},{x:c,y:p}]},styles:{color:r.color}}))||void 0===a||a.draw(t),null===(s=this.createFigure({name:"text",attrs:{x:h,y:p,text:e,align:d,baseline:"middle"},styles:{color:r.color,size:r.textSize,family:r.textFamily,weight:r.textWeight}}))||void 0===s||s.draw(t)},e}($e),ci=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i,n,r=this.getWidget(),o=r.getPane(),a=r.getBounding(),s=o.getChart().getChartStore(),l=s.getStyles().candle.priceMark,u=l.last,c=u.line;if(l.show&&u.show&&c.show){var h=o.getAxisComponent(),p=s.getDataList(),g=p[p.length-1];if(E(g)){var v=g.close,f=g.open,y=u.compareRule===d.CurrentOpen?f:null!==(i=null===(e=p[p.length-2])||void 0===e?void 0:e.close)&&void 0!==i?i:v,m=h.convertToNicePixel(v),_="";_=v>y?u.upColor:v<y?u.downColor:u.noChangeColor,null===(n=this.createFigure({name:"line",attrs:{coordinates:[{x:0,y:m},{x:a.width,y:m}]},styles:{style:c.style,color:_,size:c.size,dashedValue:c.dashedValue}}))||void 0===n||n.draw(t)}}},e}($e);!function(t){t.Left="left",t.Right="right"}(Je||(Je={}));var hi=function(){function t(t){this.scrollZoomEnabled=!0,this._range={from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0,displayFrom:0,displayTo:0,displayRange:0},this._prevRange={from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0,displayFrom:0,displayTo:0,displayRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return t.prototype.getParent=function(){return this._parent},t.prototype.buildTicks=function(t){return this._autoCalcTickFlag&&(this._range=this.createRangeImp()),!(this._prevRange.from===this._range.from&&this._prevRange.to===this._range.to&&!t)&&(this._prevRange=this._range,this._ticks=this.createTicksImp(),!0)},t.prototype.getTicks=function(){return this._ticks},t.prototype.setRange=function(t){this._autoCalcTickFlag=!1,this._range=t},t.prototype.getRange=function(){return this._range},t.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},t.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},t}(),di={"zh-CN":{time:"时间：",open:"开：",high:"高：",low:"低：",close:"收：",volume:"成交量：",turnover:"成交额：",change:"涨幅："},"en-US":{time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: "}};var pi=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i(n,e),n.prototype.drawImp=function(e){var i=this.getWidget(),n=i.getPane().getChart().getChartStore(),r=n.getCrosshair();if(E(r.kLineData)){var o=i.getBounding(),a=n.getStyles(),s=a.candle,l=a.indicator;if(s.tooltip.showType===t.TooltipShowType.Rect&&l.tooltip.showType===t.TooltipShowType.Rect){var u=this.isDrawTooltip(r,s.tooltip),c=this.isDrawTooltip(r,l.tooltip);this._drawRectTooltip(e,u,c,s.tooltip.offsetTop)}else if(s.tooltip.showType===t.TooltipShowType.Standard&&l.tooltip.showType===t.TooltipShowType.Standard){var h=s.tooltip,d=h.offsetLeft,p=h.offsetTop,g=h.offsetRight,v=o.width-g,f=this._drawCandleStandardTooltip(e,d,p,v);this.drawIndicatorTooltip(e,d,f,v)}else if(s.tooltip.showType===t.TooltipShowType.Rect&&l.tooltip.showType===t.TooltipShowType.Standard){var y=s.tooltip,m=(d=y.offsetLeft,p=y.offsetTop,g=y.offsetRight,v=o.width-g,this.drawIndicatorTooltip(e,d,p,v));u=this.isDrawTooltip(r,s.tooltip);this._drawRectTooltip(e,u,!1,m)}else{var _=s.tooltip,x=(d=_.offsetLeft,p=_.offsetTop,g=_.offsetRight,v=o.width-g,this._drawCandleStandardTooltip(e,d,p,v));c=this.isDrawTooltip(r,l.tooltip);this._drawRectTooltip(e,!1,c,x)}}},n.prototype._drawCandleStandardTooltip=function(t,e,i,n){var r=this.getWidget().getPane().getChart().getChartStore(),o=r.getStyles().candle.tooltip,a=o.text,s=0,l={x:e,y:i},u=r.getCrosshair();if(this.isDrawTooltip(u,o)){var c=this._getCandleTooltipLegends(),h=m(this.classifyTooltipFeatures(o.features),3),d=h[0],p=h[1],g=h[2];s=this.drawStandardTooltipFeatures(t,d,l,null,e,s,n),s=this.drawStandardTooltipFeatures(t,p,l,null,e,s,n),c.length>0&&(s=this.drawStandardTooltipLegends(t,c,l,e,s,n,a)),s=this.drawStandardTooltipFeatures(t,g,l,null,e,s,n)}return l.y+s},n.prototype._drawRectTooltip=function(e,i,n,r){var o,a,s=this,l=this.getWidget(),u=l.getPane(),c=u.getChart().getChartStore(),h=c.getStyles(),d=h.candle,p=h.indicator,g=d.tooltip,v=p.tooltip;if(i||n){var f=this._getCandleTooltipLegends(),y=g.offsetLeft,m=g.offsetTop,_=g.offsetRight,x=g.offsetBottom,b=g.text,C=b.marginLeft,T=b.marginRight,w=b.marginTop,S=b.marginBottom,E=b.size,P=b.weight,I=b.family,M=g.rect,k=M.position,D=M.paddingLeft,A=M.paddingRight,F=M.paddingTop,R=M.paddingBottom,B=M.offsetLeft,L=M.offsetRight,O=M.offsetTop,W=M.offsetBottom,V=M.borderSize,N=M.borderRadius,z=M.borderColor,Y=M.color,H=0,X=0,G=0;i&&(e.font=U(E,P,I),f.forEach((function(t){var i=t.title,n=t.value,r="".concat(i.text).concat(n.text),o=e.measureText(r).width+C+T;H=Math.max(H,o)})),G+=(S+w+E)*f.length);var Z=v.text,q=Z.marginLeft,j=Z.marginRight,Q=Z.marginTop,K=Z.marginBottom,J=Z.size,$=Z.weight,tt=Z.family,et=[];if(n){var it=c.getIndicatorsByPaneId(u.getId());e.font=U(J,$,tt),it.forEach((function(t){var i=s.getIndicatorTooltipData(t).legends;et.push(i),i.forEach((function(t){var i=t.title,n=t.value,r="".concat(i.text).concat(n.text),o=e.measureText(r).width+q+j;H=Math.max(H,o),G+=Q+K+J}))}))}if(0!==(X+=H)&&0!==G){var nt=c.getCrosshair(),rt=l.getBounding(),ot=u.getYAxisWidget().getBounding();X+=2*V+D+A,G+=2*V+F+R;var at=rt.width/2,st=k===t.CandleTooltipRectPosition.Pointer&&nt.paneId===Ce,lt=(null!==(o=nt.realX)&&void 0!==o?o:0)>at,ut=0;if(st){var ct=nt.realX;ut=lt?ct-L-X:ct+B}else{var ht=this.getWidget().getPane().getAxisComponent();lt?(ut=B+y,ht.inside&&ht.position===Je.Left&&(ut+=ot.width)):(ut=rt.width-L-X-_,ht.inside&&ht.position===Je.Right&&(ut-=ot.width))}var dt=r+O;if(st)(dt=nt.y-G/2)+G>rt.height-W-x&&(dt=rt.height-W-G-x),dt<r+O&&(dt=r+O+m);null===(a=this.createFigure({name:"rect",attrs:{x:ut,y:dt,width:X,height:G},styles:{style:t.PolygonType.StrokeFill,color:Y,borderColor:z,borderSize:V,borderRadius:N}}))||void 0===a||a.draw(e);var pt=ut+V+D+C,gt=dt+V+F;if(i&&f.forEach((function(t){var i,n;gt+=w;var r=t.title;null===(i=s.createFigure({name:"text",attrs:{x:pt,y:gt,text:r.text},styles:{color:r.color,size:E,family:I,weight:P}}))||void 0===i||i.draw(e);var o=t.value;null===(n=s.createFigure({name:"text",attrs:{x:ut+X-V-T-A,y:gt,text:o.text,align:"right"},styles:{color:o.color,size:E,family:I,weight:P}}))||void 0===n||n.draw(e),gt+=E+S})),n){var vt=ut+V+D+q;et.forEach((function(t){t.forEach((function(t){var i,n;gt+=Q;var r=t.title,o=t.value;null===(i=s.createFigure({name:"text",attrs:{x:vt,y:gt,text:r.text},styles:{color:r.color,size:J,family:tt,weight:$}}))||void 0===i||i.draw(e),null===(n=s.createFigure({name:"text",attrs:{x:ut+X-V-j-A,y:gt,text:o.text,align:"right"},styles:{color:o.color,size:J,family:tt,weight:$}}))||void 0===n||n.draw(e),gt+=J+K}))}))}}}},n.prototype._getCandleTooltipLegends=function(){var e,i,n,r,o,a,s=this.getWidget().getPane().getChart().getChartStore(),l=s.getStyles().candle,u=s.getDataList(),c=s.getCustomApi(),h=s.getDecimalFold(),d=s.getThousandsSeparator(),g=s.getLocale(),v=s.getPrecision(),f=v.price,y=v.volume,m=null!==(e=s.getCrosshair().dataIndex)&&void 0!==e?e:0,_=l.tooltip,x=_.text.color,b=null!==(i=u[m-1])&&void 0!==i?i:null,C=u[m],S=null!==(n=null==b?void 0:b.close)&&void 0!==n?n:C.close,E=C.close-S,P={"{time}":c.formatDate(C.timestamp,"YYYY-MM-DD HH:mm",t.FormatDateType.Tooltip),"{open}":h.format(d.format(V(C.open,f))),"{high}":h.format(d.format(V(C.high,f))),"{low}":h.format(d.format(V(C.low,f))),"{close}":h.format(d.format(V(C.close,f))),"{volume}":h.format(d.format(c.formatBigNumber(V(null!==(r=C.volume)&&void 0!==r?r:_.defaultValue,y)))),"{turnover}":h.format(d.format(V(null!==(o=C.turnover)&&void 0!==o?o:_.defaultValue,f))),"{change}":0===S?_.defaultValue:"".concat(d.format(V(E/S*100)),"%")};return(T(_.custom)?_.custom({prev:b,current:C,next:null!==(a=u[m+1])&&void 0!==a?a:null},l):_.custom).map((function(t){var e,i=t.title,n=t.value,r={text:"",color:x};w(i)?r=p({},i):r.text=i,r.text=function(t,e){var i;return null!==(i=di[e][t])&&void 0!==i?i:t}(r.text,g);var o={text:_.defaultValue,color:x};w(n)?o=p({},n):o.text=n;var a=/{(\S*)}/.exec(o.text);if(null!==a&&a.length>1){var s="{".concat(a[1],"}");o.text=o.text.replace(s,null!==(e=P[s])&&void 0!==e?e:_.defaultValue),"{change}"===s&&(o.color=0===E?l.priceMark.last.noChangeColor:E>0?l.priceMark.last.upColor:l.priceMark.last.downColor)}return{title:r,value:o}}))},n}(oi),gi=function(e){function n(t,i){var n=e.call(this,t,i)||this;return n._candleBarView=new ii(n),n._candleAreaView=new li(n),n._candleHighLowPriceView=new ui(n),n._candleLastPriceLineView=new ci(n),n.addChild(n._candleBarView),n}return i(n,e),n.prototype.updateMainContent=function(e){this.getPane().getChart().getStyles().candle.type!==t.CandleType.Area?(this._candleBarView.draw(e),this._candleHighLowPriceView.draw(e),this._candleAreaView.stopAnimation()):this._candleAreaView.draw(e),this._candleLastPriceLineView.draw(e)},n.prototype.createTooltipView=function(){return new pi(this)},n}(si),vi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t,e){var i,n,r=this,o=this.getWidget(),a=o.getPane(),s=o.getBounding(),l=a.getAxisComponent(),u=this.getAxisStyles(a.getChart().getStyles());if(u.show&&(u.axisLine.show&&(null===(i=this.createFigure({name:"line",attrs:this.createAxisLine(s,u),styles:u.axisLine}))||void 0===i||i.draw(t)),!e[0])){var c=l.getTicks();if(u.tickLine.show)this.createTickLines(c,s,u).forEach((function(e){var i;null===(i=r.createFigure({name:"line",attrs:e,styles:u.tickLine}))||void 0===i||i.draw(t)}));if(u.tickText.show){var h=this.createTickTexts(c,s,u);null===(n=this.createFigure({name:"text",attrs:h,styles:u.tickText}))||void 0===n||n.draw(t)}}},e}($e),fi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getAxisStyles=function(t){return t.yAxis},e.prototype.createAxisLine=function(t,e){var i=this.getWidget().getPane().getAxisComponent(),n=e.axisLine.size,r=0;return{coordinates:[{x:r=i.isFromZero()?0:t.width-n,y:0},{x:r,y:t.height}]}},e.prototype.createTickLines=function(t,e,i){var n=this.getWidget().getPane().getAxisComponent(),r=i.axisLine,o=i.tickLine,a=0,s=0;return n.isFromZero()?(a=0,r.show&&(a+=r.size),s=a+o.length):(a=e.width,r.show&&(a-=r.size),s=a-o.length),t.map((function(t){return{coordinates:[{x:a,y:t.coord},{x:s,y:t.coord}]}}))},e.prototype.createTickTexts=function(t,e,i){var n=this.getWidget().getPane().getAxisComponent(),r=i.axisLine,o=i.tickLine,a=i.tickText,s=0;n.isFromZero()?(s=a.marginStart,r.show&&(s+=r.size),o.show&&(s+=o.length)):(s=e.width-a.marginEnd,r.show&&(s-=r.size),o.show&&(s-=o.length));var l=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return t.map((function(t){return{x:s,y:t.coord,text:t.text,align:l,baseline:"middle"}}))},e}(vi),yi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i,n,r=this.getWidget(),o=r.getPane(),a=r.getBounding(),s=o.getChart().getChartStore(),l=s.getStyles().candle.priceMark,u=l.last,c=u.text;if(l.show&&u.show&&c.show){var h=s.getPrecision(),g=o.getAxisComponent(),v=s.getDataList(),f=v[v.length-1];if(E(f)){var y=f.close,m=f.open,_=u.compareRule===d.CurrentOpen?m:null!==(i=null===(e=v[v.length-2])||void 0===e?void 0:e.close)&&void 0!==i?i:y,x=g.convertToNicePixel(y),b="";b=y>_?u.upColor:y<_?u.downColor:u.noChangeColor;var C=g.getRange(),T=g.displayValueToText(g.realValueToDisplayValue(g.valueToRealValue(y,{range:C}),{range:C}),h.price);T=s.getDecimalFold().format(s.getThousandsSeparator().format(T));var w=0,S="left";g.isFromZero()?(w=0,S="left"):(w=a.width,S="right"),null===(n=this.createFigure({name:"text",attrs:{x:w,y:x,text:T,align:S,baseline:"middle"},styles:p(p({},c),{backgroundColor:b})}))||void 0===n||n.draw(t)}}},e}($e),mi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e=this,i=this.getWidget(),n=i.getPane(),r=i.getBounding(),o=n.getChart().getChartStore(),a=o.getStyles().indicator,s=a.lastValueMark,l=s.text;if(s.show){var u=n.getAxisComponent(),c=u.getRange(),h=o.getDataList().length-1,d=o.getIndicatorsByPaneId(n.getId()),g=o.getCustomApi(),v=o.getDecimalFold(),f=o.getThousandsSeparator();d.forEach((function(i){var n,o,s=i.result,d=null!==(o=null!==(n=s[h])&&void 0!==n?n:s[h-1])&&void 0!==o?o:{};if(E(d)&&i.visible){var y=i.precision;J(i,h,a,(function(n,o){var a,s=d[n.key];if(S(s)){var h=u.convertToNicePixel(s),m=u.displayValueToText(u.realValueToDisplayValue(u.valueToRealValue(s,{range:c}),{range:c}),y);i.shouldFormatBigNumber&&(m=g.formatBigNumber(m)),m=v.format(f.format(m));var _=0,x="left";u.isFromZero()?(_=0,x="left"):(_=r.width,x="right"),null===(a=e.createFigure({name:"text",attrs:{x:_,y:h,text:m,align:x,baseline:"middle"},styles:p(p({},l),{backgroundColor:o.color})}))||void 0===a||a.draw(t)}}))}}))}},e}($e),_i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},e.prototype.drawDefaultFigures=function(t,e,i){this.drawFigures(t,e,this.getDefaultFigures(e,i))},e.prototype.getDefaultFigures=function(t,e){var i,n=this.getWidget(),r=n.getPane(),o=r.getChart().getChartStore(),a=o.getClickOverlayInfo(),s=[];if(t.needDefaultYAxisFigure&&t.id===(null===(i=a.overlay)||void 0===i?void 0:i.id)&&a.paneId===r.getId()){var l=r.getAxisComponent(),u=n.getBounding(),c=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER,d=l.isFromZero(),p="left",g=0;d?(p="left",g=0):(p="right",g=u.width);var v=o.getDecimalFold(),f=o.getThousandsSeparator();e.forEach((function(e,i){var n=t.points[i];if(S(n.value)){c=Math.min(c,e.y),h=Math.max(h,e.y);var r=v.format(f.format(V(n.value,o.getPrecision().price)));s.push({type:"text",attrs:{x:g,y:e.y,text:r,align:p,baseline:"middle"},ignoreEvent:!0})}})),e.length>1&&s.unshift({type:"rect",attrs:{x:0,y:c,width:u.width,height:h-c},ignoreEvent:!0})}return s},e.prototype.getFigures=function(t,e){var i,n,r=this.getWidget(),o=r.getPane(),a=o.getChart(),s=o.getAxisComponent(),l=a.getXAxisPane().getAxisComponent(),u=r.getBounding();return null!==(n=null===(i=t.createYAxisFigures)||void 0===i?void 0:i.call(t,{chart:a,overlay:t,coordinates:e,bounding:u,xAxis:l,yAxis:s}))&&void 0!==n?n:[]},e}(ai),xi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawImp=function(t){var e,i=this.getWidget(),n=i.getPane(),r=i.getBounding(),o=i.getPane().getChart().getChartStore(),a=o.getCrosshair(),s=o.getStyles().crosshair;if(I(a.paneId)&&this.compare(a,n.getId())&&s.show){var l=this.getDirectionStyles(s),u=l.text;if(l.show&&u.show){var c=n.getAxisComponent(),h=this.getText(a,o,c);t.font=U(u.size,u.weight,u.family),null===(e=this.createFigure({name:"text",attrs:this.getTextAttrs(h,t.measureText(h).width,a,r,c,u),styles:u}))||void 0===e||e.draw(t)}}},e.prototype.compare=function(t,e){return t.paneId===e},e.prototype.getDirectionStyles=function(t){return t.horizontal},e.prototype.getText=function(t,e,i){var n=i,r=i.convertFromPixel(t.y),o=0,a=!1;n.isInCandle()?o=e.getPrecision().price:e.getIndicatorsByPaneId(t.paneId).forEach((function(t){o=Math.max(t.precision,o),a||(a=t.shouldFormatBigNumber)}));var s=n.getRange(),l=n.displayValueToText(n.realValueToDisplayValue(n.valueToRealValue(r,{range:s}),{range:s}),o);return a&&(l=e.getCustomApi().formatBigNumber(l)),e.getDecimalFold().format(e.getThousandsSeparator().format(l))},e.prototype.getTextAttrs=function(t,e,i,n,r,o){var a=0,s="left";return r.isFromZero()?(a=0,s="left"):(a=n.width,s="right"),{x:a,y:i.y,text:t,align:s,baseline:"middle"}},e}($e),bi=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._yAxisView=new fi(n),n._candleLastPriceLabelView=new yi(n),n._indicatorLastValueView=new mi(n),n._overlayYAxisView=new _i(n),n._crosshairHorizontalLabelView=new xi(n),n.getContainer().style.cursor="ns-resize",n.addChild(n._overlayYAxisView),n}return i(e,t),e.prototype.getName=function(){return De},e.prototype.updateMain=function(t){var e="minimize"===this.getPane().getOptions().state;this._yAxisView.draw(t,e),e||(this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(t),this._indicatorLastValueView.draw(t))},e.prototype.updateOverlay=function(t){"minimize"!==this.getPane().getOptions().state&&(this._overlayYAxisView.draw(t),this._crosshairHorizontalLabelView.draw(t))},e}(Be),Ci=function(e){function n(t,i){var n=e.call(this,t)||this;return n.reverse=!1,n.inside=!1,n.position=Je.Right,n.gap={top:.2,bottom:.1},n.createRange=function(t){return t.defaultRange},n.minSpan=function(t){return xt(-t)},n.valueToRealValue=function(t){return t},n.realValueToDisplayValue=function(t){return t},n.displayValueToRealValue=function(t){return t},n.realValueToValue=function(t){return t},n.displayValueToText=function(t,e){return V(t,e)},n.override(i),n}return i(n,e),n.prototype.override=function(t){var e=t.name,i=t.gap,n=g(t,["name","gap"]);I(this.name)||(this.name=e),x(this.gap,i),x(this,n)},n.prototype.createRangeImp=function(){var e=this.getParent(),i=e.getChart(),n=i.getChartStore(),r=e.getId(),o=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER,s=!1,l=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,h=n.getIndicatorsByPaneId(r);h.forEach((function(t){s||(s=t.shouldOhlc),c=Math.min(c,t.precision),S(t.minValue)&&(l=Math.min(l,t.minValue)),S(t.maxValue)&&(u=Math.max(u,t.maxValue))}));var d=4,p=this.isInCandle();if(p){var g=n.getPrecision().price;d=c!==Number.MAX_SAFE_INTEGER?Math.min(c,g):g}else c!==Number.MAX_SAFE_INTEGER&&(d=c);var v=n.getVisibleRangeDataList(),f=i.getStyles().candle,y=f.type===t.CandleType.Area,m=f.area.value,_=p&&!y||!p&&s;v.forEach((function(t){var e=t.dataIndex,i=t.data.current;if(E(i)&&(_&&(o=Math.min(o,i.low),a=Math.max(a,i.high)),p&&y)){var n=i[m];S(n)&&(o=Math.min(o,n),a=Math.max(a,n))}h.forEach((function(t){var i,n=t.result,r=t.figures,s=null!==(i=n[e])&&void 0!==i?i:{};r.forEach((function(t){var e=s[t.key];S(e)&&(o=Math.min(o,e),a=Math.max(a,e))}))}))})),o!==Number.MAX_SAFE_INTEGER&&a!==Number.MIN_SAFE_INTEGER?(o=Math.min(l,o),a=Math.max(u,a)):(o=0,a=10);var x=a-o,b={from:o,to:a,range:x,realFrom:o,realTo:a,realRange:x,displayFrom:o,displayTo:a,displayRange:x},C=this.createRange({chart:i,paneId:r,defaultRange:b}),T=C.realFrom,w=C.realTo,P=C.realRange,I=this.minSpan(d);if(T===w||P<I){var M=l===T,k=u===w;T=M?T:k?T-8*I:T-4*I,w=k?w:M?w+8*I:w+4*I}var D=this.getBounding().height,A=this.gap,F=A.top;F>=1&&(F/=D);var R=A.bottom;R>=1&&(R/=D),T-=(P=w-T)*R,w+=P*F;var B=this.realValueToValue(T,{range:C}),L=this.realValueToValue(w,{range:C}),O=this.realValueToDisplayValue(T,{range:C}),W=this.realValueToDisplayValue(w,{range:C});return{from:B,to:L,range:L-B,realFrom:T,realTo:w,realRange:w-T,displayFrom:O,displayTo:W,displayRange:W-O}},n.prototype.isInCandle=function(){return this.getParent().getId()===Ce},n.prototype.isFromZero=function(){return this.position===Je.Left&&this.inside||this.position===Je.Right&&!this.inside},n.prototype.createTicksImp=function(){var t,e,i=this,n=this.getRange(),r=n.displayFrom,o=n.displayTo,a=n.displayRange,s=[];if(a>=0){var l=function(t){var e=Math.floor(_t(t)),i=xt(e),n=t/i;return+(t=(n<1.5?1:n<2.5?2:n<3.5?3:n<4.5?4:n<5.5?5:n<6.5?6:8)*i).toFixed(Math.abs(e))}(a/8),u=function(t){var e=t.toString(),i=e.indexOf("e");if(i>0){var n=+e.slice(i+1);return n<0?-n:0}var r=e.indexOf(".");return r<0?0:e.length-1-r}(l),c=yt(Math.ceil(r/l)*l,u),h=yt(Math.floor(o/l)*l,u),d=0,p=c;if(0!==l)for(;p<=h;){var g=p.toFixed(u);s[d]={text:g,coord:0,value:g},++d,p+=l}}var v=this.getParent(),f=null!==(e=null===(t=v.getYAxisWidget())||void 0===t?void 0:t.getBounding().height)&&void 0!==e?e:0,y=v.getChart().getChartStore(),m=[],_=y.getIndicatorsByPaneId(v.getId()),x=y.getStyles(),b=0,C=!1;this.isInCandle()?b=y.getPrecision().price:_.forEach((function(t){b=Math.max(b,t.precision),C||(C=t.shouldFormatBigNumber)}));var w=y.getCustomApi(),E=y.getThousandsSeparator(),P=y.getDecimalFold(),I=x.xAxis.tickText.size,M=NaN;return s.forEach((function(t){var e=t.value,r=i.displayValueToText(+e,b),o=i.convertToPixel(i.realValueToValue(i.displayValueToRealValue(+e,{range:n}),{range:n}));C&&(r=w.formatBigNumber(e)),r=P.format(E.format(r));var a=S(M);o>I&&o<f-I&&(a&&Math.abs(M-o)>2*I||!a)&&(m.push({text:r,coord:o,value:e}),M=o)})),T(this.createTicks)?this.createTicks({range:this.getRange(),bounding:this.getBounding(),defaultTicks:m}):m},n.prototype.getAutoSize=function(){var t=this.getParent(),e=t.getChart().getChartStore(),i=e.getStyles(),n=i.yAxis,r=n.size;if("auto"!==r)return r;var o=0;if(n.show&&(n.axisLine.show&&(o+=n.axisLine.size),n.tickLine.show&&(o+=n.tickLine.length),n.tickText.show)){var a=0;this.getTicks().forEach((function(t){a=Math.max(a,Z(t.text,n.tickText.size,n.tickText.weight,n.tickText.family))})),o+=n.tickText.marginStart+n.tickText.marginEnd+a}var s=i.crosshair,l=0;if(s.show&&s.horizontal.show&&s.horizontal.text.show){var u=e.getIndicatorsByPaneId(t.getId()),c=0,h=!1;u.forEach((function(t){c=Math.max(t.precision,c),h||(h=t.shouldFormatBigNumber)}));var d=2;if(this.isInCandle()){var p=e.getPrecision().price,g=i.indicator.lastValueMark;d=g.show&&g.text.show?Math.max(c,p):p}else d=c;var v=V(this.getRange().displayTo,d);h&&(v=e.getCustomApi().formatBigNumber(v)),v=e.getDecimalFold().format(v),l+=s.horizontal.text.paddingLeft+s.horizontal.text.paddingRight+2*s.horizontal.text.borderSize+Z(v,s.horizontal.text.size,s.horizontal.text.weight,s.horizontal.text.family)}return Math.max(o,l)},n.prototype.getBounding=function(){return this.getParent().getYAxisWidget().getBounding()},n.prototype.convertFromPixel=function(t){var e=this.getBounding().height,i=this.getRange(),n=i.realFrom,r=i.realRange,o=(this.reverse?t/e:1-t/e)*r+n;return this.realValueToValue(o,{range:i})},n.prototype.convertToPixel=function(t){var e,i,n=this.getRange(),r=this.valueToRealValue(t,{range:n}),o=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,a=(r-n.realFrom)/n.realRange;return this.reverse?Math.round(a*o):Math.round((1-a)*o)},n.prototype.convertToNicePixel=function(t){var e,i,n=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,r=this.convertToPixel(t);return Math.round(Math.max(.05*n,Math.min(r,.98*n)))},n.extend=function(t){var e=function(e){function n(i){return e.call(this,i,t)||this}return i(n,e),n}(n);return e},n}(hi),Ti={name:"percentage",minSpan:function(){return Math.pow(10,-2)},displayValueToText:function(t){return"".concat(V(t,2),"%")},valueToRealValue:function(t,e){var i=e.range;return(t-i.from)/i.range*i.realRange+i.realFrom},realValueToValue:function(t,e){var i=e.range;return(t-i.realFrom)/i.realRange*i.range+i.from},createRange:function(t){var e=t.chart,i=t.defaultRange,n=e.getDataList()[e.getVisibleRange().from];if(E(n)){var r=i.from,o=i.to,a=i.range,s=(i.from-n.close)/n.close*100,l=(i.to-n.close)/n.close*100,u=l-s;return{from:r,to:o,range:a,realFrom:s,realTo:l,realRange:u,displayFrom:s,displayTo:l,displayRange:u}}return i}},wi={name:"logarithm",minSpan:function(t){return.05*xt(-t)},valueToRealValue:function(t){return t<0?-_t(Math.abs(t)):_t(t)},realValueToDisplayValue:function(t){return t<0?-xt(Math.abs(t)):xt(t)},displayValueToRealValue:function(t){return t<0?-_t(Math.abs(t)):_t(t)},realValueToValue:function(t){return t<0?-xt(Math.abs(t)):xt(t)},createRange:function(t){var e=t.defaultRange,i=e.from,n=e.to,r=e.range,o=i<0?-_t(Math.abs(i)):_t(i),a=n<0?-_t(Math.abs(n)):_t(n);return{from:i,to:n,range:r,realFrom:o,realTo:a,realRange:a-o,displayFrom:i,displayTo:n,displayRange:r}}},Si={normal:Ci.extend({name:"normal"}),percentage:Ci.extend(Ti),logarithm:Ci.extend(wi)};var Ei=function(){function t(t,e){this._bounding=ot(),this._originalBounding=ot(),this._visible=!0,this._chart=t,this._id=e,this._container=vt("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"})}return t.prototype.getContainer=function(){return this._container},t.prototype.setVisible=function(t){this._visible!==t&&(this._container.style.display=t?"block":"none",this._visible=t)},t.prototype.getVisible=function(){return this._visible},t.prototype.getId=function(){return this._id},t.prototype.getChart=function(){return this._chart},t.prototype.getBounding=function(){return this._bounding},t.prototype.setOriginalBounding=function(t){x(this._originalBounding,t)},t.prototype.getOriginalBounding=function(){return this._originalBounding},t.prototype.update=function(t){this._bounding.height!==this._container.clientHeight&&(this._container.style.height="".concat(this._bounding.height,"px")),this.updateImp(null!=t?t:3,this._container,this._bounding)},t}(),Pi=function(t){function e(e,i,n){var r=t.call(this,e,i)||this;r._yAxisWidget=null,r._options={id:"",minHeight:30,dragEnabled:!0,order:0,height:100,state:"normal",axis:{name:"normal",scrollZoomEnabled:!0}};var o=r.getContainer();return r._mainWidget=r.createMainWidget(o),r._yAxisWidget=r.createYAxisWidget(o),r.setOptions(n),r}return i(e,t),e.prototype.setOptions=function(t){var e,i,n,r,o,a=this.getId();if(a===Ce||a===we){var s=null===(e=t.axis)||void 0===e?void 0:e.name;(!E(this._axis)||E(s)&&this._options.axis.name!==s)&&(this._axis=this.createAxisComponent(null!=s?s:"normal"))}else E(this._axis)||(this._axis=this.createAxisComponent("normal"));this._axis instanceof Ci&&this._axis.setAutoCalcTickFlag(!0),x(this._options,t),this._axis.override(p(p({},this._options.axis),{name:null!==(n=null===(i=t.axis)||void 0===i?void 0:i.name)&&void 0!==n?n:"normal"}));var l=null,u="default";return this.getId()===we?(l=this.getMainWidget().getContainer(),u="ew-resize"):(l=this.getYAxisWidget().getContainer(),u="ns-resize"),null===(o=null===(r=t.axis)||void 0===r?void 0:r.scrollZoomEnabled)||void 0===o||o?l.style.cursor=u:l.style.cursor="default",this},e.prototype.getOptions=function(){return this._options},e.prototype.getAxisComponent=function(){return this._axis},e.prototype.setBounding=function(t,e,i,n){var r,o,a,s;x(this.getBounding(),t);var l={};E(t.height)&&(l.height=t.height),E(t.top)&&(l.top=t.top),this._mainWidget.setBounding(l);var u=E(e);(u&&this._mainWidget.setBounding(e),E(this._yAxisWidget))&&(this._yAxisWidget.setBounding(l),this._axis.position===Je.Left?E(i)&&this._yAxisWidget.setBounding(p(p({},i),{left:0})):E(n)&&(this._yAxisWidget.setBounding(n),u&&this._yAxisWidget.setBounding({left:(null!==(r=e.left)&&void 0!==r?r:0)+(null!==(o=e.width)&&void 0!==o?o:0)+(null!==(a=e.right)&&void 0!==a?a:0)-(null!==(s=n.width)&&void 0!==s?s:0)})));return this},e.prototype.getMainWidget=function(){return this._mainWidget},e.prototype.getYAxisWidget=function(){return this._yAxisWidget},e.prototype.updateImp=function(t){var e;this._mainWidget.update(t),null===(e=this._yAxisWidget)||void 0===e||e.update(t)},e.prototype.destroy=function(){var t;this._mainWidget.destroy(),null===(t=this._yAxisWidget)||void 0===t||t.destroy()},e.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,n=e.height,r=vt("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),o=r.getContext("2d"),a=G(r);r.width=i*a,r.height=n*a,o.scale(a,a);var s=this._mainWidget.getBounding();if(o.drawImage(this._mainWidget.getImage(t),s.left,0,s.width,s.height),null!==this._yAxisWidget){var l=this._yAxisWidget.getBounding();o.drawImage(this._yAxisWidget.getImage(t),l.left,0,l.width,l.height)}return r},e.prototype.createYAxisWidget=function(t){return null},e}(Ei),Ii=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createAxisComponent=function(t){var e=function(t){var e;return null!==(e=Si[t])&&void 0!==e?e:Si.normal}(null!=t?t:"default");return new e(this)},e.prototype.createMainWidget=function(t){return new si(t,this)},e.prototype.createYAxisWidget=function(t){return new bi(t,this)},e}(Pi),Mi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createMainWidget=function(t){return new gi(t,this)},e}(Ii),ki=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getAxisStyles=function(t){return t.xAxis},e.prototype.createAxisLine=function(t){return{coordinates:[{x:0,y:0},{x:t.width,y:0}]}},e.prototype.createTickLines=function(t,e,i){var n=i.tickLine,r=i.axisLine.size;return t.map((function(t){return{coordinates:[{x:t.coord,y:0},{x:t.coord,y:r+n.length}]}}))},e.prototype.createTickTexts=function(t,e,i){var n=i.tickText,r=i.axisLine.size,o=i.tickLine.length;return t.map((function(t){return{x:t.coord,y:r+o+n.marginStart,text:t.text,align:"center",baseline:"top"}}))},e}(vi),Di=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i(n,e),n.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},n.prototype.coordinateToPointValueFlag=function(){return!1},n.prototype.getCompleteOverlays=function(){return this.getWidget().getPane().getChart().getChartStore().getOverlaysByPaneId()},n.prototype.getProgressOverlay=function(){var t,e;return null!==(e=null===(t=this.getWidget().getPane().getChart().getChartStore().getProgressOverlayInfo())||void 0===t?void 0:t.overlay)&&void 0!==e?e:null},n.prototype.getDefaultFigures=function(e,i){var n,r=[],o=this.getWidget(),a=o.getPane().getChart().getChartStore(),s=a.getClickOverlayInfo();if(e.needDefaultXAxisFigure&&e.id===(null===(n=s.overlay)||void 0===n?void 0:n.id)){var l=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;i.forEach((function(i,n){l=Math.min(l,i.x),u=Math.max(u,i.x);var o=e.points[n];if(S(o.timestamp)){var s=a.getCustomApi().formatDate(o.timestamp,"YYYY-MM-DD HH:mm",t.FormatDateType.Crosshair);r.push({type:"text",attrs:{x:i.x,y:0,text:s,align:"center"},ignoreEvent:!0})}})),i.length>1&&r.unshift({type:"rect",attrs:{x:l,y:0,width:u-l,height:o.getBounding().height},ignoreEvent:!0})}return r},n.prototype.getFigures=function(t,e){var i,n,r=this.getWidget(),o=r.getPane(),a=o.getChart(),s=o.getAxisComponent(),l=a.getXAxisPane().getAxisComponent(),u=r.getBounding();return null!==(n=null===(i=t.createXAxisFigures)||void 0===i?void 0:i.call(t,{chart:a,overlay:t,coordinates:e,bounding:u,xAxis:l,yAxis:s}))&&void 0!==n?n:[]},n}(_i),Ai=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i(n,e),n.prototype.compare=function(t){return E(t.timestamp)},n.prototype.getDirectionStyles=function(t){return t.vertical},n.prototype.getText=function(e,i){var n=e.timestamp;return i.getCustomApi().formatDate(n,"YYYY-MM-DD HH:mm",t.FormatDateType.Crosshair)},n.prototype.getTextAttrs=function(t,e,i,n,r,o){var a=i.realX,s=0,l="center";return a-e/2-o.paddingLeft<0?(s=0,l="left"):a+e/2+o.paddingRight>n.width?(s=n.width,l="right"):s=a,{x:s,y:0,text:t,align:l,baseline:"top"}},n}(xi),Fi=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._xAxisView=new ki(n),n._overlayXAxisView=new Di(n),n._crosshairVerticalLabelView=new Ai(n),n.getContainer().style.cursor="ew-resize",n.addChild(n._overlayXAxisView),n}return i(e,t),e.prototype.getName=function(){return ke},e.prototype.updateMain=function(t){this._xAxisView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)},e}(Be),Ri=function(e){function n(t,i){var n=e.call(this,t)||this;return n.override(i),n}return i(n,e),n.prototype.override=function(t){var e=t.name,i=t.scrollZoomEnabled,n=t.createTicks;I(this.name)||(this.name=e),this.scrollZoomEnabled=null!=i?i:this.scrollZoomEnabled,this.createTicks=null!=n?n:this.createTicks},n.prototype.createRangeImp=function(){var t=this.getParent().getChart().getChartStore().getVisibleRange(),e=t.realFrom,i=t.realTo,n=i-e+1;return{from:e,to:i,range:n,realFrom:e,realTo:i,realRange:n,displayFrom:e,displayTo:i,displayRange:n}},n.prototype.createTicksImp=function(){var e=this,i=this.getRange(),n=i.realFrom,r=i.realTo,o=this.getParent().getChart().getChartStore(),a=o.getCustomApi().formatDate,s=o.getTimeWeightTickList(),l=[],u=function(i,n){var o,s;try{for(var u=y(i),c=u.next();!c.done;c=u.next()){var h=c.value;if(h.dataIndex>=n&&h.dataIndex<r){var d=h.timestamp,p=h.weight,g=h.dataIndex,v="";switch(p){case Tt:v=a(d,"YYYY",t.FormatDateType.XAxis);break;case wt:v=a(d,"YYYY-MM",t.FormatDateType.XAxis);break;case St:v=a(d,"MM-DD",t.FormatDateType.XAxis);break;case Et:case Pt:v=a(d,"HH:mm",t.FormatDateType.XAxis);break;case It:v=a(d,"HH:mm:ss",t.FormatDateType.XAxis);break;default:v=a(d,"YYYY-MM-DD HH:mm",t.FormatDateType.XAxis)}l.push({coord:e.convertToPixel(g),value:d,text:v})}}}catch(t){o={error:t}}finally{try{c&&!c.done&&(s=u.return)&&s.call(u)}finally{if(o)throw o.error}}};if(u(s,n),s.length>0){for(var c=o.getBarSpace().bar,h=o.getStyles().xAxis.tickText,d=kt(c,h),p=s[s.length-1].dataIndex+d-1,g=[],v=p;v<r;v++){var f=o.dataIndexToTimestamp(v);S(f)&&g.push({timestamp:f})}if(g.length>0){var m=new Map;Mt(m,g,o.getDateTimeFormat(),p),u(Dt(m,c,h),p)}}return T(this.createTicks)?this.createTicks({range:this.getRange(),bounding:this.getBounding(),defaultTicks:l}):l},n.prototype.getAutoSize=function(){var t=this.getParent().getChart().getStyles(),e=t.xAxis,i=e.size;if("auto"!==i)return i;var n=t.crosshair,r=0;e.show&&(e.axisLine.show&&(r+=e.axisLine.size),e.tickLine.show&&(r+=e.tickLine.length),e.tickText.show&&(r+=e.tickText.marginStart+e.tickText.marginEnd+e.tickText.size));var o=0;return n.show&&n.vertical.show&&n.vertical.text.show&&(o+=n.vertical.text.paddingTop+n.vertical.text.paddingBottom+2*n.vertical.text.borderSize+n.vertical.text.size),Math.max(r,o)},n.prototype.getBounding=function(){return this.getParent().getMainWidget().getBounding()},n.prototype.convertTimestampFromPixel=function(t){var e=this.getParent().getChart().getChartStore(),i=e.coordinateToDataIndex(t);return e.dataIndexToTimestamp(i)},n.prototype.convertTimestampToPixel=function(t){var e=this.getParent().getChart().getChartStore(),i=e.timestampToDataIndex(t);return e.dataIndexToCoordinate(i)},n.prototype.convertFromPixel=function(t){return this.getParent().getChart().getChartStore().coordinateToDataIndex(t)},n.prototype.convertToPixel=function(t){return this.getParent().getChart().getChartStore().dataIndexToCoordinate(t)},n.extend=function(t){var e=function(e){function n(i){return e.call(this,i,t)||this}return i(n,e),n}(n);return e},n}(hi),Bi={normal:Ri.extend({name:"normal"})};var Li=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createAxisComponent=function(t){var e=function(t){var e;return null!==(e=Bi[t])&&void 0!==e?e:Bi.normal}(t);return new e(this)},e.prototype.createMainWidget=function(t){return new Fi(t,this)},e}(Pi);var Oi=function(e){function n(t,i){var n,r,o,a=e.call(this,t,i)||this;return a._dragFlag=!1,a._dragStartY=0,a._topPaneHeight=0,a._bottomPaneHeight=0,a._topPane=null,a._bottomPane=null,a._pressedMouseMoveEvent=(n=a._pressedTouchMouseMoveEvent,r=20,o=0,function(){var t=Date.now();t-o>r&&(n.apply(this,arguments),o=t)}),a.registerEvent("touchStartEvent",a._mouseDownEvent.bind(a)).registerEvent("touchMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("touchEndEvent",a._mouseUpEvent.bind(a)).registerEvent("mouseDownEvent",a._mouseDownEvent.bind(a)).registerEvent("mouseUpEvent",a._mouseUpEvent.bind(a)).registerEvent("pressedMouseMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("mouseEnterEvent",a._mouseEnterEvent.bind(a)).registerEvent("mouseLeaveEvent",a._mouseLeaveEvent.bind(a)),a}return i(n,e),n.prototype.getName=function(){return Ae},n.prototype.checkEventOn=function(){return!0},n.prototype._mouseDownEvent=function(t){var e=this;this._dragFlag=!0,this._dragStartY=t.pageY;var i=this.getPane(),n=i.getChart();this._topPane=i.getTopPane(),this._bottomPane=i.getBottomPane();var r=n.getDrawPanes();if("minimize"===this._topPane.getOptions().state)for(var o=r.findIndex((function(t){var i;return t.getId()===(null===(i=e._topPane)||void 0===i?void 0:i.getId())})),a=o-1;a>-1;a--){var s=r[a];if("minimize"!==s.getOptions().state){this._topPane=s;break}}if("minimize"===this._bottomPane.getOptions().state)for(o=r.findIndex((function(t){var i;return t.getId()===(null===(i=e._bottomPane)||void 0===i?void 0:i.getId())})),a=o+1;a<r.length;a++){var l=r[a];if("minimize"!==l.getOptions().state){this._bottomPane=l;break}}return this._topPaneHeight=this._topPane.getBounding().height,this._bottomPaneHeight=this._bottomPane.getBounding().height,!0},n.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._topPane=null,this._bottomPane=null,this._topPaneHeight=0,this._bottomPaneHeight=0,this._mouseLeaveEvent()},n.prototype._pressedTouchMouseMoveEvent=function(e){var i=e.pageY-this._dragStartY,n=i<0;if(E(this._topPane)&&E(this._bottomPane)){var r=this._bottomPane.getOptions();if("minimize"!==this._topPane.getOptions().state&&"minimize"!==r.state&&r.dragEnabled){var o=null,a=null,s=0,l=0;n?(o=this._topPane,a=this._bottomPane,s=this._topPaneHeight,l=this._bottomPaneHeight):(o=this._bottomPane,a=this._topPane,s=this._bottomPaneHeight,l=this._topPaneHeight);var u=o.getOptions().minHeight;if(s>u){var c=Math.max(s-Math.abs(i),u),h=s-c;o.setBounding({height:c}),a.setBounding({height:l+h});var d=this.getPane(),p=d.getChart();p.getChartStore().executeAction(t.ActionType.OnPaneDrag,{paneId:d.getId()}),p.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}}}return!0},n.prototype._mouseEnterEvent=function(){var t=this.getPane();if(t.getBottomPane().getOptions().dragEnabled){var e=t.getChart().getStyles().separator;return this.getContainer().style.background=e.activeBackgroundColor,!0}return!1},n.prototype._mouseLeaveEvent=function(){return!this._dragFlag&&(this.getContainer().style.background="transparent",!0)},n.prototype.createContainer=function(){return vt("div",{width:"100%",height:"".concat(7,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})},n.prototype.updateImp=function(t,e,i){if(4===i||2===i){var n=this.getPane().getChart().getStyles().separator;t.style.top="".concat(-Math.floor((7-n.size)/2),"px"),t.style.height="".concat(7,"px")}},n}(Re),Wi=function(t){function e(e,i,n,r){var o=t.call(this,e,i)||this;return o.getContainer().style.overflow="",o._topPane=n,o._bottomPane=r,o._separatorWidget=new Oi(o.getContainer(),o),o}return i(e,t),e.prototype.setBounding=function(t){return x(this.getBounding(),t),this},e.prototype.getTopPane=function(){return this._topPane},e.prototype.setTopPane=function(t){return this._topPane=t,this},e.prototype.getBottomPane=function(){return this._bottomPane},e.prototype.setBottomPane=function(t){return this._bottomPane=t,this},e.prototype.getWidget=function(){return this._separatorWidget},e.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,n=e.height,r=this.getChart().getStyles().separator,o=vt("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),a=o.getContext("2d"),s=G(o);return o.width=i*s,o.height=n*s,a.scale(s,s),a.fillStyle=r.color,a.fillRect(0,0,i,n),o},e.prototype.updateImp=function(t,e,i){if(4===t||2===t){var n=this.getChart().getStyles().separator;e.style.backgroundColor=n.color,e.style.height="".concat(i.height,"px"),e.style.marginLeft="".concat(i.left,"px"),e.style.width="".concat(i.width,"px"),this._separatorWidget.update(t)}},e}(Ei);function Vi(){return"undefined"!=typeof window&&window.navigator.userAgent.toLowerCase().includes("firefox")}function Ni(){return"undefined"!=typeof window&&/iPhone|iPad|iPod|iOS/.test(window.navigator.userAgent)}var zi,Yi=5,Hi=5,Xi=5,Gi=30,Ui=0,Zi=1,qi=2,ji=function(){function t(t,e,i){var n=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!Ni(),this._onFirefoxOutsideMouseUp=function(t){n._mouseUpHandler(t)},this._onMobileSafariDoubleClick=function(t){n._firesTouchEvents(t)?(++n._tapCount,null!==n._tapTimeoutId&&n._tapCount>1&&(n._mouseTouchMoveWithDownInfo(n._getCoordinate(t),n._tapCoordinate).manhattanDistance<Gi&&!n._cancelTap&&n._processEvent(n._makeCompatEvent(t),n._handler.doubleTapEvent),n._resetTapTimeout())):(++n._clickCount,null!==n._clickTimeoutId&&n._clickCount>1&&(n._mouseTouchMoveWithDownInfo(n._getCoordinate(t),n._clickCoordinate).manhattanDistance<Xi&&!n._cancelClick&&n._processEvent(n._makeCompatEvent(t),n._handler.mouseDoubleClickEvent),n._resetClickTimeout()))},this._target=t,this._handler=e,this._options=i,this._init()}return t.prototype.destroy=function(){null!==this._unsubscribeOutsideMouseEvents&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),null!==this._unsubscribeOutsideTouchEvents&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeMouseWheel&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),null!==this._unsubscribeContextMenu&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),null!==this._unsubscribeMobileSafariEvents&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},t.prototype._mouseEnterHandler=function(t){var e,i,n,r=this;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(n=this._unsubscribeContextMenu)||void 0===n||n.call(this);var o=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){r._target.removeEventListener("mousemove",o)},this._target.addEventListener("mousemove",o);var a=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){r._target.removeEventListener("wheel",a)},this._target.addEventListener("wheel",a,{passive:!1});var s=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){r._target.removeEventListener("contextmenu",s)},this._target.addEventListener("contextmenu",s,{passive:!1}),this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},t.prototype._resetClickTimeout=function(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},t.prototype._resetTapTimeout=function(){null!==this._tapTimeoutId&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},t.prototype._mouseMoveHandler=function(t){this._mousePressed||null!==this._touchMoveStartCoordinate||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},t.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(!E(this._handler.mouseWheelHortEvent))return;if(this._preventDefault(t),0===Math.abs(t.deltaX))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(!E(this._handler.mouseWheelVertEvent))return;var e=-t.deltaY/100;if(0===e)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(0!==e){var i=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),i)}}},t.prototype._contextMenuHandler=function(t){this._preventDefault(t)},t.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null!==e&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),null===this._startPinchMiddleCoordinate&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var i=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),n=i.xOffset,r=i.yOffset,o=i.manhattanDistance;if(this._touchMoveExceededManhattanDistance||!(o<Hi)){if(!this._touchMoveExceededManhattanDistance){var a=.5*n,s=r>=a&&!this._options.treatVertDragAsPageScroll(),l=a>r&&!this._options.treatHorzDragAsPageScroll();s||l||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},t.prototype._mouseMoveWithDownHandler=function(t){t.button===Ui&&(this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate).manhattanDistance>=Yi&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent))},t.prototype._mouseTouchMoveWithDownInfo=function(t,e){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return{xOffset:i,yOffset:n,manhattanDistance:i+n}},t.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null===e&&0===t.touches.length&&(e=t.changedTouches[0]),null!==e){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var i=this._makeCompatEvent(t,e);if(this._processEvent(i,this._handler.touchEndEvent),++this._tapCount,null!==this._tapTimeoutId&&this._tapCount>1)this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance<Gi&&!this._cancelTap&&this._processEvent(i,this._handler.doubleTapEvent),this._resetTapTimeout();else this._cancelTap||(this._processEvent(i,this._handler.tapEvent),E(this._handler.tapEvent)&&this._preventDefault(t));0===this._tapCount&&this._preventDefault(t),0===t.touches.length&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},t.prototype._mouseUpHandler=function(t){if(t.button===Ui){var e=this._makeCompatEvent(t);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),Vi())this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp);if(!this._firesTouchEvents(t))if(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,null!==this._clickTimeoutId&&this._clickCount>1)this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance<Xi&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout();else this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent)}},t.prototype._clearLongTapTimeout=function(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},t.prototype._touchStartHandler=function(t){if(null===this._activeTouchId){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var i=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var n=this._touchMoveHandler.bind(this),r=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){i.removeEventListener("touchmove",n),i.removeEventListener("touchend",r)},i.addEventListener("touchmove",n,{passive:!1}),i.addEventListener("touchend",r,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),500),this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),null===this._tapTimeoutId&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(e))}},t.prototype._mouseDownHandler=function(t){if(t.button===qi)return this._preventDefault(t),void this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);if(t.button===Ui){var e=this._target.ownerDocument.documentElement;Vi()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);var i=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",i),e.removeEventListener("mouseup",n)},e.addEventListener("mousemove",i),e.addEventListener("mouseup",n),this._mousePressed=!0,this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),null===this._clickTimeoutId&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(t)))}},t.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e=this._target.ownerDocument,i=function(e){null!=t._handler.mouseDownOutsideEvent&&(e.composed&&t._target.contains(e.composedPath()[0])||null!==e.target&&t._target.contains(e.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",i)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",i,{passive:!0}),Ni()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",(function(t){if(t.button===Zi)return t.preventDefault(),!1})),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype._initPinch=function(){var t=this;(E(this._handler.pinchStartEvent)||E(this._handler.pinchEvent)||E(this._handler.pinchEndEvent))&&(this._target.addEventListener("touchstart",(function(e){t._checkPinchState(e.touches)}),{passive:!0}),this._target.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t._startPinchMiddleCoordinate&&E(t._handler.pinchEvent)){var i=t._getTouchDistance(e.touches[0],e.touches[1])/t._startPinchDistance;t._handler.pinchEvent(p(p({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),i),t._preventDefault(e)}}),{passive:!1}),this._target.addEventListener("touchend",(function(e){t._checkPinchState(e.touches)})))},t.prototype._checkPinchState=function(t){1===t.length&&(this._pinchPrevented=!1),2!==t.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},t.prototype._startPinch=function(t){var e=this._target.getBoundingClientRect();this._startPinchMiddleCoordinate={x:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,y:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),E(this._handler.pinchStartEvent)&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},t.prototype._stopPinch=function(){null!==this._startPinchMiddleCoordinate&&(this._startPinchMiddleCoordinate=null,E(this._handler.pinchEndEvent)&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},t.prototype._mouseLeaveHandler=function(t){var e,i,n;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(n=this._unsubscribeContextMenu)||void 0===n||n.call(this),this._firesTouchEvents(t)||this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!Ni())},t.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);null!==e&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},t.prototype._firesTouchEvents=function(t){var e;return E(null===(e=t.sourceCapabilities)||void 0===e?void 0:e.firesTouchEvents)?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+500},t.prototype._processEvent=function(t,e){null==e||e.call(this._handler,t)},t.prototype._makeCompatEvent=function(t,e){var i=this,n=null!=e?e:t,r=this._target.getBoundingClientRect();return{x:n.clientX-r.left,y:n.clientY-r.top,pageX:n.pageX,pageY:n.pageY,isTouch:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type&&"wheel"!==t.type,preventDefault:function(){"touchstart"!==t.type&&i._preventDefault(t)}}},t.prototype._getTouchDistance=function(t,e){var i=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(i*i+n*n)},t.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},t.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},t.prototype._eventTimeStamp=function(t){var e;return null!==(e=t.timeStamp)&&void 0!==e?e:performance.now()},t.prototype._touchWithId=function(t,e){for(var i=0;i<t.length;++i)if(t[i].identifier===e)return t[i];return null},t}(),Qi=function(){function t(t,e){var i=this;this._flingStartTime=(new Date).getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(t){if(t.shiftKey)switch(t.code){case"Equal":i._chart.getChartStore().zoom(.5);break;case"Minus":i._chart.getChartStore().zoom(-.5);break;case"ArrowLeft":(e=i._chart.getChartStore()).startScroll(),e.scroll(-3*e.getBarSpace().bar);break;case"ArrowRight":var e;(e=i._chart.getChartStore()).startScroll(),e.scroll(3*e.getBarSpace().bar)}},this._container=t,this._chart=e,this._event=new ji(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return t.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},t.prototype.pinchEvent=function(t,e){var i=this._findWidgetByEvent(t),n=i.pane,r=i.widget;if((null==n?void 0:n.getId())!==we&&(null==r?void 0:r.getName())===Me){var o=this._makeWidgetEvent(t,r),a=5*(e-this._pinchScale);return this._pinchScale=e,this._chart.getChartStore().zoom(a,{x:o.x,y:o.y}),!0}return!1},t.prototype.mouseWheelHortEvent=function(t,e){var i=this._chart.getChartStore();return i.startScroll(),i.scroll(e),!0},t.prototype.mouseWheelVertEvent=function(t,e){var i=this._findWidgetByEvent(t).widget,n=this._makeWidgetEvent(t,i);return(null==i?void 0:i.getName())===Me&&(this._chart.getChartStore().zoom(e,{x:n.x,y:n.y}),!0)},t.prototype.mouseDownEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(this._mouseDownWidget=n,null!==n){var r=this._makeWidgetEvent(t,n);switch(n.getName()){case Ae:return n.dispatchEvent("mouseDownEvent",r);case Me:var o=i.getAxisComponent();if(!o.getAutoCalcTickFlag()){var a=o.getRange();this._prevYAxisRange=p({},a)}return this._startScrollCoordinate={x:r.x,y:r.y},this._chart.getChartStore().startScroll(),n.dispatchEvent("mouseDownEvent",r);case ke:return this._processXAxisScrollStartEvent(n,r);case De:return this._processYAxisScaleStartEvent(n,r)}}return!1},t.prototype.mouseMoveEvent=function(t){var e,i,n,r=this._findWidgetByEvent(t),o=r.pane,a=r.widget,s=this._makeWidgetEvent(t,a);if((null===(e=this._mouseMoveTriggerWidgetInfo.pane)||void 0===e?void 0:e.getId())===(null==o?void 0:o.getId())&&(null===(i=this._mouseMoveTriggerWidgetInfo.widget)||void 0===i?void 0:i.getName())===(null==a?void 0:a.getName())||(null==a||a.dispatchEvent("mouseEnterEvent",s),null===(n=this._mouseMoveTriggerWidgetInfo.widget)||void 0===n||n.dispatchEvent("mouseLeaveEvent",s),this._mouseMoveTriggerWidgetInfo={pane:o,widget:a}),null!==a)switch(a.getName()){case Me:var l=a.dispatchEvent("mouseMoveEvent",s),u={x:s.x,y:s.y,paneId:null==o?void 0:o.getId()};return l?(u=void 0,a.getContainer().style.cursor="pointer"):a.getContainer().style.cursor="crosshair",this._chart.getChartStore().setCrosshair(u),l;case Ae:case ke:case De:l=a.dispatchEvent("mouseMoveEvent",s);return this._chart.getChartStore().setCrosshair(),l}return!1},t.prototype.pressedMouseMoveEvent=function(t){var e,i;if(null!==this._mouseDownWidget&&this._mouseDownWidget.getName()===Ae)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var n=this._findWidgetByEvent(t),r=n.pane,o=n.widget;if(null!==o&&(null===(e=this._mouseDownWidget)||void 0===e?void 0:e.getPane().getId())===(null==r?void 0:r.getId())&&(null===(i=this._mouseDownWidget)||void 0===i?void 0:i.getName())===o.getName()){var a=this._makeWidgetEvent(t,o);switch(o.getName()){case Me:var s=void 0,l=o.dispatchEvent("pressedMouseMoveEvent",a);return l||(s={x:a.x,y:a.y,paneId:null==r?void 0:r.getId()},this._processMainScrollingEvent(o,a)),this._chart.getChartStore().setCrosshair(s,{forceInvalidate:!0}),l;case ke:return this._processXAxisScrollingEvent(o,a);case De:return this._processYAxisScalingEvent(o,a)}}return!1},t.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var n=this._makeWidgetEvent(t,e);switch(e.getName()){case Me:case Ae:case ke:case De:i=e.dispatchEvent("mouseUpEvent",n)}i&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,i},t.prototype.mouseClickEvent=function(t){var e=this._findWidgetByEvent(t).widget;if(null!==e){var i=this._makeWidgetEvent(t,e);return e.dispatchEvent("mouseClickEvent",i)}return!1},t.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var n=this._makeWidgetEvent(t,e);switch(e.getName()){case Me:case ke:case De:i=e.dispatchEvent("mouseRightClickEvent",n)}i&&this._chart.updatePane(1)}return!1},t.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n)switch(n.getName()){case Me:var r=this._makeWidgetEvent(t,n);return n.dispatchEvent("mouseDoubleClickEvent",r);case De:var o=i.getAxisComponent();if(!o.getAutoCalcTickFlag())return o.setAutoCalcTickFlag(!0),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0}),!0}return!1},t.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().setCrosshair(),!0},t.prototype.touchStartEvent=function(t){var e,i=this._findWidgetByEvent(t),n=i.pane,r=i.widget;if(null!==r){var o=this._makeWidgetEvent(t,r);switch(null===(e=o.preventDefault)||void 0===e||e.call(o),r.getName()){case Me:var a=this._chart.getChartStore();if(r.dispatchEvent("mouseDownEvent",o))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,a.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(1),!0;null!==this._flingScrollRequestId&&(lt(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=(new Date).getTime();var s=n.getAxisComponent();if(!s.getAutoCalcTickFlag()){var l=s.getRange();this._prevYAxisRange=p({},l)}if(this._startScrollCoordinate={x:o.x,y:o.y},a.startScroll(),this._touchZoomed=!1,null!==this._touchCoordinate){var u=o.x-this._touchCoordinate.x,c=o.y-this._touchCoordinate.y;Math.sqrt(u*u+c*c)<10?(this._touchCoordinate={x:o.x,y:o.y},a.setCrosshair({x:o.x,y:o.y,paneId:null==n?void 0:n.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,a.setCrosshair())}return!0;case ke:return this._processXAxisScrollStartEvent(r,o);case De:return this._processYAxisScaleStartEvent(r,o)}}return!1},t.prototype.touchMoveEvent=function(t){var e,i=this._findWidgetByEvent(t),n=i.pane,r=i.widget;if(null!==r){var o=this._makeWidgetEvent(t,r);null===(e=o.preventDefault)||void 0===e||e.call(o);var a=r.getName(),s=this._chart.getChartStore();switch(a){case Me:return r.dispatchEvent("pressedMouseMoveEvent",o)?(s.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(1),!0):(null!==this._touchCoordinate?s.setCrosshair({x:o.x,y:o.y,paneId:null==n?void 0:n.getId()}):this._processMainScrollingEvent(r,o),!0);case ke:return this._processXAxisScrollingEvent(r,o);case De:return this._processYAxisScalingEvent(r,o)}}return!1},t.prototype.touchEndEvent=function(t){var e=this,i=this._findWidgetByEvent(t).widget;if(null!==i){var n=this._makeWidgetEvent(t,i);switch(i.getName()){case Me:if(i.dispatchEvent("mouseUpEvent",n),null!==this._startScrollCoordinate){var r=(new Date).getTime()-this._flingStartTime,o=(n.x-this._startScrollCoordinate.x)/(r>0?r:1)*20;if(r<200&&Math.abs(o)>0){var a=this._chart.getChartStore(),s=function(){e._flingScrollRequestId=st((function(){a.startScroll(),a.scroll(o),o*=.975,Math.abs(o)<1?null!==e._flingScrollRequestId&&(lt(e._flingScrollRequestId),e._flingScrollRequestId=null):s()}))};s()}}return!0;case ke:case De:i.dispatchEvent("mouseUpEvent",n)&&this._chart.updatePane(1)}this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0}return!1},t.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget,r=!1;if(null!==n){var o=this._makeWidgetEvent(t,n),a=n.dispatchEvent("mouseClickEvent",o);if(n.getName()===Me){var s=this._makeWidgetEvent(t,n),l=this._chart.getChartStore();a?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.setCrosshair(void 0,{notInvalidate:!0}),r=!0):(this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:s.x,y:s.y},l.setCrosshair({x:s.x,y:s.y,paneId:null==i?void 0:i.getId()},{notInvalidate:!0}),r=!0),this._touchCancelCrosshair=!1)}(r||a)&&this._chart.updatePane(1)}return r},t.prototype.doubleTapEvent=function(t){return this.mouseDoubleClickEvent(t)},t.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n&&n.getName()===Me){var r=this._makeWidgetEvent(t,n);return this._touchCoordinate={x:r.x,y:r.y},this._chart.getChartStore().setCrosshair({x:r.x,y:r.y,paneId:null==i?void 0:i.getId()}),!0}return!1},t.prototype._processMainScrollingEvent=function(t,e){if(null!==this._startScrollCoordinate){var i=t.getPane().getAxisComponent();if(null!==this._prevYAxisRange&&!i.getAutoCalcTickFlag()&&i.scrollZoomEnabled){var n=this._prevYAxisRange,r=n.from,o=n.to,a=n.range*((i.reverse?this._startScrollCoordinate.y-e.y:e.y-this._startScrollCoordinate.y)/t.getBounding().height),s=r+a,l=o+a,u=i.valueToRealValue(s,{range:this._prevYAxisRange}),c=i.valueToRealValue(l,{range:this._prevYAxisRange}),h=i.realValueToDisplayValue(u,{range:this._prevYAxisRange}),d=i.realValueToDisplayValue(c,{range:this._prevYAxisRange});i.setRange({from:s,to:l,range:l-s,realFrom:u,realTo:c,realRange:c-u,displayFrom:h,displayTo:d,displayRange:d-h})}var p=e.x-this._startScrollCoordinate.x;this._chart.getChartStore().scroll(p)}},t.prototype._processXAxisScrollStartEvent=function(t,e){var i=t.dispatchEvent("mouseDownEvent",e);return i&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:e.x,y:e.y},this._xAxisStartScaleDistance=e.pageX,i},t.prototype._processXAxisScrollingEvent=function(t,e){var i,n=t.dispatchEvent("pressedMouseMoveEvent",e);if(n)this._chart.updatePane(1);else if(t.getPane().getAxisComponent().scrollZoomEnabled&&0!==this._xAxisStartScaleDistance){var r=this._xAxisStartScaleDistance/e.pageX;if(Number.isFinite(r)){var o=10*(r-this._xAxisScale);this._xAxisScale=r,this._chart.getChartStore().zoom(o,null!==(i=this._xAxisStartScaleCoordinate)&&void 0!==i?i:void 0)}}return n},t.prototype._processYAxisScaleStartEvent=function(t,e){var i=t.dispatchEvent("mouseDownEvent",e);i&&this._chart.updatePane(1);var n=t.getPane().getAxisComponent().getRange();return this._prevYAxisRange=p({},n),this._yAxisStartScaleDistance=e.pageY,i},t.prototype._processYAxisScalingEvent=function(t,e){var i=t.dispatchEvent("pressedMouseMoveEvent",e);if(i)this._chart.updatePane(1);else{var n=t.getPane().getAxisComponent();if(null!==this._prevYAxisRange&&n.scrollZoomEnabled&&0!==this._yAxisStartScaleDistance){var r=this._prevYAxisRange,o=r.from,a=r.to,s=r.range,l=s*(e.pageY/this._yAxisStartScaleDistance),u=(l-s)/2,c=o-u,h=a+u,d=n.valueToRealValue(c,{range:this._prevYAxisRange}),p=n.valueToRealValue(h,{range:this._prevYAxisRange}),g=n.realValueToDisplayValue(d,{range:this._prevYAxisRange}),v=n.realValueToDisplayValue(p,{range:this._prevYAxisRange});n.setRange({from:c,to:h,range:l,realFrom:d,realTo:p,realRange:p-d,displayFrom:g,displayTo:v,displayRange:v-g}),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0})}}return i},t.prototype._findWidgetByEvent=function(t){var e,i,n,r,o=t.x,a=t.y,s=this._chart.getSeparatorPanes(),l=this._chart.getStyles().separator.size;try{for(var u=y(s),c=u.next();!c.done;c=u.next()){var h=m(c.value,2)[1],d=(_=h.getBounding()).top-Math.round((7-l)/2);if(o>=_.left&&o<=_.left+_.width&&a>=d&&a<=d+7)return{pane:h,widget:h.getWidget()}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}var p=this._chart.getDrawPanes(),g=null;try{for(var v=y(p),f=v.next();!f.done;f=v.next()){var _,x=f.value;if(o>=(_=x.getBounding()).left&&o<=_.left+_.width&&a>=_.top&&a<=_.top+_.height){g=x;break}}}catch(t){n={error:t}}finally{try{f&&!f.done&&(r=v.return)&&r.call(v)}finally{if(n)throw n.error}}var b=null;if(null!==g){if(!E(b)){var C=g.getMainWidget(),T=C.getBounding();o>=T.left&&o<=T.left+T.width&&a>=T.top&&a<=T.top+T.height&&(b=C)}if(!E(b)){var w=g.getYAxisWidget();if(null!==w){var S=w.getBounding();o>=S.left&&o<=S.left+S.width&&a>=S.top&&a<=S.top+S.height&&(b=w)}}}return{pane:g,widget:b}},t.prototype._makeWidgetEvent=function(t,e){var i,n,r,o=null!==(i=null==e?void 0:e.getBounding())&&void 0!==i?i:null;return p(p({},t),{x:t.x-(null!==(n=null==o?void 0:o.left)&&void 0!==n?n:0),y:t.y-(null!==(r=null==o?void 0:o.top)&&void 0!==r?r:0)})},t.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},t}();t.DomPosition=void 0,(zi=t.DomPosition||(t.DomPosition={})).Root="root",zi.Main="main",zi.YAxis="yAxis";var Ki=function(){function e(t,e){this._chartBounding=ot(),this._drawPanes=[],this._separatorPanes=new Map,this._layoutOptions={sort:!0,measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!1,forceBuildYAxisTick:!1},this._layoutPending=!1,this._initContainer(t),this._chartEvent=new Qi(this._chartContainer,this),this._chartStore=new Ie(this,e),this._initPanes(e),this._layout()}return e.prototype._initContainer=function(t){this._container=t,this._chartContainer=vt("div",{position:"relative",width:"100%",height:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",overflow:"hidden",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer),this._cacheChartBounding()},e.prototype._cacheChartBounding=function(){this._chartBounding.width=Math.floor(this._chartContainer.clientWidth),this._chartBounding.height=Math.floor(this._chartContainer.clientHeight)},e.prototype._initPanes=function(t){var e,i=this,n=null!==(e=null==t?void 0:t.layout)&&void 0!==e?e:[{type:"candle"}],r=function(t){var e,n;if(!E(i._candlePane)){var r=null!==(e=t.options)&&void 0!==e?e:{};x(r,{id:Ce}),i._candlePane=i._createPane(Mi,Ce,r),(null!==(n=t.content)&&void 0!==n?n:[]).forEach((function(t){i.createIndicator(t,!0,r)}))}},o=function(t){if(!E(i._xAxisPane)){var e=i._createPane(Li,we,null!=t?t:{});i._xAxisPane=e}};n.forEach((function(t){var e,n,a;switch(t.type){case"candle":r(t);break;case"indicator":var s=null!==(e=t.content)&&void 0!==e?e:[];if(s.length>0){var l=null!==(a=null===(n=t.options)||void 0===n?void 0:n.id)&&void 0!==a?a:null;E(l)&&(l=gt(Te));var u=p(p({},t.options),{id:l});s.forEach((function(t){i.createIndicator(t,!0,u)}))}break;case"xAxis":o(t.options)}})),r({}),o({order:Number.MAX_SAFE_INTEGER})},e.prototype._createPane=function(t,e,i){var n=new t(this,e,null!=i?i:{});return this._drawPanes.push(n),n},e.prototype._recalculatePaneHeight=function(t,e,i){if(0===i)return!1;var n=this._drawPanes.filter((function(e){var i=e.getId();return"normal"===e.getOptions().state&&i!==t.getId()&&i!==we})),r=n.length;if(0===r)return!1;if(t.getId()!==Ce&&E(this._candlePane)&&"normal"===this._candlePane.getOptions().state){var o=this._candlePane.getBounding().height;if(o>0){var a=this._candlePane.getOptions().minHeight,s=o+i;s<a&&(e-=o+i-(s=a)),this._candlePane.setBounding({height:s})}}else{var l=i,u=Math.floor(i/r);n.forEach((function(t,e){var i=t.getBounding().height,n=0;(n=e===r-1?i+l:i+u)<t.getOptions().minHeight&&(n=t.getOptions().minHeight),t.setBounding({height:n}),l-=n-i})),Math.abs(l)>0&&(e-=l)}return t.setBounding({height:e}),!0},e.prototype.getDrawPaneById=function(t){if(t===Ce)return this._candlePane;if(t===we)return this._xAxisPane;var e=this._drawPanes.find((function(e){return e.getId()===t}));return null!=e?e:null},e.prototype.getContainer=function(){return this._container},e.prototype.getChartStore=function(){return this._chartStore},e.prototype.getXAxisPane=function(){return this._xAxisPane},e.prototype.getDrawPanes=function(){return this._drawPanes},e.prototype.getSeparatorPanes=function(){return this._separatorPanes},e.prototype.layout=function(t){var e,i,n,r,o,a,s=this;null!==(e=t.sort)&&void 0!==e&&e&&(this._layoutOptions.sort=t.sort),null!==(i=t.measureHeight)&&void 0!==i&&i&&(this._layoutOptions.measureHeight=t.measureHeight),null!==(n=t.measureWidth)&&void 0!==n&&n&&(this._layoutOptions.measureWidth=t.measureWidth),null!==(r=t.update)&&void 0!==r&&r&&(this._layoutOptions.update=t.update),null!==(o=t.buildYAxisTick)&&void 0!==o&&o&&(this._layoutOptions.buildYAxisTick=t.buildYAxisTick),null!==(a=t.buildYAxisTick)&&void 0!==a&&a&&(this._layoutOptions.forceBuildYAxisTick=t.forceBuildYAxisTick),this._layoutPending||(this._layoutPending=!0,Promise.resolve().then((function(t){s._layout(),s._layoutPending=!1})).catch((function(t){})))},e.prototype._layout=function(){var t=this,e=this._layoutOptions,i=e.sort,n=e.measureHeight,r=e.measureWidth,o=e.update,a=e.buildYAxisTick,s=e.forceBuildYAxisTick;if(i){for(;E(this._chartContainer.firstChild);)this._chartContainer.removeChild(this._chartContainer.firstChild);this._separatorPanes.clear(),this._drawPanes.sort((function(t,e){return t.getOptions().order-e.getOptions().order}));var l=null;this._drawPanes.forEach((function(e){if(e.getId()!==we){if(E(l)){var i=new Wi(t,"",l,e);t._chartContainer.appendChild(i.getContainer()),t._separatorPanes.set(e,i)}l=e}t._chartContainer.appendChild(e.getContainer())}))}if(n){var u=this._chartBounding.height,c=this.getStyles().separator.size,h=this._xAxisPane.getAxisComponent().getAutoSize(),d=u-h;d<0&&(d=0),this._drawPanes.forEach((function(e){var i=e.getId();if(E(t._separatorPanes.get(e))&&(d-=c),i!==we&&i!==Ce&&e.getVisible()){var n=e.getBounding().height;n>d?(n=d,d=0):d-=n,e.setBounding({height:n})}})),this._candlePane.setBounding({height:Math.max(d,0)}),this._xAxisPane.setBounding({height:h});var p=0;this._drawPanes.forEach((function(e){var i=t._separatorPanes.get(e);E(i)&&(i.setBounding({height:c,top:p}),p+=c),e.setBounding({top:p}),p+=e.getBounding().height}))}var g=r;if((a||s)&&this._drawPanes.forEach((function(t){var e=t.getAxisComponent().buildTicks(s);g||(g=e)})),g){var v=this._chartBounding.width,f=this.getStyles(),y=0,m=!0,_=0,x=!0;this._drawPanes.forEach((function(t){if(t.getId()!==we){var e=t.getAxisComponent(),i=e.inside,n=e.getAutoSize();e.position===Je.Left?(y=Math.max(y,n),i&&(m=!1)):(_=Math.max(_,n),i&&(x=!1))}}));var b=v,C=0,T=0;m&&(b-=y,C=y),x&&(b-=_,T=_),this._chartStore.setTotalBarSpace(b);var w={width:v},S={width:b,left:C,right:T},P={width:y},I={width:_},M=f.separator.fill,k={};k=M?w:S,this._drawPanes.forEach((function(e){var i;null===(i=t._separatorPanes.get(e))||void 0===i||i.setBounding(k),e.setBounding(w,S,P,I)}))}o&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4)),this._layoutOptions={sort:!1,measureHeight:!1,measureWidth:!1,update:!1,buildYAxisTick:!1,forceBuildYAxisTick:!1}},e.prototype.updatePane=function(t,e){var i=this;if(E(e)){var n=this.getDrawPaneById(e);null==n||n.update(t)}else this._drawPanes.forEach((function(e){var n;e.update(t),null===(n=i._separatorPanes.get(e))||void 0===n||n.update(t)}))},e.prototype.crosshairChange=function(e){var i=this;if(this._chartStore.hasAction(t.ActionType.OnCrosshairChange)){var n={};this._drawPanes.forEach((function(t){var r=t.getId(),o={};i._chartStore.getIndicatorsByPaneId(r).forEach((function(t){var i,n=t.result;o[t.name]=n[null!==(i=e.dataIndex)&&void 0!==i?i:n.length-1]})),n[r]=o})),I(e.paneId)&&this._chartStore.executeAction(t.ActionType.OnCrosshairChange,p(p({},e),{indicatorData:n}))}},e.prototype.getDom=function(e,i){var n,r;if(!E(e))return this._chartContainer;var o=this.getDrawPaneById(e);if(E(o))switch(null!=i?i:t.DomPosition.Root){case t.DomPosition.Root:return o.getContainer();case t.DomPosition.Main:return o.getMainWidget().getContainer();case t.DomPosition.YAxis:return null!==(r=null===(n=o.getYAxisWidget())||void 0===n?void 0:n.getContainer())&&void 0!==r?r:null}return null},e.prototype.getSize=function(e,i){var n,r;if(!E(e))return this._chartBounding;var o=this.getDrawPaneById(e);if(E(o))switch(null!=i?i:t.DomPosition.Root){case t.DomPosition.Root:return o.getBounding();case t.DomPosition.Main:return o.getMainWidget().getBounding();case t.DomPosition.YAxis:return null!==(r=null===(n=o.getYAxisWidget())||void 0===n?void 0:n.getBounding())&&void 0!==r?r:null}return null},e.prototype.setPrecision=function(t){this._chartStore.setPrecision(t)},e.prototype.getPrecision=function(){return this._chartStore.getPrecision()},e.prototype.setStyles=function(t){var e=this;this._setOptions((function(){e._chartStore.setStyles(t)}))},e.prototype.getStyles=function(){return this._chartStore.getStyles()},e.prototype.setCustomApi=function(t){var e=this;this._setOptions((function(){e._chartStore.setCustomApi(t)}))},e.prototype.getCustomApi=function(){return this._chartStore.getCustomApi()},e.prototype.setLocale=function(t){var e=this;this._setOptions((function(){e._chartStore.setLocale(t)}))},e.prototype.getLocale=function(){return this._chartStore.getLocale()},e.prototype.setTimezone=function(t){var e=this;this._setOptions((function(){e._chartStore.setTimezone(t)}))},e.prototype.getTimezone=function(){return this._chartStore.getTimezone()},e.prototype.setThousandsSeparator=function(t){var e=this;this._setOptions((function(){e._chartStore.setThousandsSeparator(t)}))},e.prototype.getThousandsSeparator=function(){return this._chartStore.getThousandsSeparator()},e.prototype.setDecimalFold=function(t){var e=this;this._setOptions((function(){e._chartStore.setDecimalFold(t)}))},e.prototype.getDecimalFold=function(){return this._chartStore.getDecimalFold()},e.prototype._setOptions=function(t){t(),this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})},e.prototype.setOffsetRightDistance=function(t){this._chartStore.setOffsetRightDistance(t,!0)},e.prototype.getOffsetRightDistance=function(){return this._chartStore.getOffsetRightDistance()},e.prototype.setMaxOffsetLeftDistance=function(t){t<0||this._chartStore.setMaxOffsetLeftDistance(t)},e.prototype.setMaxOffsetRightDistance=function(t){t<0||this._chartStore.setMaxOffsetRightDistance(t)},e.prototype.setLeftMinVisibleBarCount=function(t){t<0||this._chartStore.setLeftMinVisibleBarCount(Math.ceil(t))},e.prototype.setRightMinVisibleBarCount=function(t){t<0||this._chartStore.setRightMinVisibleBarCount(Math.ceil(t))},e.prototype.setBarSpace=function(t){this._chartStore.setBarSpace(t)},e.prototype.getBarSpace=function(){return this._chartStore.getBarSpace()},e.prototype.getVisibleRange=function(){return this._chartStore.getVisibleRange()},e.prototype.clearData=function(){this._chartStore.clearData()},e.prototype.getDataList=function(){return this._chartStore.getDataList()},e.prototype.applyNewData=function(t,e){this._drawPanes.forEach((function(t){t.getAxisComponent().setAutoCalcTickFlag(!0)}));var i={forward:!1,backward:!1};P(e)?(i.forward=e,i.backward=e):i=p(p({},i),e),this._chartStore.addData(t,ct.Init,i)},e.prototype.updateData=function(t){this._chartStore.addData(t,ct.Update)},e.prototype.setLoadMoreDataCallback=function(t){this._chartStore.setLoadMoreDataCallback(t)},e.prototype.createIndicator=function(t,e,i){var n,r=I(t)?{name:t}:t;if(null===Jt(r.name))return null;var o=null!=i?i:{};if(I(o.id)||(o.id=gt(Te)),I(r.id)||(r.id=gt(r.name)),this._chartStore.addIndicator(r,o.id,null!=e&&e)){var a=!1;return E(this.getDrawPaneById(o.id))||(this._createPane(Ii,o.id,o),null!==(n=o.height)&&void 0!==n||(o.height=100),a=!0),this.setPaneOptions(o),this.layout({sort:a,measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0}),r.id}return null},e.prototype.overrideIndicator=function(t){return this._chartStore.overrideIndicator(t)},e.prototype.getIndicators=function(t){return this._chartStore.getIndicatorsByFilter(null!=t?t:{})},e.prototype.removeIndicator=function(t){var e=this,i=this._chartStore.removeIndicator(null!=t?t:{});if(i){var n=!1,r=[];this._drawPanes.forEach((function(t){var e=t.getId();e!==Ce&&e!==we&&r.push(e)})),r.forEach((function(t){if(!e._chartStore.hasIndicators(t)){var i=e._drawPanes.findIndex((function(e){return e.getId()===t})),r=e._drawPanes[i];E(r)&&(n=!0,e._recalculatePaneHeight(r,0,r.getBounding().height),e._drawPanes.splice(i,1),r.destroy())}})),2===this._drawPanes.length&&(this._candlePane.setVisible(!0),this._candlePane.setBounding({height:this._chartBounding.height-this._xAxisPane.getBounding().height})),this.layout({sort:n,measureHeight:n,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}return i},e.prototype.createOverlay=function(t){var e=this,i=[],n=[],r=function(t){E(t.paneId)&&null!==e.getDrawPaneById(t.paneId)?n.push(!0):(t.paneId=Ce,n.push(!1)),i.push(t)};I(t)?r({name:t}):C(t)?t.forEach((function(t){var e=null;e=I(t)?{name:t}:t,r(e)})):r(t);var o=this._chartStore.addOverlays(i,n);return C(t)?o:o[0]},e.prototype.getOverlays=function(t){return this._chartStore.getOverlaysByFilter(null!=t?t:{})},e.prototype.overrideOverlay=function(t){return this._chartStore.overrideOverlay(t)},e.prototype.removeOverlay=function(t){return this._chartStore.removeOverlay(null!=t?t:{})},e.prototype.setPaneOptions=function(t){var e,i,n,r=this,o=!1,a=!1,s=E(t.id),l=function(e){var i=e.getId();if(s&&t.id===i||!s){if(i!==we){if(S(t.height)&&t.height>0){var l=Math.max(null!==(n=t.minHeight)&&void 0!==n?n:e.getOptions().minHeight,0),c=Math.max(l,t.height);a=!0,o=!0,e.setOriginalBounding({height:c}),u._recalculatePaneHeight(e,c,-c)}if(E(t.state)&&e.getOptions().state!==t.state){o=!0,a=!0;var h=t.state;switch(h){case"maximize":if(!E(u._drawPanes.find((function(t){var e=t.getId();return"maximize"===t.getOptions().state&&e!==we})))){"normal"===e.getOptions().state&&e.setOriginalBounding({height:e.getBounding().height}),e.setOptions({state:h});var d=u._chartBounding.height;e.setBounding({height:d-u._xAxisPane.getBounding().height}),u._drawPanes.forEach((function(t){var e;t.getId()!==we&&t.getId()!==i&&(t.setBounding({height:t.getOriginalBounding().height}),t.setVisible(!1),null===(e=r._separatorPanes.get(t))||void 0===e||e.setVisible(!1))}))}break;case"minimize":c=e.getBounding().height;var g=e.getOptions().state,v=c-30;"maximize"===g&&(v=e.getOriginalBounding().height-30),u._recalculatePaneHeight(e,30,v)&&("normal"===g&&e.setOriginalBounding({height:c}),e.setOptions({state:h})),u._drawPanes.forEach((function(t){var e;t.getId()!==we&&(t.setVisible(!0),null===(e=r._separatorPanes.get(t))||void 0===e||e.setVisible(!0))}));break;default:c=e.getOriginalBounding().height;u._recalculatePaneHeight(e,c,e.getBounding().height-c)&&e.setOptions({state:h}),u._drawPanes.forEach((function(t){var e;t.getId()!==we&&(t.setVisible(!0),null===(e=r._separatorPanes.get(t))||void 0===e||e.setVisible(!0))}))}}}E(t.axis)&&(a=!0);var f=p({},t);if(delete f.state,e.setOptions(f),i===t.id)return"break"}},u=this;try{for(var c=y(this._drawPanes),h=c.next();!h.done;h=c.next()){if("break"===l(h.value))break}}catch(t){e={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}a&&this.layout({measureHeight:o,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})},e.prototype.getPaneOptions=function(t){var e;if(E(t)){var i=this.getDrawPaneById(t);return null!==(e=null==i?void 0:i.getOptions())&&void 0!==e?e:null}return this._drawPanes.map((function(t){return t.getOptions()}))},e.prototype.setZoomEnabled=function(t){this._chartStore.setZoomEnabled(t)},e.prototype.isZoomEnabled=function(){return this._chartStore.isZoomEnabled()},e.prototype.setScrollEnabled=function(t){this._chartStore.setScrollEnabled(t)},e.prototype.isScrollEnabled=function(){return this._chartStore.isScrollEnabled()},e.prototype.scrollByDistance=function(t,e){var i=this,n=S(e)&&e>0?e:0;if(this._chartStore.startScroll(),n>0){var r=new ht({duration:n});r.doFrame((function(e){var r=t*(e/n);i._chartStore.scroll(r)})),r.start()}else this._chartStore.scroll(t)},e.prototype.scrollToRealTime=function(t){var e=this._chartStore.getBarSpace().bar,i=(this._chartStore.getLastBarRightSideDiffBarCount()-this._chartStore.getInitialOffsetRightDistance()/e)*e;this.scrollByDistance(i,t)},e.prototype.scrollToDataIndex=function(t,e){var i=(this._chartStore.getLastBarRightSideDiffBarCount()+(this.getDataList().length-1-t))*this._chartStore.getBarSpace().bar;this.scrollByDistance(i,e)},e.prototype.scrollToTimestamp=function(t,e){var i=ft(this.getDataList(),"timestamp",t);this.scrollToDataIndex(i,e)},e.prototype.zoomAtCoordinate=function(t,e,i){var n=this,r=S(i)&&i>0?i:0,o=this._chartStore.getBarSpace().bar,a=o*t-o;if(r>0){var s=0,l=new ht({duration:r});l.doFrame((function(t){var i=a*(t/r),o=(i-s)/n._chartStore.getBarSpace().bar*10;n._chartStore.zoom(o,e),s=i})),l.start()}else this._chartStore.zoom(a/o*10,e)},e.prototype.zoomAtDataIndex=function(t,e,i){var n=this._chartStore.dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:n,y:0},i)},e.prototype.zoomAtTimestamp=function(t,e,i){var n=ft(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,n,i)},e.prototype.convertToPixel=function(t,e){var i,n=this,r=null!=e?e:{},o=r.paneId,a=void 0===o?Ce:o,s=r.absolute,l=void 0!==s&&s,u=[];if(a!==we){var c=this.getDrawPaneById(a);if(null!==c){var h=c.getBounding(),d=[].concat(t),p=this._xAxisPane.getAxisComponent(),g=c.getAxisComponent();u=d.map((function(t){var e={},i=t.dataIndex;if(S(t.timestamp)&&(i=n._chartStore.timestampToDataIndex(t.timestamp)),S(i)&&(e.x=p.convertToPixel(i)),S(t.value)){var r=g.convertToPixel(t.value);e.y=l?h.top+r:r}return e}))}}return C(t)?u:null!==(i=u[0])&&void 0!==i?i:{}},e.prototype.convertFromPixel=function(t,e){var i,n=this,r=null!=e?e:{},o=r.paneId,a=void 0===o?Ce:o,s=r.absolute,l=void 0!==s&&s,u=[];if(a!==we){var c=this.getDrawPaneById(a);if(null!==c){var h=c.getBounding(),d=[].concat(t),p=this._xAxisPane.getAxisComponent(),g=c.getAxisComponent();u=d.map((function(t){var e,i={};if(S(t.x)){var r=p.convertFromPixel(t.x);i.dataIndex=r,i.timestamp=null!==(e=n._chartStore.dataIndexToTimestamp(r))&&void 0!==e?e:void 0}if(S(t.y)){var o=l?t.y-h.top:t.y;i.value=g.convertFromPixel(o)}return i}))}}return C(t)?u:null!==(i=u[0])&&void 0!==i?i:{}},e.prototype.executeAction=function(e,i){var n;if(e===t.ActionType.OnCrosshairChange){var r=p({},i);null!==(n=r.paneId)&&void 0!==n||(r.paneId=Ce),this._chartStore.setCrosshair(r,{notExecuteAction:!0})}},e.prototype.subscribeAction=function(t,e){this._chartStore.subscribeAction(t,e)},e.prototype.unsubscribeAction=function(t,e){this._chartStore.unsubscribeAction(t,e)},e.prototype.getConvertPictureUrl=function(t,e,i){var n=this,r=this._chartBounding,o=r.width,a=r.height,s=vt("canvas",{width:"".concat(o,"px"),height:"".concat(a,"px"),boxSizing:"border-box"}),l=s.getContext("2d"),u=G(s);s.width=o*u,s.height=a*u,l.scale(u,u),l.fillStyle=null!=i?i:"#FFFFFF",l.fillRect(0,0,o,a);var c=null!=t&&t;return this._drawPanes.forEach((function(t){var e=n._separatorPanes.get(t);if(E(e)){var i=e.getBounding();l.drawImage(e.getImage(c),i.left,i.top,i.width,i.height)}var r=t.getBounding();l.drawImage(t.getImage(c),0,r.top,o,r.height)})),s.toDataURL("image/".concat(null!=e?e:"jpeg"))},e.prototype.resize=function(){this._cacheChartBounding(),this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})},e.prototype.destroy=function(){this._chartEvent.destroy(),this._drawPanes.forEach((function(t){t.destroy()})),this._drawPanes=[],this._separatorPanes.clear(),this._container.removeChild(this._chartContainer)},e}(),Ji=new Map,$i=1;var tn={clone:b,merge:x,isString:I,isNumber:S,isValid:E,isObject:w,isArray:C,isFunction:T,isBoolean:P,formatValue:L,formatPrecision:V,formatBigNumber:N,formatDate:W,formatThousands:z,formatFoldDecimal:Y,calcTextWidth:Z,getLinearSlopeIntercept:ae,getLinearYFromSlopeIntercept:re,getLinearYFromCoordinates:oe,checkCoordinateOnArc:Ue,checkCoordinateOnCircle:Le,checkCoordinateOnLine:ne,checkCoordinateOnPolygon:We,checkCoordinateOnRect:Ne,checkCoordinateOnText:Xe};t.dispose=function(t){var e,i,n=null;if(t instanceof Ki)n=t.id;else{var r=null;n=null!==(e=null==(r=I(t)?document.getElementById(t):t)?void 0:r.getAttribute("k-line-chart-id"))&&void 0!==e?e:null}null!==n&&(null===(i=Ji.get(n))||void 0===i||i.destroy(),Ji.delete(n))},t.getFigureClass=function(t){var e;return null!==(e=Ke[t])&&void 0!==e?e:null},t.getOverlayClass=function(t){var e;return null!==(e=me[t])&&void 0!==e?e:null},t.getSupportedFigures=function(){return Object.keys(Ke)},t.getSupportedIndicators=function(){return Object.keys(Qt)},t.getSupportedLocales=function(){return Object.keys(di)},t.getSupportedOverlays=function(){return Object.keys(me)},t.init=function(t,e){var i=null;if(null===(i=I(t)?document.getElementById(t):t))return null;var n=Ji.get(i.id);if(E(n))return n;var r="k_line_chart_".concat($i++);return(n=new Ki(i,e)).id=r,i.setAttribute("k-line-chart-id",r),Ji.set(r,n),n},t.registerFigure=function(t){Ke[t.name]=ie.extend(t)},t.registerIndicator=function(t){Qt[t.name]=tt.extend(t)},t.registerLocale=function(t,e){di[t]=p(p({},di[t]),e)},t.registerOverlay=function(t){me[t.name]=rt.extend(t)},t.registerStyles=function(t,e){xe[t]=e},t.registerXAxis=function(t){Bi[t.name]=Ri.extend(t)},t.registerYAxis=function(t){Si[t.name]=Ci.extend(t)},t.utils=tn,t.version=function(){return"10.0.0-alpha5"}}));
